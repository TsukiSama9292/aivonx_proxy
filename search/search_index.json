{"config":{"lang":["en","zh"],"separator":"[\\s\\-]+","pipeline":["stopWordFilter"],"fields":{"title":{"boost":1000.0},"text":{"boost":1.0},"tags":{"boost":1000000.0}}},"docs":[{"location":"","title":"Aivonx Proxy Documentation","text":"<p>Welcome to the Aivonx Proxy documentation. This documentation is generated from the codebase in <code>src/</code> and provides comprehensive guidance on deploying, using, and developing the project.</p>"},{"location":"#quick-navigation","title":"Quick Navigation","text":"<ul> <li>Getting Started: Introduction, requirements, and deployment guides</li> <li>Reference: Configuration, API endpoints, and CLI commands</li> <li>Resources: Troubleshooting, security best practices, and glossary</li> <li>Development: Code structure, contribution guidelines, and testing</li> </ul>"},{"location":"#running-documentation-locally","title":"Running Documentation Locally","text":"<pre><code>mkdocs serve -f mkdocs.yml\n</code></pre> <p>For direct source code reference, explore the modules in <code>src/</code> (e.g., <code>src/aivonx/settings.py</code>, <code>src/proxy/</code>).</p>"},{"location":"development/code_structure/","title":"Code Structure","text":"<p>Overview of the project's architecture and organization.</p>"},{"location":"development/code_structure/#project-layout","title":"Project Layout","text":"<pre><code>aivonx_proxy/\n\u251c\u2500\u2500 src/                      # Application source code\n\u2502   \u251c\u2500\u2500 aivonx/              # Django project configuration\n\u2502   \u251c\u2500\u2500 proxy/               # Core proxy application\n\u2502   \u251c\u2500\u2500 account/             # Authentication and user management\n\u2502   \u251c\u2500\u2500 logviewer/           # Log viewing interface\n\u2502   \u251c\u2500\u2500 ui/                  # Frontend templates and static files\n\u2502   \u251c\u2500\u2500 staticfiles/         # Collected static files (generated)\n\u2502   \u251c\u2500\u2500 logs/                # Application logs\n\u2502   \u2514\u2500\u2500 manage.py            # Django management script\n\u251c\u2500\u2500 docs/                    # Documentation\n\u251c\u2500\u2500 docker-compose.yml       # Docker Compose configuration\n\u251c\u2500\u2500 Dockerfile              # Container image definition\n\u251c\u2500\u2500 pyproject.toml          # Project metadata and dependencies\n\u251c\u2500\u2500 mkdocs.yml             # Documentation configuration\n\u2514\u2500\u2500 README.md              # Project overview\n</code></pre>"},{"location":"development/code_structure/#core-applications","title":"Core Applications","text":""},{"location":"development/code_structure/#aivonx-project-configuration","title":"aivonx/ (Project Configuration)","text":"<p>Purpose: Django project settings and core configuration</p> <p>Key Files: - <code>settings.py</code> - Main configuration file   - Database settings (PostgreSQL)   - Redis cache configuration   - Security settings (CORS, CSRF, SECRET_KEY)   - Logging configuration   - REST Framework settings   - drf-spectacular settings - <code>urls.py</code> - URL routing - <code>wsgi.py</code> - WSGI application entry point - <code>asgi.py</code> - ASGI application entry point - <code>utils.py</code> - Utility functions for settings - <code>views.py</code> - Health check and version views</p>"},{"location":"development/code_structure/#proxy-core-application","title":"proxy/ (Core Application)","text":"<p>Purpose: Main proxy logic and node management</p> <p>Structure: <pre><code>proxy/\n\u251c\u2500\u2500 models.py              # Database models (Node, ProxyConfig)\n\u251c\u2500\u2500 serializers.py         # DRF serializers\n\u251c\u2500\u2500 views.py              # API views (state, health, config)\n\u251c\u2500\u2500 views_proxy.py        # Proxy endpoints (generate, chat, embed)\n\u251c\u2500\u2500 viewsets.py           # REST viewsets (NodeViewSet)\n\u251c\u2500\u2500 urls.py               # URL routing\n\u251c\u2500\u2500 apps.py               # App configuration (lifecycle hooks)\n\u251c\u2500\u2500 admin.py              # Django admin configuration\n\u251c\u2500\u2500 forms.py              # Web forms\n\u251c\u2500\u2500 signals.py            # Django signals\n\u251c\u2500\u2500 streaming.py          # Streaming response utilities\n\u251c\u2500\u2500 web.py                # Web UI views\n\u251c\u2500\u2500 utils/                # Utility modules\n\u2502   \u2514\u2500\u2500 proxy_manager.py  # HA manager and node selection\n\u251c\u2500\u2500 tests/                # Test suite\n\u251c\u2500\u2500 templates/            # HTML templates\n\u251c\u2500\u2500 static/               # Static files (CSS, JS)\n\u2514\u2500\u2500 migrations/           # Database migrations\n</code></pre></p> <p>Key Components:</p> <ol> <li>Models (<code>models.py</code>)</li> <li><code>Node</code>: Backend Ollama server definition</li> <li> <p><code>ProxyConfig</code>: Global proxy configuration</p> </li> <li> <p>Proxy Manager (<code>utils/proxy_manager.py</code>)</p> </li> <li>Node selection algorithms</li> <li>Health monitoring</li> <li>Active/standby pool management</li> <li>Latency tracking</li> <li> <p>Model discovery</p> </li> <li> <p>API Views (<code>views.py</code>, <code>viewsets.py</code>)</p> </li> <li>Node CRUD operations</li> <li>State inspection</li> <li>Configuration management</li> <li> <p>Model pulling</p> </li> <li> <p>Proxy Endpoints (<code>views_proxy.py</code>)</p> </li> <li><code>/api/generate</code> - Text generation</li> <li><code>/api/chat</code> - Chat completions</li> <li><code>/api/embed</code> - Single embedding</li> <li><code>/api/embeddings</code> - Batch embeddings</li> <li><code>/api/tags</code> - List models</li> <li><code>/api/ps</code> - Running models</li> </ol>"},{"location":"development/code_structure/#account-user-management","title":"account/ (User Management)","text":"<p>Purpose: User authentication and account management</p> <p>Key Files: - <code>models.py</code> - User models (if any custom models) - <code>serializers.py</code> - User serializers - <code>views.py</code> - Authentication views - <code>urls.py</code> - Account URL routing</p>"},{"location":"development/code_structure/#logviewer-log-viewer","title":"logviewer/ (Log Viewer)","text":"<p>Purpose: Web interface for viewing JSON logs</p> <p>Key Files: - <code>views.py</code> - Log retrieval API - <code>web.py</code> - Log viewer UI - <code>templates/</code> - Log viewer HTML - <code>static/</code> - Log viewer CSS/JS</p>"},{"location":"development/code_structure/#ui-frontend","title":"ui/ (Frontend)","text":"<p>Purpose: Static files and templates for web interface</p> <p>Structure: <pre><code>ui/\n\u251c\u2500\u2500 static/\n\u2502   \u251c\u2500\u2500 css/\n\u2502   \u2514\u2500\u2500 js/\n\u2514\u2500\u2500 templates/\n</code></pre></p>"},{"location":"development/code_structure/#key-architectural-patterns","title":"Key Architectural Patterns","text":""},{"location":"development/code_structure/#proxy-manager-singleton","title":"Proxy Manager Singleton","text":"<p>The proxy manager is initialized as a singleton: - Created during app startup (ASGI lifespan events) - Accessible via <code>get_global_manager()</code> - Manages shared state across workers - Uses Redis for cross-process communication</p>"},{"location":"development/code_structure/#model-aware-routing","title":"Model-Aware Routing","text":"<ol> <li>Client requests model by name</li> <li>Manager checks which nodes have the model</li> <li>Selects best available node using strategy</li> <li>Routes request to selected node</li> <li>Tracks active requests</li> <li>Releases node when complete</li> </ol>"},{"location":"development/code_structure/#health-check-scheduler","title":"Health Check Scheduler","text":"<ul> <li>Runs every 60 seconds (configurable)</li> <li>Checks all configured nodes</li> <li>Updates active/standby pools</li> <li>Refreshes model availability</li> <li>Measures latency</li> </ul>"},{"location":"development/code_structure/#data-flow","title":"Data Flow","text":""},{"location":"development/code_structure/#request-flow","title":"Request Flow","text":"<pre><code>Client Request\n    \u2193\nDjango URL Router\n    \u2193\nAPI View (views_proxy.py)\n    \u2193\nProxy Manager\n    \u2193\nNode Selection (strategy)\n    \u2193\nHTTPX Client Request\n    \u2193\nOllama Node\n    \u2193\nStreaming Response\n    \u2193\nClient\n</code></pre>"},{"location":"development/code_structure/#node-state-management","title":"Node State Management","text":"<pre><code>Database (PostgreSQL)\n    \u2193\nProxy Manager\n    \u2193\nRedis Cache\n    \u2193\nActive/Standby Pools\n    \u2193\nRequest Selection\n</code></pre>"},{"location":"development/code_structure/#important-files-reference","title":"Important Files Reference","text":""},{"location":"development/code_structure/#configuration","title":"Configuration","text":"<ul> <li><code>src/aivonx/settings.py</code> - All settings</li> <li><code>pyproject.toml</code> - Dependencies</li> <li><code>docker-compose.yml</code> - Services</li> </ul>"},{"location":"development/code_structure/#core-logic","title":"Core Logic","text":"<ul> <li><code>src/proxy/utils/proxy_manager.py</code> - HA manager</li> <li><code>src/proxy/views_proxy.py</code> - Proxy endpoints</li> <li><code>src/proxy/models.py</code> - Data models</li> </ul>"},{"location":"development/code_structure/#api","title":"API","text":"<ul> <li><code>src/aivonx/urls.py</code> - Main routing</li> <li><code>src/proxy/urls.py</code> - Proxy routing</li> <li><code>src/proxy/viewsets.py</code> - REST viewsets</li> </ul>"},{"location":"development/code_structure/#design-principles","title":"Design Principles","text":"<ol> <li>Separation of Concerns: Each app handles specific functionality</li> <li>DRY (Don't Repeat Yourself): Shared utilities in utils/</li> <li>Scalability: Stateless design with Redis for shared state</li> <li>Testability: Clear interfaces and dependency injection</li> <li>Maintainability: Clear naming and documentation</li> </ol>"},{"location":"development/contributing/","title":"Contributing Guide","text":"<p>We welcome contributions to Aivonx Proxy! Here's how to get started.</p>"},{"location":"development/contributing/#getting-started","title":"Getting Started","text":"<ol> <li>Fork the Repository</li> <li>Fork the project on GitHub</li> <li> <p>Clone your fork locally    <pre><code>git clone https://github.com/YOUR_USERNAME/aivonx_proxy.git\ncd aivonx_proxy\n</code></pre></p> </li> <li> <p>Set Up Development Environment <pre><code># Install dependencies\nuv sync\n\n# Run migrations\nuv run src/manage.py migrate\n\n# Create superuser\nuv run src/manage.py createsuperuser\n</code></pre></p> </li> <li> <p>Create a Feature Branch <pre><code>git checkout -b feature/your-feature-name\n</code></pre></p> </li> </ol>"},{"location":"development/contributing/#development-workflow","title":"Development Workflow","text":""},{"location":"development/contributing/#running-tests","title":"Running Tests","text":"<p>Before submitting changes, ensure all tests pass:</p> <pre><code># Run all tests\npython src/manage.py test\n\n# Run specific app tests\npython src/manage.py test proxy\n\n# Run with coverage\ncoverage run --source='.' src/manage.py test\ncoverage report\n</code></pre>"},{"location":"development/contributing/#code-style","title":"Code Style","text":"<ul> <li>Follow existing code style and conventions</li> <li>Use meaningful variable and function names</li> <li>Add docstrings to new functions and classes</li> <li>Keep functions focused and modular</li> </ul>"},{"location":"development/contributing/#making-changes","title":"Making Changes","text":"<ol> <li>Make your changes in your feature branch</li> <li>Write or update tests as needed</li> <li>Update documentation if necessary</li> <li>Run tests to ensure everything works</li> <li>Commit with clear, descriptive messages</li> </ol> <pre><code>git add .\ngit commit -m \"[Types] description of changes\"\n</code></pre> <p>Types: <code>[update]</code>, <code>[fix]</code>, <code>[tests]</code>, <code>[docs]</code></p>"},{"location":"development/contributing/#submitting-a-pull-request","title":"Submitting a Pull Request","text":"<ol> <li> <p>Push to Your Fork <pre><code>git push origin feature/your-feature-name\n</code></pre></p> </li> <li> <p>Create Pull Request</p> </li> <li>Go to the original repository on GitHub</li> <li>Click \"New Pull Request\"</li> <li>Select your branch</li> <li> <p>Fill out the PR template with:</p> <ul> <li>Description of changes</li> <li>Motivation and context</li> <li>Related issue numbers</li> <li>Testing performed</li> </ul> </li> <li> <p>PR Review Process</p> </li> <li>Maintainers will review your PR</li> <li>Address any feedback or requested changes</li> <li>Once approved, your PR will be merged</li> </ol>"},{"location":"development/contributing/#guidelines","title":"Guidelines","text":""},{"location":"development/contributing/#code-quality","title":"Code Quality","text":"<ul> <li>Write clean, readable code</li> <li>Follow Django and Python best practices</li> <li>Avoid unnecessary complexity</li> <li>Keep commits atomic and focused</li> </ul>"},{"location":"development/contributing/#documentation","title":"Documentation","text":"<ul> <li>Update relevant documentation</li> <li>Add docstrings to public APIs</li> <li>Update CHANGELOG if applicable</li> <li>Include examples for new features</li> </ul>"},{"location":"development/contributing/#testing","title":"Testing","text":"<ul> <li>Write tests for new features</li> <li>Ensure existing tests pass</li> <li>Aim for good test coverage</li> <li>Test edge cases and error conditions</li> </ul>"},{"location":"development/contributing/#commit-messages","title":"Commit Messages","text":"<p>Follow conventional commit format:</p> <pre><code>- Description 1\n- Description 2\n- Description 3\n</code></pre>"},{"location":"development/contributing/#what-to-contribute","title":"What to Contribute","text":""},{"location":"development/contributing/#good-first-issues","title":"Good First Issues","text":"<ul> <li>Documentation improvements</li> <li>Bug fixes</li> <li>Test coverage improvements</li> <li>Code comments and clarifications</li> </ul>"},{"location":"development/contributing/#feature-requests","title":"Feature Requests","text":"<ul> <li>Open an issue first to discuss</li> <li>Get feedback before implementing</li> <li>Ensure it aligns with project goals</li> </ul>"},{"location":"development/contributing/#bug-reports","title":"Bug Reports","text":"<p>When reporting bugs, include: - Clear description of the issue - Steps to reproduce - Expected vs actual behavior - Environment details (OS, Python version, etc.) - Relevant logs or error messages</p>"},{"location":"development/contributing/#code-of-conduct","title":"Code of Conduct","text":"<ul> <li>Be respectful and professional</li> <li>Welcome newcomers</li> <li>Provide constructive feedback</li> <li>Focus on collaboration</li> </ul>"},{"location":"development/contributing/#questions","title":"Questions?","text":"<p>If you have questions: - Check existing documentation - Search closed issues - Open a new issue for discussion - Join community discussions</p> <p>Thank you for contributing!</p>"},{"location":"development/testing/","title":"Testing","text":"<p>Comprehensive testing guide for Aivonx Proxy.</p>"},{"location":"development/testing/#running-tests","title":"Running Tests","text":"<p>The project includes unit tests with pytest configuration located in <code>src/*/tests/</code>.</p>"},{"location":"development/testing/#django-test-runner","title":"Django Test Runner","text":"<pre><code># Run all tests\npython src/manage.py test proxy.tests account.tests logviewer.tests --verbosity 1 --keepdb\n</code></pre>"},{"location":"getting_started/deployment_options/","title":"Deployment Options","text":"<p>Aivonx Proxy supports multiple deployment strategies to fit different use cases and environments.</p>"},{"location":"getting_started/deployment_options/#1-docker-compose-recommended-for-development","title":"1. Docker Compose (Recommended for Development)","text":"<p>Use the provided <code>docker-compose.yml</code> for an all-in-one deployment:</p> <pre><code>docker-compose up -d\n</code></pre> <p>Includes: - Django application server - PostgreSQL database - Redis cache - Ollama service (optional)</p>"},{"location":"getting_started/deployment_options/#2-kubernetes-production","title":"2. Kubernetes (Production)","text":"<p>For production Kubernetes deployments: - Use PostgreSQL and Redis as managed services - Configure horizontal pod autoscaling - Set resource limits and requests - Use ingress for SSL/TLS termination</p>"},{"location":"getting_started/deployment_options/#3-asgi-server-recommended-for-streaming","title":"3. ASGI Server (Recommended for Streaming)","text":"<p>For real-time streaming endpoints and WebSocket support:</p> <pre><code># Using uvicorn\nuvicorn aivonx.asgi:application --host 0.0.0.0 --port 8000 --workers 4\n\n# Or using gunicorn with uvicorn workers\ngunicorn aivonx.asgi:application -k uvicorn.workers.UvicornWorker --bind 0.0.0.0:8000 --workers 4\n</code></pre>"},{"location":"getting_started/deployment_options/#4-wsgi-server-traditional-deployment","title":"4. WSGI Server (Traditional Deployment)","text":"<p>For synchronous workloads:</p> <pre><code>gunicorn aivonx.wsgi:application --bind 0.0.0.0:8000 --workers 4\n</code></pre>"},{"location":"getting_started/deployment_options/#environment-variables","title":"Environment Variables","text":"<p>Critical environment variables (see <code>src/aivonx/settings.py</code> for complete list):</p>"},{"location":"getting_started/deployment_options/#required-for-production","title":"Required for Production","text":"<ul> <li><code>DJANGO_SECRET_KEY</code>: Required - Cryptographic secret for Django</li> <li><code>DJANGO_DEBUG</code>: Set to <code>false</code> for production</li> <li><code>DJANGO_ALLOWED_HOSTS</code>: Comma-separated list of allowed hostnames</li> </ul>"},{"location":"getting_started/deployment_options/#database-configuration","title":"Database Configuration","text":"<ul> <li><code>POSTGRES_DB</code>: Database name (default: <code>app_db</code>)</li> <li><code>POSTGRES_USER</code>: Database user (default: <code>user</code>)</li> <li><code>POSTGRES_PASSWORD</code>: Database password (default: <code>password</code>)</li> <li><code>POSTGRES_HOST</code>: Database host (default: <code>postgres</code>)</li> <li><code>POSTGRES_PORT</code>: Database port (default: <code>5432</code>)</li> </ul>"},{"location":"getting_started/deployment_options/#cache-configuration","title":"Cache Configuration","text":"<ul> <li><code>REDIS_URL</code>: Redis connection URL (default: <code>redis://redis:6379/1</code>)</li> </ul>"},{"location":"getting_started/deployment_options/#security-configuration","title":"Security Configuration","text":"<ul> <li><code>DJANGO_CORS_ALLOWED_ORIGINS</code>: Comma-separated allowed CORS origins</li> <li><code>DJANGO_CSRF_TRUSTED_ORIGINS</code>: Comma-separated trusted CSRF origins</li> <li><code>ROOT_PASSWORD</code>: Password for default <code>root</code> user</li> </ul>"},{"location":"getting_started/deployment_options/#production-checklist","title":"Production Checklist","text":"<ul> <li>[ ] Set strong <code>DJANGO_SECRET_KEY</code></li> <li>[ ] Disable debug mode (<code>DJANGO_DEBUG=false</code>)</li> <li>[ ] Configure proper <code>ALLOWED_HOSTS</code></li> <li>[ ] Use managed PostgreSQL and Redis</li> <li>[ ] Set up SSL/TLS certificates</li> <li>[ ] Configure logging and monitoring</li> <li>[ ] Change default <code>root</code> password</li> <li>[ ] Set up automated backups</li> <li>[ ] Configure firewall rules</li> </ul>"},{"location":"getting_started/faq/","title":"Frequently Asked Questions","text":""},{"location":"getting_started/faq/#general-questions","title":"General Questions","text":""},{"location":"getting_started/faq/#what-is-aivonx-proxy","title":"What is Aivonx Proxy?","text":"<p>Aivonx Proxy is a reverse proxy and management platform for multiple Ollama model-serving nodes. It provides intelligent routing, load balancing, and high availability features through a REST API and web-based administration interface.</p>"},{"location":"getting_started/faq/#what-problem-does-it-solve","title":"What problem does it solve?","text":"<p>It solves the challenge of managing multiple Ollama instances by: - Providing a unified API endpoint - Automatically routing requests to healthy nodes - Load balancing based on node availability and performance - Supporting model-aware routing (requests are only sent to nodes that have the required model)</p>"},{"location":"getting_started/faq/#api-documentation","title":"API Documentation","text":""},{"location":"getting_started/faq/#how-do-i-view-the-api-documentation","title":"How do I view the API documentation?","text":"<p>After starting the application, access the interactive API documentation at: - Swagger UI: <code>/swagger</code> - ReDoc: <code>/redoc</code></p> <p>These are automatically generated by drf-spectacular and provide interactive request testing.</p>"},{"location":"getting_started/faq/#what-api-endpoints-are-available","title":"What API endpoints are available?","text":"<p>Key endpoints include: - <code>/api/proxy/nodes</code> - CRUD operations for nodes - <code>/api/proxy/state</code> - View proxy manager state - <code>/api/proxy/active-requests</code> - Monitor active requests per node - <code>/api/proxy/pull</code> - Pull models to nodes - <code>/api/generate</code> - Generate completions - <code>/api/chat</code> - Chat completions - <code>/api/tags</code> - List available models</p>"},{"location":"getting_started/faq/#node-management","title":"Node Management","text":""},{"location":"getting_started/faq/#how-do-i-add-a-new-node","title":"How do I add a new node?","text":"<p>Via API: <pre><code>curl -X POST http://localhost:8000/api/proxy/nodes \\\n  -H \"Content-Type: application/json\" \\\n  -H \"Authorization: Bearer YOUR_TOKEN\" \\\n  -d '{\n    \"name\": \"node1\",\n    \"address\": \"192.168.1.100\",\n    \"port\": 11434\n  }'\n</code></pre></p> <p>Via Web UI: 1. Log in to the management interface 2. Navigate to the Nodes section 3. Click \"Add Node\" and fill in the details</p> <p>The system automatically performs a health check on the new node.</p>"},{"location":"getting_started/faq/#how-does-node-selection-work","title":"How does node selection work?","text":"<p>The proxy uses configurable strategies: - Least Active (default): Routes to the node with fewest active requests - Lowest Latency: Routes to the node with best response time</p> <p>You can change the strategy via the <code>/api/proxy/config</code> endpoint.</p>"},{"location":"getting_started/faq/#what-happens-if-a-node-goes-down","title":"What happens if a node goes down?","text":"<p>The health check scheduler (runs every minute by default) automatically: - Detects unhealthy nodes - Moves them to standby pool - Stops routing new requests to them - Re-adds them when they recover</p>"},{"location":"getting_started/faq/#troubleshooting","title":"Troubleshooting","text":""},{"location":"getting_started/faq/#where-are-the-logs","title":"Where are the logs?","text":"<p>Logs are stored in: - <code>logs/django.json</code> - General Django logs - <code>logs/proxy.json</code> - Proxy-specific logs - <code>logs/django_error.log</code> - Error logs</p>"},{"location":"getting_started/faq/#how-do-i-check-if-nodes-are-healthy","title":"How do I check if nodes are healthy?","text":"<p>Use the state endpoint: <pre><code>curl http://localhost:8000/api/proxy/state\n</code></pre></p> <p>This returns active and standby pools, latencies, and active request counts.</p>"},{"location":"getting_started/faq/#streaming-responses-arent-working","title":"Streaming responses aren't working","text":"<p>Make sure you're using an ASGI server (uvicorn) rather than WSGI (gunicorn with sync workers). Streaming requires async support.</p>"},{"location":"getting_started/faq/#configuration","title":"Configuration","text":""},{"location":"getting_started/faq/#can-i-change-the-health-check-interval","title":"Can I change the health check interval?","text":"<p>Yes, modify the APScheduler configuration in your Django settings or adjust the scheduler directly in the proxy app configuration.</p>"},{"location":"getting_started/faq/#how-do-i-secure-the-api","title":"How do I secure the API?","text":"<p>The API uses: - JWT authentication (via djangorestframework-simplejwt) - Session authentication - Token authentication</p> <p>Ensure you set proper CORS and CSRF trusted origins in production.</p>"},{"location":"getting_started/introduction/","title":"Introduction","text":"<p>Aivonx Proxy is a Django-based reverse proxy and management service designed for Ollama model-serving nodes.</p>"},{"location":"getting_started/introduction/#key-features","title":"Key Features","text":"<ul> <li>Node Management: Manage multiple model service nodes with active/standby pool distribution</li> <li>REST API: Comprehensive endpoints for node management, model pulling, state monitoring, and health checks</li> <li>Web UI: Built-in administrative interface (located in <code>ui/</code> and <code>proxy.web</code>) for login and management</li> </ul>"},{"location":"getting_started/introduction/#core-components","title":"Core Components","text":"<ul> <li>Source Root: <code>src/</code></li> <li>Project Settings: <code>src/aivonx/settings.py</code></li> <li>Proxy Logic: <code>src/proxy/</code></li> </ul>"},{"location":"getting_started/introduction/#architecture-overview","title":"Architecture Overview","text":"<p>The proxy acts as a unified gateway that intelligently routes requests to backend Ollama nodes based on: - Model availability - Node health status - Load balancing strategy (least active or lowest latency) - Real-time monitoring and failover</p>"},{"location":"getting_started/quick_start_guide/","title":"Quick Start Guide","text":""},{"location":"getting_started/quick_start_guide/#option-1-docker-compose-recommended","title":"Option 1: Docker Compose (Recommended)","text":"<p>The fastest way to get started is using Docker Compose from the project root:</p> <pre><code># Standard deployment\ndocker-compose up --build\n\n# Or use the test configuration\ndocker-compose -f docker-compose-test.yml up --build\n</code></pre> <p>Once running, access the web interface at: - Web UI: http://localhost:8000 - API Documentation: http://localhost:8000/swagger or http://localhost:8000/redoc</p>"},{"location":"getting_started/quick_start_guide/#default-credentials","title":"Default Credentials","text":"<ul> <li>Username: <code>root</code></li> <li>Password: <code>changeme</code></li> </ul> <p>\u26a0\ufe0f Important: Change the default password by setting <code>ROOT_PASSWORD</code> in your <code>.env</code> file.</p>"},{"location":"getting_started/quick_start_guide/#option-2-local-development-server","title":"Option 2: Local Development Server","text":"<p>For local development with hot-reload:</p> <pre><code># Install dependencies\nuv sync\n\n# Run migrations\npython src/manage.py migrate\n\n# Start development server (ASGI with reload)\nuv run main.py --reload --port 8000\n\n# Alternative: Django development server (WSGI)\npython src/manage.py runserver\n</code></pre>"},{"location":"getting_started/quick_start_guide/#viewing-documentation","title":"Viewing Documentation","text":"<p>Serve the documentation locally:</p> <pre><code>mkdocs serve -f mkdocs.yml\n</code></pre> <p>Access at: http://localhost:8000 (or the port specified by mkdocs)</p>"},{"location":"getting_started/quick_start_guide/#static-files","title":"Static Files","text":"<p>If running locally with ASGI, collect static files after making changes:</p> <pre><code>python src/manage.py collectstatic --noinput\n</code></pre>"},{"location":"getting_started/requirements/","title":"Requirements","text":""},{"location":"getting_started/requirements/#system-requirements","title":"System Requirements","text":"<ul> <li>Python: &gt;=3.12, &lt;3.13</li> <li>Operating System: Linux, macOS, or Windows (Linux recommended for production)</li> </ul>"},{"location":"getting_started/requirements/#core-dependencies","title":"Core Dependencies","text":"<p>All project dependencies are specified in <code>pyproject.toml</code>. Key packages include:</p> <ul> <li>Django: &gt;=5.2.8 - Web framework</li> <li>Django REST Framework: API framework with authentication</li> <li>drf-spectacular: OpenAPI 3 schema generation</li> <li>uvicorn / gunicorn: ASGI/WSGI server options</li> <li>Redis: &gt;=7.1.0 - Caching and session storage</li> <li>django-redis: Redis cache backend</li> <li>PostgreSQL: Production database (psycopg2-binary)</li> <li>httpx: Modern async HTTP client</li> <li>APScheduler: Background task scheduling</li> </ul>"},{"location":"getting_started/requirements/#development-tools","title":"Development Tools","text":"<p>Recommended for development: - <code>ipykernel</code>: Jupyter kernel support - <code>jupyterlab</code>: Interactive development environment - <code>pytest</code>: Testing framework - <code>mkdocs</code> and <code>mkdocs-material</code>: Documentation generation</p>"},{"location":"getting_started/requirements/#installation","title":"Installation","text":"<p>Install using <code>uv</code> (recommended):</p> <pre><code>uv sync\n</code></pre> <p>Or using pip:</p> <pre><code>pip install -e .[dev]\n</code></pre>"},{"location":"reference/api_documentation/","title":"API Documentation","text":"<p>Comprehensive API reference for Aivonx Proxy. All endpoints are documented using OpenAPI 3.0 specification.</p>"},{"location":"reference/api_documentation/#interactive-documentation","title":"Interactive Documentation","text":"<p>After starting the application, access interactive API documentation:</p> <ul> <li>Swagger UI: http://localhost:8000/swagger</li> <li>ReDoc: http://localhost:8000/redoc</li> <li>OpenAPI Schema: http://localhost:8000/api/schema</li> </ul>"},{"location":"reference/api_documentation/#core-endpoints","title":"Core Endpoints","text":""},{"location":"reference/api_documentation/#health-check","title":"Health Check","text":"<p>Endpoint: <code>GET /api/health</code></p> <p>Description: Global health check for the application.</p> <p>Response: <pre><code>{\n  \"status\": \"healthy\"\n}\n</code></pre></p>"},{"location":"reference/api_documentation/#proxy-management-api","title":"Proxy Management API","text":"<p>All proxy management endpoints are under <code>/api/proxy/</code>. Most require authentication.</p>"},{"location":"reference/api_documentation/#proxy-state","title":"Proxy State","text":"<p>Endpoint: <code>GET /api/proxy/state</code></p> <p>Authentication: Not required (AllowAny)</p> <p>Description: View the current proxy manager state including active/standby pools, node mappings, latencies, and active request counts.</p> <p>Response: <pre><code>{\n  \"active\": [\"http://node1:11434\", \"http://node2:11434\"],\n  \"standby\": [],\n  \"node_id_map\": {\n    \"1\": \"http://node1:11434\",\n    \"2\": \"http://node2:11434\"\n  },\n  \"latencies\": {\n    \"http://node1:11434\": 0.123,\n    \"http://node2:11434\": 0.145\n  },\n  \"active_counts\": {\n    \"http://node1:11434\": 2,\n    \"http://node2:11434\": 1\n  },\n  \"models\": {\n    \"http://node1:11434\": [\"llama2\", \"codellama\"],\n    \"http://node2:11434\": [\"llama2\", \"mistral\"]\n  }\n}\n</code></pre></p>"},{"location":"reference/api_documentation/#active-requests","title":"Active Requests","text":"<p>Endpoint: <code>GET /api/proxy/active-requests</code></p> <p>Query Parameters: - <code>node_id</code> (optional): Filter by specific node ID</p> <p>Authentication: Not required (AllowAny)</p> <p>Description: Get active request counts for all nodes or a specific node.</p>"},{"location":"reference/api_documentation/#pull-model","title":"Pull Model","text":"<p>Endpoint: <code>POST /api/proxy/pull</code></p> <p>Authentication: Not required (AllowAny)</p> <p>Description: Pull a model to one or all nodes.</p>"},{"location":"reference/api_documentation/#proxy-configuration","title":"Proxy Configuration","text":"<p>Endpoint: <code>GET/PUT/PATCH /api/proxy/config</code></p> <p>Authentication: Required (IsAuthenticated)</p> <p>Description: Get or update the global proxy configuration (selection strategy).</p>"},{"location":"reference/api_documentation/#node-management-api","title":"Node Management API","text":""},{"location":"reference/api_documentation/#listcreateupdatedelete-nodes","title":"List/Create/Update/Delete Nodes","text":"<p>Endpoints: <code>GET/POST/PUT/PATCH/DELETE /api/proxy/nodes</code></p> <p>Managed by <code>NodeViewSet</code>. See <code>src/proxy/viewsets.py</code></p>"},{"location":"reference/api_documentation/#proxy-endpoints-ollama-compatible","title":"Proxy Endpoints (Ollama Compatible)","text":"<ul> <li><code>POST /api/generate</code> - Generate completions</li> <li><code>POST /api/chat</code> - Chat completions</li> <li><code>POST /api/embed</code> - Single embedding</li> <li><code>POST /api/embeddings</code> - Batch embeddings</li> <li><code>GET /api/tags</code> - List available models</li> <li><code>GET /api/ps</code> - List running models</li> </ul> <p>Implementation: <code>src/proxy/views_proxy.py</code></p>"},{"location":"reference/api_documentation/#models-and-serializers","title":"Models and Serializers","text":"<p>For detailed field definitions, see: - Models: <code>src/proxy/models.py</code> - Serializers: <code>src/proxy/serializers.py</code></p>"},{"location":"reference/cli_commands/","title":"CLI Commands","text":"<p>Django management commands and common operations.</p>"},{"location":"reference/cli_commands/#common-commands","title":"Common Commands","text":"<ul> <li><code>python src/manage.py migrate</code> \u2014 Run database migrations</li> <li><code>python src/manage.py createsuperuser</code> \u2014 Create admin account</li> <li><code>python src/manage.py test</code> \u2014 Run tests</li> <li><code>python src/manage.py collectstatic</code> \u2014 Collect static files</li> <li><code>python src/manage.py runserver</code> \u2014 Start development server (WSGI)</li> </ul>"},{"location":"reference/cli_commands/#development-server","title":"Development Server","text":"<p>Using uvicorn (ASGI, recommended for streaming):</p> <pre><code>uv run main.py --reload --port 8000\n</code></pre>"},{"location":"reference/cli_commands/#docker-environment","title":"Docker Environment","text":"<p>Run commands in container:</p> <pre><code>docker-compose run --rm web python src/manage.py migrate\n</code></pre>"},{"location":"reference/cli_commands/#interactive-shell","title":"Interactive Shell","text":"<p>Use Django shell for interactive testing:</p> <pre><code>python src/manage.py shell\n</code></pre>"},{"location":"reference/configuration/","title":"Configuration Reference","text":"<p>The main configuration file is located at <code>src/aivonx/settings.py</code>.</p>"},{"location":"reference/configuration/#core-settings","title":"Core Settings","text":""},{"location":"reference/configuration/#debug-mode","title":"Debug Mode","text":"<ul> <li>Setting: <code>DEBUG</code></li> <li>Environment Variable: <code>DJANGO_DEBUG</code></li> <li>Default: <code>True</code> (development)</li> <li>Production: Must be set to <code>false</code></li> </ul> <pre><code>DJANGO_DEBUG=false\n</code></pre>"},{"location":"reference/configuration/#secret-key","title":"Secret Key","text":"<ul> <li>Setting: <code>SECRET_KEY</code></li> <li>Environment Variable: <code>DJANGO_SECRET_KEY</code></li> <li>Required: Yes (production)</li> <li>Description: Cryptographic signing key for Django</li> </ul> <pre><code>DJANGO_SECRET_KEY=your-secret-key-here\n</code></pre> <p>\u26a0\ufe0f Never commit secret keys to version control</p>"},{"location":"reference/configuration/#allowed-hosts","title":"Allowed Hosts","text":"<ul> <li>Setting: <code>ALLOWED_HOSTS</code></li> <li>Environment Variable: <code>DJANGO_ALLOWED_HOSTS</code></li> <li>Format: Comma-separated list</li> <li>Default: <code>*</code> (development only)</li> </ul> <pre><code>DJANGO_ALLOWED_HOSTS=example.com,api.example.com\n</code></pre>"},{"location":"reference/configuration/#database-configuration","title":"Database Configuration","text":"<p>By default, the application uses PostgreSQL. Configure via environment variables:</p> <pre><code>POSTGRES_DB=app_db\nPOSTGRES_USER=user\nPOSTGRES_PASSWORD=secure_password\nPOSTGRES_HOST=postgres\nPOSTGRES_PORT=5432\n</code></pre> <p>Database Engine: <code>django.db.backends.postgresql</code></p>"},{"location":"reference/configuration/#cache-configuration","title":"Cache Configuration","text":"<p>Redis is used for caching and session storage:</p> <pre><code>REDIS_URL=redis://redis:6379/1\n</code></pre> <p>Backend: <code>django_redis.cache.RedisCache</code></p>"},{"location":"reference/configuration/#security-settings","title":"Security Settings","text":""},{"location":"reference/configuration/#cors-cross-origin-resource-sharing","title":"CORS (Cross-Origin Resource Sharing)","text":"<pre><code>DJANGO_CORS_ALLOWED_ORIGINS=https://example.com,https://app.example.com\n</code></pre> <ul> <li>Setting: <code>CORS_ALLOWED_ORIGINS</code></li> <li>Format: Comma-separated URLs with schemes</li> <li>Note: Automatically adds <code>http://</code> or <code>https://</code> if missing</li> </ul>"},{"location":"reference/configuration/#csrf-cross-site-request-forgery","title":"CSRF (Cross-Site Request Forgery)","text":"<pre><code>DJANGO_CSRF_TRUSTED_ORIGINS=https://example.com,https://app.example.com\n</code></pre>"},{"location":"reference/configuration/#static-files","title":"Static Files","text":""},{"location":"reference/configuration/#static-url-and-root","title":"Static URL and Root","text":"<ul> <li>STATIC_URL: <code>/static/</code></li> <li>STATIC_ROOT: <code>{BASE_DIR}/staticfiles</code></li> <li>STATICFILES_DIRS: <code>[{BASE_DIR}/ui/static]</code></li> </ul>"},{"location":"reference/configuration/#whitenoise-configuration","title":"WhiteNoise Configuration","text":"<p>The project uses WhiteNoise for efficient static file serving:</p> <ul> <li>Storage: <code>whitenoise.storage.CompressedManifestStaticFilesStorage</code></li> <li>Middleware: <code>whitenoise.middleware.WhiteNoiseMiddleware</code></li> </ul>"},{"location":"reference/configuration/#collecting-static-files","title":"Collecting Static Files","text":"<pre><code>python src/manage.py collectstatic --noinput\n</code></pre>"},{"location":"reference/configuration/#logging-configuration","title":"Logging Configuration","text":"<p>Logging is configured with multiple handlers and formatters:</p>"},{"location":"reference/configuration/#log-files","title":"Log Files","text":"<ul> <li>General Logs: <code>logs/django.json</code> (JSON format, rotating)</li> <li>Proxy Logs: <code>logs/proxy.json</code> (JSON format, rotating)</li> <li>Error Logs: <code>logs/django_error.log</code> (ERROR level only)</li> <li>Debug Logs: <code>logs/django_debug.log</code> (DEBUG level)</li> </ul>"},{"location":"reference/configuration/#log-rotation","title":"Log Rotation","text":"<ul> <li>Max Size: 10 MB per file</li> <li>Backup Count: 3 files</li> <li>Formatter: JSON (pythonjsonlogger)</li> </ul>"},{"location":"reference/configuration/#environment-variables","title":"Environment Variables","text":"<pre><code>LOG_JSON_PATH=logs/django.json\nPROXY_LOG_JSON_PATH=logs/proxy.json\n</code></pre>"},{"location":"reference/configuration/#api-documentation-settings","title":"API Documentation Settings","text":""},{"location":"reference/configuration/#drf-spectacular-configuration","title":"drf-spectacular Configuration","text":"<pre><code>SPECTACULAR_SETTINGS = {\n    'TITLE': 'aivonx proxy API',\n    'DESCRIPTION': 'API documentation for aivonx proxy',\n    'VERSION': '1.0.0',\n}\n</code></pre>"},{"location":"reference/configuration/#api-documentation-urls","title":"API Documentation URLs","text":"<ul> <li>OpenAPI Schema: <code>/api/schema</code></li> <li>Swagger UI: <code>/swagger</code></li> <li>ReDoc: <code>/redoc</code></li> </ul>"},{"location":"reference/configuration/#rest-framework-configuration","title":"REST Framework Configuration","text":""},{"location":"reference/configuration/#authentication","title":"Authentication","text":"<ul> <li>JWT (SimpleJWT)</li> <li>Session Authentication</li> <li>Token Authentication</li> </ul>"},{"location":"reference/configuration/#permissions","title":"Permissions","text":"<p>Default: <code>IsAuthenticated</code> (all endpoints require authentication unless explicitly set to <code>AllowAny</code>)</p>"},{"location":"reference/configuration/#pagination","title":"Pagination","text":"<ul> <li>Class: <code>LimitOffsetPagination</code></li> <li>Page Size: 100 items</li> <li>Parameters: <code>?limit=N&amp;offset=M</code></li> </ul>"},{"location":"reference/configuration/#schema-generation","title":"Schema Generation","text":"<p>Class: <code>drf_spectacular.openapi.AutoSchema</code></p>"},{"location":"reference/configuration/#authentication-settings","title":"Authentication Settings","text":""},{"location":"reference/configuration/#loginlogout-urls","title":"Login/Logout URLs","text":"<ul> <li>LOGIN_URL: <code>/</code></li> <li>LOGIN_REDIRECT_URL: <code>/ui/manage</code></li> <li>LOGOUT_REDIRECT_URL: <code>/</code></li> </ul>"},{"location":"reference/configuration/#default-root-password","title":"Default Root Password","text":"<pre><code>ROOT_PASSWORD=changeme\n</code></pre>"},{"location":"reference/configuration/#template-configuration","title":"Template Configuration","text":"<p>Template directories: - <code>{BASE_DIR}/ui/templates</code> - <code>{BASE_DIR}/proxy/templates</code> - <code>{BASE_DIR}/logviewer/templates</code></p>"},{"location":"reference/configuration/#internationalization","title":"Internationalization","text":"<ul> <li>Language Code: <code>zh-hant</code> (Traditional Chinese)</li> <li>Time Zone: <code>Asia/Taipei</code></li> <li>USE_I18N: <code>True</code></li> <li>USE_TZ: <code>True</code></li> </ul>"},{"location":"reference/configuration/#middleware-stack","title":"Middleware Stack","text":"<ol> <li><code>django.middleware.security.SecurityMiddleware</code></li> <li><code>django.contrib.sessions.middleware.SessionMiddleware</code></li> <li><code>django.middleware.common.CommonMiddleware</code></li> <li><code>django.middleware.csrf.CsrfViewMiddleware</code></li> <li><code>django.contrib.auth.middleware.AuthenticationMiddleware</code></li> <li><code>django.contrib.messages.middleware.MessageMiddleware</code></li> <li><code>django.middleware.clickjacking.XFrameOptionsMiddleware</code></li> <li><code>corsheaders.middleware.CorsMiddleware</code></li> <li><code>whitenoise.middleware.WhiteNoiseMiddleware</code></li> </ol>"},{"location":"reference/configuration/#installed-applications","title":"Installed Applications","text":"<ul> <li><code>django.contrib.admin</code></li> <li><code>django.contrib.auth</code></li> <li><code>django.contrib.contenttypes</code></li> <li><code>django.contrib.sessions</code></li> <li><code>django.contrib.messages</code></li> <li><code>django.contrib.staticfiles</code></li> <li><code>rest_framework</code></li> <li><code>drf_spectacular</code></li> <li><code>corsheaders</code></li> <li><code>proxy</code> (custom)</li> <li><code>account</code> (custom)</li> <li><code>logviewer</code> (custom)</li> </ul>"},{"location":"resources/glossary/","title":"Glossary","text":"<p>Key terms and concepts used in Aivonx Proxy.</p>"},{"location":"resources/glossary/#core-concepts","title":"Core Concepts","text":""},{"location":"resources/glossary/#node","title":"Node","text":"<p>A backend Ollama service that provides model inference capabilities. Each node: - Has a unique identifier (ID) - Has a network address (host:port) - Can host multiple models - Has an active/inactive status - Is monitored for health and latency</p> <p>Database Model: Defined in <code>src/proxy/models.py</code></p>"},{"location":"resources/glossary/#active-pool","title":"Active Pool","text":"<p>A collection of nodes that are currently healthy and available to receive requests. Nodes in the active pool: - Passed recent health checks - Can be selected by the proxy manager - Have their latency and active request counts tracked</p>"},{"location":"resources/glossary/#standby-pool","title":"Standby Pool","text":"<p>A collection of nodes that are configured but currently unhealthy or inactive. Nodes move to standby when: - Health checks fail - They are manually set to inactive - Connection errors occur</p> <p>Nodes are automatically moved back to active pool when they recover.</p>"},{"location":"resources/glossary/#proxy-manager","title":"Proxy Manager","text":"<p>The core component responsible for: - Maintaining active and standby node pools - Selecting appropriate nodes for requests - Tracking latency and active request counts - Performing periodic health checks - Managing node lifecycle</p> <p>Implementation: Located in <code>src/proxy/utils/proxy_manager.py</code></p>"},{"location":"resources/glossary/#proxyconfig","title":"ProxyConfig","text":"<p>Global configuration for the proxy's node selection strategy. Contains: - Strategy: Selection algorithm (<code>least_active</code> or <code>lowest_latency</code>) - Updated At: Last modification timestamp</p> <p>Database Model: Defined in <code>src/proxy/models.py</code></p>"},{"location":"resources/glossary/#selection-strategies","title":"Selection Strategies","text":""},{"location":"resources/glossary/#least-active-default","title":"Least Active (Default)","text":"<p>Selects the node with the fewest currently active requests. Best for: - Load balancing - Preventing overload on single nodes - Distributing work evenly</p>"},{"location":"resources/glossary/#lowest-latency","title":"Lowest Latency","text":"<p>Selects the node with the best (lowest) response time. Best for: - Minimizing response time - Geographic optimization - Performance-critical applications</p>"},{"location":"resources/glossary/#request-concepts","title":"Request Concepts","text":""},{"location":"resources/glossary/#active-request","title":"Active Request","text":"<p>A request currently being processed by a node. The count is: - Incremented when a request is dispatched - Decremented when the response completes - Stored in Redis for cross-process visibility - Used by the <code>least_active</code> selection strategy</p>"},{"location":"resources/glossary/#model-aware-routing","title":"Model-Aware Routing","text":"<p>The proxy only routes requests to nodes that have the requested model available. This ensures: - Requests never fail due to missing models - Efficient use of node resources - Automatic failover if model availability changes</p>"},{"location":"resources/glossary/#streaming-response","title":"Streaming Response","text":"<p>A response sent incrementally as it's generated, rather than waiting for completion. Benefits: - Lower latency to first token - Better user experience for chat applications - Reduced memory usage</p> <p>Requirement: ASGI server (uvicorn)</p>"},{"location":"resources/glossary/#health-and-monitoring","title":"Health and Monitoring","text":""},{"location":"resources/glossary/#health-check","title":"Health Check","text":"<p>A periodic request to a node's <code>/api/health</code> endpoint to verify: - Node is reachable - Service is responding - Node should be in active pool</p> <p>Frequency: Every 1 minute (default)</p>"},{"location":"resources/glossary/#latency","title":"Latency","text":"<p>The round-trip time for a health check request to a node. Used by: - <code>lowest_latency</code> selection strategy - Monitoring and diagnostics - Performance optimization</p> <p>Storage: Redis cache</p>"},{"location":"resources/glossary/#available-models","title":"Available Models","text":"<p>List of models currently available on a node, discovered through: - <code>/api/tags</code> endpoint queries - Periodic refresh (every 1 minute) - Manual model pulls</p> <p>Storage: Both database and Redis cache</p>"},{"location":"resources/glossary/#api-concepts","title":"API Concepts","text":""},{"location":"resources/glossary/#viewset","title":"ViewSet","text":"<p>A Django REST Framework class that provides CRUD operations for a resource. Example: - <code>NodeViewSet</code>: Manages node resources - Provides: list, create, retrieve, update, delete</p> <p>Location: <code>src/proxy/viewsets.py</code></p>"},{"location":"resources/glossary/#serializer","title":"Serializer","text":"<p>A component that converts between Python objects and JSON for API responses. Provides: - Data validation - Field-level permissions - Nested relationships</p> <p>Location: <code>src/proxy/serializers.py</code></p>"},{"location":"resources/glossary/#jwt-json-web-token","title":"JWT (JSON Web Token)","text":"<p>A stateless authentication token used for API access. Contains: - User identity - Expiration time - Cryptographic signature</p>"},{"location":"resources/glossary/#infrastructure","title":"Infrastructure","text":""},{"location":"resources/glossary/#asgi-asynchronous-server-gateway-interface","title":"ASGI (Asynchronous Server Gateway Interface)","text":"<p>Modern Python web server interface supporting: - Async/await - WebSockets - Streaming responses - Long-lived connections</p> <p>Implementation: uvicorn, Daphne</p>"},{"location":"resources/glossary/#wsgi-web-server-gateway-interface","title":"WSGI (Web Server Gateway Interface)","text":"<p>Traditional Python web server interface for: - Synchronous request/response - Traditional web applications</p> <p>Implementation: Gunicorn, uWSGI</p>"},{"location":"resources/glossary/#redis","title":"Redis","text":"<p>In-memory data store used for: - Caching node state - Storing active request counts - Session storage - Task queue (optional)</p>"},{"location":"resources/glossary/#postgresql","title":"PostgreSQL","text":"<p>Relational database used for: - Node configuration - Proxy configuration - User accounts - Audit logs</p>"},{"location":"resources/glossary/#django-concepts","title":"Django Concepts","text":""},{"location":"resources/glossary/#migration","title":"Migration","text":"<p>A Python file that describes changes to database schema. Used to: - Version control database structure - Deploy schema changes - Roll back changes if needed</p> <p>Location: <code>src/*/migrations/</code></p>"},{"location":"resources/glossary/#app-config","title":"App Config","text":"<p>Django application configuration that can: - Initialize global state - Register signal handlers - Configure application-specific settings</p> <p>Example: Proxy manager initialization in <code>src/proxy/apps.py</code></p>"},{"location":"resources/glossary/#middleware","title":"Middleware","text":"<p>Components that process requests/responses globally: - Security headers - CORS - Authentication - Logging</p>"},{"location":"resources/glossary/#acronyms","title":"Acronyms","text":"<ul> <li>API: Application Programming Interface</li> <li>ASGI: Asynchronous Server Gateway Interface</li> <li>CORS: Cross-Origin Resource Sharing</li> <li>CRUD: Create, Read, Update, Delete</li> <li>CSRF: Cross-Site Request Forgery</li> <li>DRF: Django REST Framework</li> <li>HA: High Availability</li> <li>HTTP: Hypertext Transfer Protocol</li> <li>HTTPS: HTTP Secure</li> <li>JSON: JavaScript Object Notation</li> <li>JWT: JSON Web Token</li> <li>REST: Representational State Transfer</li> <li>SSL: Secure Sockets Layer</li> <li>TLS: Transport Layer Security</li> <li>UI: User Interface</li> <li>URL: Uniform Resource Locator</li> <li>WSGI: Web Server Gateway Interface</li> </ul>"},{"location":"resources/security/","title":"Security","text":"<p>This document provides comprehensive security guidelines and configuration options for the aivonx_proxy application. It covers authentication, authorization, environment configuration, and best practices for production deployments.</p>"},{"location":"resources/security/#table-of-contents","title":"Table of Contents","text":"<ul> <li><code>Security Overview</code></li> <li><code>Environment Configuration</code></li> <li><code>Authentication &amp; Authorization</code></li> <li><code>CORS &amp; CSRF Protection</code></li> <li><code>Database Security</code></li> <li><code>Password Security</code></li> <li><code>Production Security Checklist</code></li> <li><code>Security Middleware</code></li> <li><code>API Endpoint Security</code></li> <li><code>Logging &amp; Monitoring</code></li> <li><code>Container Security</code></li> </ul>"},{"location":"resources/security/#security-overview","title":"Security Overview","text":"<p>The aivonx_proxy application implements multiple layers of security to protect against common vulnerabilities:</p> <ul> <li>Authentication: Multi-method authentication including JWT, Session, and Token authentication</li> <li>Authorization: Role-based access control with permission classes</li> <li>CORS Protection: Configurable Cross-Origin Resource Sharing policies</li> <li>CSRF Protection: Cross-Site Request Forgery protection for state-changing operations</li> <li>Password Validation: Django's comprehensive password validation framework</li> <li>Secure Defaults: Production-safe defaults with explicit environment configuration</li> </ul>"},{"location":"resources/security/#environment-configuration","title":"Environment Configuration","text":""},{"location":"resources/security/#required-environment-variables-production","title":"Required Environment Variables (Production)","text":"<p>The following environment variables MUST be configured in production environments:</p>"},{"location":"resources/security/#django_secret_key","title":"<code>DJANGO_SECRET_KEY</code>","text":"<p>Critical: The Django secret key is used for cryptographic signing and MUST be kept secret.</p> <pre><code>DJANGO_SECRET_KEY=\"your-long-random-secret-key-here\"\n</code></pre> <p>Requirements: - Must be set when <code>DJANGO_DEBUG=false</code> - Should be at least 50 characters long - Must be random and unpredictable - Never commit to version control - Rotate periodically in production</p> <p>Generation Example: <pre><code>python -c 'from django.core.management.utils import get_random_secret_key; print(get_random_secret_key())'\n</code></pre></p>"},{"location":"resources/security/#django_debug","title":"<code>DJANGO_DEBUG</code>","text":"<p>Controls Django's debug mode. MUST be disabled in production.</p> <pre><code>DJANGO_DEBUG=false\n</code></pre> <p>Security Impact: - When <code>true</code>: Exposes detailed error messages, settings, and stack traces - When <code>false</code>: Shows generic error pages, hides sensitive information - Always set to <code>false</code> in production</p> <p>Accepted Values: <code>true</code>, <code>false</code>, <code>1</code>, <code>0</code>, <code>yes</code>, <code>no</code> (case-insensitive)</p>"},{"location":"resources/security/#django_allowed_hosts","title":"<code>DJANGO_ALLOWED_HOSTS</code>","text":"<p>Comma-separated list of host/domain names that Django will serve.</p> <pre><code>DJANGO_ALLOWED_HOSTS=\"yourdomain.com,www.yourdomain.com,api.yourdomain.com\"\n</code></pre> <p>Requirements: - Required when <code>DJANGO_DEBUG=false</code> - Must include all domains that will access your application - Prevents HTTP Host header attacks - Use <code>*</code> only for development (insecure for production)</p> <p>Examples: <pre><code># Production\nDJANGO_ALLOWED_HOSTS=\"example.com,www.example.com\"\n\n# Development (NOT for production)\nDJANGO_ALLOWED_HOSTS=\"*\"\n\n# IP-based access\nDJANGO_ALLOWED_HOSTS=\"192.168.1.100,10.0.0.50\"\n</code></pre></p>"},{"location":"resources/security/#optional-security-environment-variables","title":"Optional Security Environment Variables","text":""},{"location":"resources/security/#root_password","title":"<code>ROOT_PASSWORD</code>","text":"<p>Default password for the root administrative user created during initial migration.</p> <pre><code>ROOT_PASSWORD=\"your-secure-password\"\n</code></pre> <p>Important: - Default value: <code>changeme</code> (insecure) - MUST be changed before production deployment - The root user is created automatically with <code>username: root</code> - Used for administrative access to the web UI and API</p> <p>Security Note: This password is only used during the initial database migration. After deployment, change it immediately through the Django admin interface or command line.</p>"},{"location":"resources/security/#authentication-authorization","title":"Authentication &amp; Authorization","text":""},{"location":"resources/security/#authentication-methods","title":"Authentication Methods","text":"<p>The application supports three authentication methods (configured in <code>../src/aivonx/settings.py#L187-L196</code>):</p>"},{"location":"resources/security/#1-jwt-authentication-primary","title":"1. JWT Authentication (Primary)","text":"<p>JSON Web Token authentication using <code>djangorestframework-simplejwt</code>.</p> <p>Endpoint: <code>POST /api/account/login</code></p> <p>Request: <pre><code>{\n  \"username\": \"root\",\n  \"password\": \"your-password\"\n}\n</code></pre></p> <p>Response: <pre><code>{\n  \"access\": \"eyJ0eXAiOiJKV1QiLCJhbGc...\",\n  \"refresh\": \"eyJ0eXAiOiJKV1QiLCJhbGc...\"\n}\n</code></pre></p> <p>Usage: <pre><code># Include access token in Authorization header\nAuthorization: Bearer eyJ0eXAiOiJKV1QiLCJhbGc...\n</code></pre></p> <p>Security Features: - Stateless authentication - Time-limited access tokens - Refresh token rotation support - No server-side session storage required</p>"},{"location":"resources/security/#2-session-authentication","title":"2. Session Authentication","text":"<p>Traditional Django session-based authentication using cookies.</p> <p>Use Case: Web UI authentication via login forms</p> <p>Login URL: <code>/ui/login</code> (configured via <code>LOGIN_URL</code> in <code>../src/aivonx/settings.py#L176</code>)</p> <p>Features: - CSRF protection enabled - Session cookie security - Server-side session management via Redis</p>"},{"location":"resources/security/#3-token-authentication","title":"3. Token Authentication","text":"<p>Django REST Framework token authentication.</p> <p>Usage: <pre><code>Authorization: Token 9944b09199c62bcf9418ad846dd0e4bbdfc6ee4b\n</code></pre></p>"},{"location":"resources/security/#authorization-permissions","title":"Authorization &amp; Permissions","text":""},{"location":"resources/security/#default-permission-policy","title":"Default Permission Policy","text":"<p>Global Setting: All API endpoints require authentication by default.</p> <pre><code>\"DEFAULT_PERMISSION_CLASSES\": (\n    \"rest_framework.permissions.IsAuthenticated\",\n)\n</code></pre>"},{"location":"resources/security/#permission-decorators","title":"Permission Decorators","text":"<p>Individual endpoints can override the default policy:</p> Decorator Behavior Use Case <code>@permission_classes([IsAuthenticated])</code> Requires valid authentication Protected endpoints <code>@permission_classes([AllowAny])</code> No authentication required Public endpoints <code>@login_required</code> Requires session login Web UI views"},{"location":"resources/security/#endpoint-permission-map","title":"Endpoint Permission Map","text":"Endpoint Permission Rationale <code>POST /api/account/login</code> <code>AllowAny</code> Public login endpoint <code>GET /api/proxy/state</code> <code>AllowAny</code> Public health/diagnostics <code>POST /api/proxy/generate</code> <code>AllowAny</code> Public proxy endpoint (configurable) <code>POST /api/proxy/chat</code> <code>AllowAny</code> Public proxy endpoint (configurable) <code>POST /api/proxy/embeddings</code> <code>AllowAny</code> Public proxy endpoint (configurable) <code>GET /api/tags</code> <code>AllowAny</code> Public model discovery <code>GET /api/config</code> <code>IsAuthenticated</code> Protected configuration access Web UI (<code>/ui/manage</code>) <code>@login_required</code> Session-based authentication Admin Panel (<code>/admin/</code>) Staff users only Django built-in admin <p>Security Consideration: The proxy endpoints (<code>/api/proxy/*</code>) use <code>AllowAny</code> by default to facilitate integration with external tools. For production deployments requiring access control, consider: 1. Implementing API key authentication 2. Using a reverse proxy (nginx, Traefik) for IP whitelisting 3. Deploying within a private network/VPN</p>"},{"location":"resources/security/#web-ui-authentication","title":"Web UI Authentication","text":"<p>Web-based management interface requires session authentication:</p> <ul> <li>Login URL: <code>/ui/login</code></li> <li>Protected URL: <code>/ui/manage</code></li> <li>Logout URL: <code>/logout</code></li> <li>Decorator: <code>@login_required</code> + <code>@csrf_protect</code></li> </ul> <p>Features: - Session-based authentication with Redis backend - CSRF protection on all POST requests - Automatic redirect to login page for unauthenticated users - Redirect to management page after successful login</p>"},{"location":"resources/security/#cors-csrf-protection","title":"CORS &amp; CSRF Protection","text":""},{"location":"resources/security/#cors-cross-origin-resource-sharing","title":"CORS (Cross-Origin Resource Sharing)","text":""},{"location":"resources/security/#django_cors_allowed_origins","title":"<code>DJANGO_CORS_ALLOWED_ORIGINS</code>","text":"<p>Comma-separated list of origins allowed to make cross-origin requests.</p> <pre><code>DJANGO_CORS_ALLOWED_ORIGINS=\"https://example.com,https://app.example.com\"\n</code></pre> <p>Configuration: - Automatically prefixes <code>http://</code> if scheme is missing - Supports both HTTP and HTTPS origins - Empty by default (no origins allowed) - Required for browser-based clients on different domains</p> <p>Examples: <pre><code># Multiple origins with explicit schemes\nDJANGO_CORS_ALLOWED_ORIGINS=\"https://example.com,https://api.example.com\"\n\n# Will be auto-prefixed with http://\nDJANGO_CORS_ALLOWED_ORIGINS=\"localhost:3000,192.168.1.100:8080\"\n\n# Production with multiple frontend domains\nDJANGO_CORS_ALLOWED_ORIGINS=\"https://app.example.com,https://admin.example.com,https://mobile.example.com\"\n</code></pre></p>"},{"location":"resources/security/#cors-settings","title":"CORS Settings","text":"<pre><code>CORS_ALLOW_CREDENTIALS = True  # Allow cookies in cross-origin requests\n</code></pre> <p>Security Note: Only enable <code>CORS_ALLOW_CREDENTIALS</code> if your frontend needs to send cookies or authentication headers. Always pair with a restrictive <code>DJANGO_CORS_ALLOWED_ORIGINS</code> list.</p>"},{"location":"resources/security/#csrf-cross-site-request-forgery","title":"CSRF (Cross-Site Request Forgery)","text":""},{"location":"resources/security/#django_csrf_trusted_origins","title":"<code>DJANGO_CSRF_TRUSTED_ORIGINS</code>","text":"<p>List of origins trusted for CSRF-protected requests (especially POST, PUT, DELETE).</p> <pre><code>DJANGO_CSRF_TRUSTED_ORIGINS=\"https://example.com,https://admin.example.com\"\n</code></pre> <p>Requirements: - Must include scheme (<code>http://</code> or <code>https://</code>) - Required for any domain making POST/PUT/DELETE requests - Automatically prefixes <code>http://</code> if scheme is missing - Must match the domains users will access</p> <p>Examples: <pre><code># Production HTTPS deployment\nDJANGO_CSRF_TRUSTED_ORIGINS=\"https://example.com,https://www.example.com\"\n\n# Development environment\nDJANGO_CSRF_TRUSTED_ORIGINS=\"http://localhost:8000,http://127.0.0.1:8000\"\n\n# Mixed environments (not recommended)\nDJANGO_CSRF_TRUSTED_ORIGINS=\"http://localhost:8000,https://production.example.com\"\n</code></pre></p>"},{"location":"resources/security/#csrf-middleware","title":"CSRF Middleware","text":"<p>CSRF protection is enforced via Django's <code>CsrfViewMiddleware</code>:</p> <pre><code>MIDDLEWARE = [\n    ...\n    'django.middleware.csrf.CsrfViewMiddleware',\n    ...\n]\n</code></pre> <p>Protected Views: All web UI views with <code>@csrf_protect</code> decorator require valid CSRF tokens in POST requests.</p>"},{"location":"resources/security/#database-security","title":"Database Security","text":""},{"location":"resources/security/#postgresql-configuration","title":"PostgreSQL Configuration","text":"<p>The application uses PostgreSQL as the primary database. Credentials are configured via environment variables:</p> <pre><code>POSTGRES_USER=\"user\"\nPOSTGRES_PASSWORD=\"secure-password-here\"\nPOSTGRES_DB=\"app_db\"\nPOSTGRES_HOST=\"postgres\"\nPOSTGRES_PORT=\"5432\"\n</code></pre> <p>Security Recommendations: 1. Use strong passwords: Minimum 16 characters with mixed case, numbers, and symbols 2. Limit network access: Configure <code>pg_hba.conf</code> to restrict connections 3. Use SSL/TLS: Enable SSL connections in production 4. Regular backups: Implement automated backup procedures 5. Least privilege: Create application-specific database users with minimal permissions</p>"},{"location":"resources/security/#redis-configuration","title":"Redis Configuration","text":"<p>Redis is used for caching and session storage:</p> <pre><code>REDIS_URL=\"redis://redis:6379/1\"\n</code></pre> <p>Security Recommendations: 1. Enable authentication: Set <code>requirepass</code> in redis.conf 2. Bind to localhost: Prevent external access unless required 3. Use separate databases: Isolate cache and session data 4. Disable dangerous commands: Use <code>rename-command</code> for FLUSHDB, FLUSHALL, etc.</p>"},{"location":"resources/security/#connection-security","title":"Connection Security","text":"<pre><code>DATABASES = {\n    'default': {\n        'ENGINE': 'django.db.backends.postgresql',\n        'NAME': os.getenv(\"POSTGRES_DB\", \"app_db\"),\n        'USER': os.getenv(\"POSTGRES_USER\", \"user\"),\n        'PASSWORD': os.getenv(\"POSTGRES_PASSWORD\", \"password\"),\n        'HOST': os.getenv(\"POSTGRES_HOST\", \"postgres\"),\n        'PORT': os.getenv(\"POSTGRES_PORT\", \"5432\"),\n    }\n}\n</code></pre> <p>Production Hardening: - Enable SSL: Add <code>'OPTIONS': {'sslmode': 'require'}</code> to the database configuration - Use connection pooling - Set appropriate connection timeouts - Monitor database logs for suspicious activity</p>"},{"location":"resources/security/#password-security","title":"Password Security","text":""},{"location":"resources/security/#password-validation","title":"Password Validation","text":"<p>Django enforces strong password requirements through validators:</p> <pre><code>AUTH_PASSWORD_VALIDATORS = [\n    {\n        'NAME': 'django.contrib.auth.password_validation.UserAttributeSimilarityValidator',\n        # Prevents passwords similar to user attributes (username, email, etc.)\n    },\n    {\n        'NAME': 'django.contrib.auth.password_validation.MinimumLengthValidator',\n        # Default: Minimum 8 characters\n    },\n    {\n        'NAME': 'django.contrib.auth.password_validation.CommonPasswordValidator',\n        # Prevents use of common passwords (top 20,000 most common)\n    },\n    {\n        'NAME': 'django.contrib.auth.password_validation.NumericPasswordValidator',\n        # Prevents entirely numeric passwords\n    },\n]\n</code></pre> <p>Enforced Requirements: - \u2713 Minimum 8 characters (configurable) - \u2713 Cannot be entirely numeric - \u2713 Cannot be too similar to username or email - \u2713 Cannot be a commonly used password - \u2713 Validated on user creation and password changes</p>"},{"location":"resources/security/#password-hashing","title":"Password Hashing","text":"<p>Django uses PBKDF2 algorithm with SHA256 hash for password storage:</p> <ul> <li>Algorithm: PBKDF2-HMAC-SHA256</li> <li>Iterations: 870,000 (Django 5.2 default, increases with each version)</li> <li>Automatic upgrading: Passwords are rehashed on login if iteration count increases</li> </ul> <p>Security Note: Passwords are never stored in plain text. The migration <code>../src/account/migrations/0003_create_root.py</code> uses <code>make_password()</code> to hash the root password before storage.</p>"},{"location":"resources/security/#production-security-checklist","title":"Production Security Checklist","text":"<p>Use this checklist before deploying to production:</p>"},{"location":"resources/security/#critical-must-have","title":"Critical (Must-Have)","text":"<ul> <li>[ ] Set <code>DJANGO_DEBUG=false</code></li> <li>[ ] Configure <code>DJANGO_SECRET_KEY</code> with a strong, random value (50+ characters)</li> <li>[ ] Set <code>DJANGO_ALLOWED_HOSTS</code> to your actual domain(s)</li> <li>[ ] Change <code>ROOT_PASSWORD</code> from default <code>changeme</code></li> <li>[ ] Enable HTTPS/TLS for all connections</li> <li>[ ] Configure <code>DJANGO_CSRF_TRUSTED_ORIGINS</code> with your domains (including <code>https://</code> scheme)</li> <li>[ ] Set strong <code>POSTGRES_PASSWORD</code> (16+ characters)</li> <li>[ ] Review and restrict <code>DJANGO_CORS_ALLOWED_ORIGINS</code></li> </ul>"},{"location":"resources/security/#recommended","title":"Recommended","text":"<ul> <li>[ ] Enable database SSL connections</li> <li>[ ] Configure Redis authentication (<code>requirepass</code>)</li> <li>[ ] Set up log monitoring and alerting</li> <li>[ ] Implement rate limiting on authentication endpoints</li> <li>[ ] Use environment-specific <code>.env</code> files (never commit to git)</li> <li>[ ] Enable Redis persistence for session data</li> <li>[ ] Configure firewall rules to restrict database access</li> <li>[ ] Set up automated database backups</li> <li>[ ] Review all <code>AllowAny</code> permission endpoints and restrict if necessary</li> <li>[ ] Implement API key authentication for proxy endpoints if needed</li> </ul>"},{"location":"resources/security/#security-headers-recommended-additions","title":"Security Headers (Recommended Additions)","text":"<p>Consider adding these security middleware and headers:</p> <pre><code># settings.py additions for production\n\n# Security Middleware Settings\nSECURE_SSL_REDIRECT = True  # Redirect HTTP to HTTPS\nSECURE_HSTS_SECONDS = 31536000  # 1 year\nSECURE_HSTS_INCLUDE_SUBDOMAINS = True\nSECURE_HSTS_PRELOAD = True\nSECURE_CONTENT_TYPE_NOSNIFF = True\nSECURE_BROWSER_XSS_FILTER = True\nX_FRAME_OPTIONS = 'DENY'  # Prevent clickjacking\nSESSION_COOKIE_SECURE = True  # HTTPS only cookies\nCSRF_COOKIE_SECURE = True  # HTTPS only CSRF cookies\nSESSION_COOKIE_HTTPONLY = True  # Prevent JavaScript access to session cookie\nCSRF_COOKIE_HTTPONLY = True\n</code></pre> <p>Note: These settings are not currently enabled by default but are strongly recommended for production HTTPS deployments.</p>"},{"location":"resources/security/#security-middleware","title":"Security Middleware","text":"<p>The application uses Django's security middleware stack (configured in <code>../src/aivonx/settings.py#L68-L77</code>):</p> <pre><code>MIDDLEWARE = [\n    'django.middleware.security.SecurityMiddleware',  # Security headers\n    'django.contrib.sessions.middleware.SessionMiddleware',  # Session management\n    'django.middleware.common.CommonMiddleware',  # Common utilities\n    'django.middleware.csrf.CsrfViewMiddleware',  # CSRF protection\n    'django.contrib.auth.middleware.AuthenticationMiddleware',  # Auth\n    'django.contrib.messages.middleware.MessageMiddleware',  # Flash messages\n    'django.middleware.clickjacking.XFrameOptionsMiddleware',  # Clickjacking protection\n    'corsheaders.middleware.CorsMiddleware',  # CORS handling\n    'whitenoise.middleware.WhiteNoiseMiddleware',  # Static file serving\n]\n</code></pre>"},{"location":"resources/security/#middleware-functions","title":"Middleware Functions","text":"Middleware Function Security Benefit <code>SecurityMiddleware</code> Adds security headers HSTS, SSL redirect, content type sniffing protection <code>SessionMiddleware</code> Manages user sessions Secure session handling via Redis <code>CsrfViewMiddleware</code> CSRF token validation Prevents CSRF attacks on state-changing operations <code>AuthenticationMiddleware</code> User authentication Attaches authenticated user to requests <code>XFrameOptionsMiddleware</code> X-Frame-Options header Prevents clickjacking attacks <code>CorsMiddleware</code> CORS policy enforcement Controls cross-origin resource access"},{"location":"resources/security/#api-endpoint-security","title":"API Endpoint Security","text":""},{"location":"resources/security/#public-endpoints-no-authentication-required","title":"Public Endpoints (No Authentication Required)","text":"<p>These endpoints use <code>@permission_classes([AllowAny])</code>:</p> Endpoint Method Purpose Security Note <code>/api/account/login</code> POST User authentication Public by design (login endpoint) <code>/api/proxy/state</code> GET Health check Diagnostics endpoint, minimal information exposure <code>/api/proxy/generate</code> POST Ollama proxy Consider restricting in production <code>/api/proxy/chat</code> POST Ollama proxy Consider restricting in production <code>/api/proxy/embeddings</code> POST Ollama proxy Consider restricting in production <code>/api/proxy/embed</code> POST Ollama proxy Consider restricting in production <code>/api/tags</code> GET Model listing Public model discovery <code>/health</code> GET Application health Basic health check"},{"location":"resources/security/#protected-endpoints-authentication-required","title":"Protected Endpoints (Authentication Required)","text":"<p>These endpoints require valid authentication (JWT, Session, or Token):</p> Endpoint Method Permission Purpose <code>/api/config</code> GET <code>IsAuthenticated</code> Configuration retrieval <code>/api/proxy/nodes</code> GET/POST/PUT/DELETE Default (<code>IsAuthenticated</code>) Node management <code>/ui/manage</code> GET/POST <code>@login_required</code> Web UI management interface <code>/admin/*</code> ALL Staff users Django admin panel"},{"location":"resources/security/#security-recommendations-for-proxy-endpoints","title":"Security Recommendations for Proxy Endpoints","text":"<p>The proxy endpoints (<code>/api/proxy/*</code>) are public by default to facilitate integration with Ollama-compatible tools. For production deployments requiring access control:</p>"},{"location":"resources/security/#option-1-reverse-proxy-authentication","title":"Option 1: Reverse Proxy Authentication","text":"<p>Use nginx or Traefik to add authentication:</p> <pre><code>location /api/proxy/ {\n    auth_basic \"Restricted Access\";\n    auth_basic_user_file /etc/nginx/.htpasswd;\n    proxy_pass http://django:8000;\n}\n</code></pre>"},{"location":"resources/security/#option-2-ip-whitelisting","title":"Option 2: IP Whitelisting","text":"<p>Restrict access to known IP addresses:</p> <pre><code>location /api/proxy/ {\n    allow 192.168.1.0/24;\n    allow 10.0.0.0/8;\n    deny all;\n    proxy_pass http://django:8000;\n}\n</code></pre>"},{"location":"resources/security/#option-3-vpnprivate-network","title":"Option 3: VPN/Private Network","text":"<p>Deploy within a private network accessible only via VPN.</p>"},{"location":"resources/security/#option-4-custom-authentication","title":"Option 4: Custom Authentication","text":"<p>Modify the code to require authentication:</p> <pre><code># In views_proxy.py, change:\n@permission_classes([AllowAny])\n# To:\n@permission_classes([IsAuthenticated])\n</code></pre>"},{"location":"resources/security/#logging-monitoring","title":"Logging &amp; Monitoring","text":""},{"location":"resources/security/#security-relevant-logging","title":"Security-Relevant Logging","text":"<p>The application implements comprehensive logging (configured in <code>../src/aivonx/settings.py#L214-L326</code>):</p>"},{"location":"resources/security/#log-files","title":"Log Files","text":"Log File Purpose Content <code>logs/django.json</code> General application logs INFO level, all Django operations <code>logs/django_error.log</code> Error logs ERROR level, exceptions and errors <code>logs/proxy.json</code> Proxy operation logs Proxy requests, node selection, errors"},{"location":"resources/security/#security-events-logged","title":"Security Events Logged","text":"<ul> <li>Authentication attempts (success/failure)</li> <li>Authorization failures</li> <li>Request errors (400, 401, 403, 404, 500 series)</li> <li>Database connection issues</li> <li>Proxy node failures</li> </ul>"},{"location":"resources/security/#log-formats","title":"Log Formats","text":"<ul> <li>JSON Format: Structured logs for easy parsing and analysis</li> <li>Verbose Format: Detailed logs with module, process, thread information</li> <li>Rotation: 10MB per file, 3 backups retained</li> </ul>"},{"location":"resources/security/#monitoring-recommendations","title":"Monitoring Recommendations","text":"<ol> <li>Monitor failed authentication attempts: Detect brute-force attacks</li> <li>Track error rates: Identify potential attacks or system issues</li> <li>Monitor proxy endpoint usage: Detect abuse or unusual patterns</li> <li>Database connection monitoring: Detect potential database attacks</li> <li>Log aggregation: Use ELK stack, Splunk, or similar for centralized logging</li> </ol>"},{"location":"resources/security/#example-monitoring-failed-logins","title":"Example: Monitoring Failed Logins","text":"<pre><code># Parse JSON logs for failed login attempts\ncat logs/django.json | jq 'select(.message | contains(\"Invalid credentials\"))'\n\n# Count failed login attempts in the last hour\ncat logs/django.json | \\\n  jq -r 'select(.message | contains(\"Invalid credentials\")) | .asctime' | \\\n  awk -v now=\"$(date +%s)\" '{ ... }' | wc -l\n</code></pre>"},{"location":"resources/security/#container-security","title":"Container Security","text":""},{"location":"resources/security/#docker-configuration","title":"Docker Configuration","text":"<p>The application runs in Docker containers with security configurations:</p>"},{"location":"resources/security/#container-settings-docker-composeymll1-l8","title":"Container Settings (<code>../docker-compose.yml#L1-L8</code>)","text":"<pre><code>x-default-opts: &amp;default-opts\n  restart: unless-stopped\n  tty: true\n  stdin_open: true\n  privileged: false  # Never run with elevated privileges\n  ipc: private  # Isolated IPC namespace\n</code></pre> <p>Security Features: - \u2713 <code>privileged: false</code> - Prevents container from gaining root-equivalent host access - \u2713 <code>ipc: private</code> - Isolates inter-process communication - \u2713 Non-root user context (recommended addition, see below) - \u2713 Health checks for all services - \u2713 Isolated bridge network</p>"},{"location":"resources/security/#container-hardening-recommendations","title":"Container Hardening Recommendations","text":""},{"location":"resources/security/#1-run-as-non-root-user","title":"1. Run as Non-Root User","text":"<p>Add to Dockerfile:</p> <pre><code>RUN useradd -m -u 1000 appuser\nUSER appuser\n</code></pre>"},{"location":"resources/security/#2-read-only-filesystem","title":"2. Read-Only Filesystem","text":"<pre><code>services:\n  django:\n    read_only: true\n    tmpfs:\n      - /tmp\n      - /app/logs\n</code></pre>"},{"location":"resources/security/#3-resource-limits","title":"3. Resource Limits","text":"<pre><code>services:\n  django:\n    deploy:\n      resources:\n        limits:\n          cpus: '2'\n          memory: 2G\n        reservations:\n          memory: 512M\n</code></pre>"},{"location":"resources/security/#4-network-segmentation","title":"4. Network Segmentation","text":"<pre><code>networks:\n  frontend:\n    driver: bridge\n  backend:\n    driver: bridge\n    internal: true  # No internet access\n\nservices:\n  django:\n    networks:\n      - frontend\n      - backend\n  postgres:\n    networks:\n      - backend  # Database only accessible from backend network\n</code></pre>"},{"location":"resources/security/#5-secrets-management","title":"5. Secrets Management","text":"<p>Use Docker secrets instead of environment variables for sensitive data:</p> <pre><code>secrets:\n  db_password:\n    external: true\n  secret_key:\n    external: true\n\nservices:\n  django:\n    secrets:\n      - db_password\n      - secret_key\n</code></pre>"},{"location":"resources/security/#image-security","title":"Image Security","text":"<ul> <li>Base Image: <code>python:3.12-slim-bookworm</code> (minimal attack surface)</li> <li>Package Updates: Regular base image updates</li> <li>Vulnerability Scanning: Run <code>docker scan</code> or Trivy regularly</li> </ul> <pre><code># Scan for vulnerabilities\ndocker scan aivonx_proxy:latest\n\n# Or use Trivy\ntrivy image aivonx_proxy:latest\n</code></pre>"},{"location":"resources/security/#additional-security-resources","title":"Additional Security Resources","text":""},{"location":"resources/security/#django-security-documentation","title":"Django Security Documentation","text":"<ul> <li>Django Security Overview</li> <li>Django Deployment Checklist</li> <li>Django Authentication System</li> </ul>"},{"location":"resources/security/#owasp-resources","title":"OWASP Resources","text":"<ul> <li>OWASP Top 10</li> <li>OWASP REST Security Cheat Sheet</li> <li>OWASP Docker Security Cheat Sheet</li> </ul>"},{"location":"resources/security/#security-testing-tools","title":"Security Testing Tools","text":"<ul> <li>OWASP ZAP: Automated security testing</li> <li>Bandit: Python security linter</li> <li>Safety: Python dependency vulnerability scanner</li> <li>Trivy: Container vulnerability scanner</li> </ul> <pre><code># Run security checks\nbandit -r src/\nsafety check\ntrivy image your-image:tag\n</code></pre>"},{"location":"resources/security/#security-contact","title":"Security Contact","text":"<p>If you discover a security vulnerability, please:</p> <ol> <li>Do NOT open a public issue</li> <li>Email the maintainers directly (see <code>../../README.md</code>)</li> <li>Include detailed steps to reproduce</li> <li>Allow reasonable time for a fix before public disclosure</li> </ol>"},{"location":"resources/troubleshooting/","title":"Troubleshooting","text":"<p>Common issues and solutions for Aivonx Proxy.</p>"},{"location":"resources/troubleshooting/#logging-and-diagnostics","title":"Logging and Diagnostics","text":""},{"location":"resources/troubleshooting/#log-file-locations","title":"Log File Locations","text":"<ul> <li>General Logs: <code>logs/django.json</code> (JSON format)</li> <li>Proxy Logs: <code>logs/proxy.json</code> (JSON format)</li> <li>Error Logs: <code>logs/django_error.log</code> (ERROR level only)</li> <li>Debug Logs: <code>logs/django_debug.log</code> (DEBUG level, if enabled)</li> </ul>"},{"location":"resources/troubleshooting/#viewing-logs","title":"Viewing Logs","text":"<pre><code># Tail general logs\ntail -f logs/django.json | jq\n\n# Tail proxy logs\ntail -f logs/proxy.json | jq\n\n# View error logs\ntail -f logs/django_error.log\n\n# Docker logs\ndocker-compose logs -f django\n</code></pre>"},{"location":"resources/troubleshooting/#common-issues","title":"Common Issues","text":""},{"location":"resources/troubleshooting/#application-wont-start","title":"Application Won't Start","text":""},{"location":"resources/troubleshooting/#check-database-connection","title":"Check Database Connection","text":"<pre><code># Verify PostgreSQL is running\ndocker-compose ps postgres\n\n# Test connection\npsql -h localhost -U user -d app_db\n\n# Check environment variables\nenv | grep POSTGRES\n</code></pre> <p>Solution: Ensure PostgreSQL service is running and credentials are correct in <code>.env</code> or environment variables.</p>"},{"location":"resources/troubleshooting/#check-redis-connection","title":"Check Redis Connection","text":"<pre><code># Verify Redis is running\ndocker-compose ps redis\n\n# Test connection\nredis-cli -h localhost ping\n\n# Check environment variable\necho $REDIS_URL\n</code></pre> <p>Solution: Ensure Redis service is running and <code>REDIS_URL</code> is correctly set.</p>"},{"location":"resources/troubleshooting/#missing-secret_key","title":"Missing SECRET_KEY","text":"<p>Error: <code>ValueError: DJANGO_SECRET_KEY environment variable is required</code></p> <p>Solution: Set <code>DJANGO_SECRET_KEY</code> in your environment:</p> <pre><code>export DJANGO_SECRET_KEY=\"your-secret-key-here\"\n# Or in .env file\necho \"DJANGO_SECRET_KEY=your-secret-key-here\" &gt;&gt; .env\n</code></pre>"},{"location":"resources/troubleshooting/#node-health-check-failures","title":"Node Health Check Failures","text":""},{"location":"resources/troubleshooting/#symptoms","title":"Symptoms","text":"<ul> <li>Nodes appear as inactive in <code>/api/proxy/state</code></li> <li>Requests return \"no healthy nodes available\"</li> </ul>"},{"location":"resources/troubleshooting/#diagnosis","title":"Diagnosis","text":"<pre><code># Check node health directly\ncurl http://node-address:11434/api/health\n\n# Check proxy state\ncurl http://localhost:8000/api/proxy/state\n\n# Check active requests\ncurl http://localhost:8000/api/proxy/active-requests\n</code></pre>"},{"location":"resources/troubleshooting/#solutions","title":"Solutions","text":"<ol> <li> <p>Network Connectivity: Ensure the proxy can reach the node    <pre><code>ping node-address\ntelnet node-address 11434\n</code></pre></p> </li> <li> <p>Firewall Rules: Check that port 11434 (or configured port) is open</p> </li> <li> <p>Node is Down: Restart the Ollama service on the node    <pre><code>systemctl restart ollama  # On Linux\n</code></pre></p> </li> <li> <p>Force Refresh: The health check runs every minute, or trigger manually:    <pre><code>from proxy.utils.proxy_manager import get_global_manager\nmgr = get_global_manager()\nmgr.refresh_from_db()\n</code></pre></p> </li> </ol>"},{"location":"resources/troubleshooting/#cache-issues","title":"Cache Issues","text":""},{"location":"resources/troubleshooting/#stale-cache-data","title":"Stale Cache Data","text":"<p>Symptoms: State endpoint shows outdated information</p> <p>Solution: Clear Redis cache</p> <pre><code># Using Django shell\npython src/manage.py shell\n&gt;&gt;&gt; from django.core.cache import cache\n&gt;&gt;&gt; cache.clear()\n\n# Or directly with Redis\nredis-cli FLUSHDB\n</code></pre>"},{"location":"resources/troubleshooting/#redis-connection-errors","title":"Redis Connection Errors","text":"<p>Error: <code>ConnectionError: Error connecting to Redis</code></p> <p>Solution: 1. Verify Redis is running 2. Check <code>REDIS_URL</code> format: <code>redis://host:port/db</code> 3. Test connection:    <pre><code>redis-cli -u $REDIS_URL ping\n</code></pre></p>"},{"location":"resources/troubleshooting/#streaming-issues","title":"Streaming Issues","text":""},{"location":"resources/troubleshooting/#streaming-responses-not-working","title":"Streaming Responses Not Working","text":"<p>Symptoms: Responses are fully buffered instead of streaming</p> <p>Cause: Using WSGI server instead of ASGI</p> <p>Solution: Use uvicorn or gunicorn with uvicorn workers:</p> <pre><code># Development\nuvicorn aivonx.asgi:application --reload\n\n# Production\ngunicorn aivonx.asgi:application -k uvicorn.workers.UvicornWorker --workers 4\n</code></pre>"},{"location":"resources/troubleshooting/#static-files-not-loading","title":"Static Files Not Loading","text":""},{"location":"resources/troubleshooting/#development","title":"Development","text":"<p>Solution: Ensure <code>DEBUG=True</code> or run <code>collectstatic</code></p> <pre><code>python src/manage.py collectstatic --noinput\n</code></pre>"},{"location":"resources/troubleshooting/#production","title":"Production","text":"<p>Solution: Verify WhiteNoise middleware is enabled and static files are collected:</p> <pre><code>python src/manage.py collectstatic --noinput --clear\n</code></pre>"},{"location":"resources/troubleshooting/#database-migration-issues","title":"Database Migration Issues","text":""},{"location":"resources/troubleshooting/#fake-a-migration","title":"Fake a Migration","text":"<p>If a migration already applied manually:</p> <pre><code>python src/manage.py migrate --fake app_name migration_name\n</code></pre>"},{"location":"resources/troubleshooting/#reset-migrations-development-only","title":"Reset Migrations (Development Only)","text":"<p>\u26a0\ufe0f Warning: This will delete all data</p> <pre><code># Drop database\ndropdb app_db\n\n# Recreate\ncreatedb app_db\n\n# Run migrations\npython src/manage.py migrate\n</code></pre>"},{"location":"resources/troubleshooting/#permission-errors","title":"Permission Errors","text":""},{"location":"resources/troubleshooting/#403-forbidden-on-api-endpoints","title":"403 Forbidden on API Endpoints","text":"<p>Cause: Authentication required but not provided</p> <p>Solution: Include authentication token:</p> <pre><code>curl -H \"Authorization: Bearer YOUR_JWT_TOKEN\" \\\n  http://localhost:8000/api/proxy/config\n</code></pre> <p>Or log in via session authentication through the web UI.</p>"},{"location":"resources/troubleshooting/#performance-issues","title":"Performance Issues","text":""},{"location":"resources/troubleshooting/#high-memory-usage","title":"High Memory Usage","text":"<p>Solutions: 1. Reduce number of workers 2. Enable Redis persistence 3. Clear old log files 4. Check for memory leaks in custom code</p>"},{"location":"resources/troubleshooting/#slow-responses","title":"Slow Responses","text":"<p>Diagnosis: <pre><code># Check node latencies\ncurl http://localhost:8000/api/proxy/state | jq '.latencies'\n\n# Check active request counts\ncurl http://localhost:8000/api/proxy/active-requests\n</code></pre></p> <p>Solutions: 1. Add more nodes 2. Switch to <code>lowest_latency</code> strategy 3. Increase worker count 4. Check network latency to nodes</p>"},{"location":"resources/troubleshooting/#debug-mode","title":"Debug Mode","text":""},{"location":"resources/troubleshooting/#enable-debug-logging","title":"Enable Debug Logging","text":"<p>In <code>src/aivonx/settings.py</code>, temporarily increase log level:</p> <pre><code>LOGGING = {\n    # ...\n    'loggers': {\n        'proxy': {\n            'handlers': ['console', 'proxy_file'],\n            'level': 'DEBUG',  # Changed from INFO\n            'propagate': False,\n        },\n    },\n}\n</code></pre>"},{"location":"resources/troubleshooting/#django-debug-toolbar","title":"Django Debug Toolbar","text":"<p>For development, install Django Debug Toolbar:</p> <pre><code>pip install django-debug-toolbar\n</code></pre>"},{"location":"resources/troubleshooting/#getting-help","title":"Getting Help","text":"<ol> <li>Check Logs: Review log files for error messages</li> <li>API State: Use <code>/api/proxy/state</code> to inspect manager state</li> <li>Health Checks: Verify all services are healthy</li> <li>GitHub Issues: Search or open an issue on the repository</li> </ol>"},{"location":"resources/troubleshooting/#useful-commands-for-debugging","title":"Useful Commands for Debugging","text":"<pre><code># System check\npython src/manage.py check --deploy\n\n# Show current settings\npython src/manage.py diffsettings\n\n# Database shell\npython src/manage.py dbshell\n\n# Python shell with Django context\npython src/manage.py shell\n\n# Show URL patterns\npython src/manage.py show_urls  # Requires django-extensions\n\n# Test Redis connection\nredis-cli -h localhost ping\n\n# Test PostgreSQL connection\npsql -h localhost -U user -d app_db -c 'SELECT 1;'\n</code></pre>"},{"location":"zh/","title":"Aivonx Proxy \u6587\u4ef6","text":"<p>\u6b61\u8fce\u4f7f\u7528 Aivonx Proxy \u6587\u4ef6\u3002\u672c\u6587\u4ef6\u7531\u5c08\u6848\u539f\u59cb\u78bc\uff08<code>src/</code>\uff09\u7522\u751f\uff0c\u63d0\u4f9b\u90e8\u7f72\u3001\u4f7f\u7528\u8207\u958b\u767c\u7684\u5b8c\u6574\u8aaa\u660e\u3002</p>"},{"location":"zh/#_1","title":"\u5feb\u901f\u5c0e\u89bd","text":"<ul> <li>\u5165\u9580\uff1a\u4ecb\u7d39\u3001\u9700\u6c42\u8207\u90e8\u7f72\u6307\u5357</li> <li>\u53c3\u8003\uff1a\u8a2d\u5b9a\u3001API \u7aef\u9ede\u8207 CLI \u6307\u4ee4</li> <li>\u8cc7\u6e90\uff1a\u6545\u969c\u6392\u9664\u3001\u5b89\u5168\u6700\u4f73\u5be6\u4f5c\u8207\u8853\u8a9e\u8868</li> <li>\u958b\u767c\uff1a\u7a0b\u5f0f\u78bc\u7d50\u69cb\u3001\u8ca2\u737b\u6307\u5357\u8207\u6e2c\u8a66</li> </ul>"},{"location":"zh/#_2","title":"\u5728\u672c\u6a5f\u555f\u52d5\u6587\u4ef6\u4f3a\u670d\u5668","text":"<p>\u5728\u958b\u767c\u74b0\u5883\u4e2d\u53ef\u4f7f\u7528 MkDocs \u555f\u52d5\u9810\u89bd\uff1a</p> <pre><code>mkdocs serve -f mkdocs.yml\n</code></pre> <p>\u6b32\u53c3\u8003\u539f\u59cb\u7a0b\u5f0f\u78bc\uff0c\u8acb\u67e5\u770b <code>src/</code> \u4e0b\u7684\u6a21\u7d44\uff08\u4f8b\u5982 <code>src/aivonx/settings.py</code>\u3001<code>src/proxy/</code>\uff09\u3002</p>"},{"location":"zh/development/code_structure/","title":"\u7a0b\u5f0f\u78bc\u7d50\u69cb","text":"<p>\u5c08\u6848\u67b6\u69cb\u548c\u7d44\u7e54\u7684\u6982\u8ff0\u3002</p>"},{"location":"zh/development/code_structure/#_2","title":"\u5c08\u6848\u4f48\u5c40","text":"<pre><code>aivonx_proxy/\n\u251c\u2500\u2500 src/                      # \u61c9\u7528\u7a0b\u5f0f\u539f\u59cb\u78bc\n\u2502   \u251c\u2500\u2500 aivonx/              # Django \u5c08\u6848\u914d\u7f6e\n\u2502   \u251c\u2500\u2500 proxy/               # \u6838\u5fc3\u4ee3\u7406\u61c9\u7528\u7a0b\u5f0f\n\u2502   \u251c\u2500\u2500 account/             # \u8a8d\u8b49\u548c\u4f7f\u7528\u8005\u7ba1\u7406\n\u2502   \u251c\u2500\u2500 logviewer/           # \u65e5\u8a8c\u6aa2\u8996\u4ecb\u9762\n\u2502   \u251c\u2500\u2500 ui/                  # \u524d\u7aef\u6a21\u677f\u548c\u975c\u614b\u6a94\u6848\n\u2502   \u251c\u2500\u2500 staticfiles/         # \u6536\u96c6\u7684\u975c\u614b\u6a94\u6848\uff08\u751f\u6210\uff09\n\u2502   \u251c\u2500\u2500 logs/                # \u61c9\u7528\u7a0b\u5f0f\u65e5\u8a8c\n\u2502   \u2514\u2500\u2500 manage.py            # Django \u7ba1\u7406\u8173\u672c\n\u251c\u2500\u2500 docs/                    # \u6587\u4ef6\n\u251c\u2500\u2500 docker-compose.yml       # Docker Compose \u914d\u7f6e\n\u251c\u2500\u2500 Dockerfile              # \u5bb9\u5668\u6620\u50cf\u5b9a\u7fa9\n\u251c\u2500\u2500 pyproject.toml          # \u5c08\u6848\u5143\u8cc7\u6599\u548c\u4f9d\u8cf4\n\u251c\u2500\u2500 mkdocs.yml             # \u6587\u4ef6\u914d\u7f6e\n\u2514\u2500\u2500 README.md              # \u5c08\u6848\u6982\u8ff0\n</code></pre>"},{"location":"zh/development/code_structure/#_3","title":"\u6838\u5fc3\u61c9\u7528\u7a0b\u5f0f","text":""},{"location":"zh/development/code_structure/#aivonx","title":"aivonx/ (\u5c08\u6848\u914d\u7f6e)","text":"<p>\u76ee\u7684\uff1aDjango \u5c08\u6848\u8a2d\u5b9a\u548c\u6838\u5fc3\u914d\u7f6e</p> <p>\u95dc\u9375\u6a94\u6848\uff1a - <code>settings.py</code> - \u4e3b\u8981\u914d\u7f6e\u6a94\u6848   - \u8cc7\u6599\u5eab\u8a2d\u5b9a\uff08PostgreSQL\uff09   - Redis \u5feb\u53d6\u914d\u7f6e   - \u5b89\u5168\u6027\u8a2d\u5b9a\uff08CORS\u3001CSRF\u3001SECRET_KEY\uff09   - \u65e5\u8a8c\u914d\u7f6e   - REST Framework \u8a2d\u5b9a   - drf-spectacular \u8a2d\u5b9a - <code>urls.py</code> - URL \u8def\u7531 - <code>wsgi.py</code> - WSGI \u61c9\u7528\u7a0b\u5f0f\u5165\u53e3\u9ede - <code>asgi.py</code> - ASGI \u61c9\u7528\u7a0b\u5f0f\u5165\u53e3\u9ede - <code>utils.py</code> - \u8a2d\u5b9a\u5de5\u5177\u51fd\u6578 - <code>views.py</code> - \u5065\u5eb7\u6aa2\u67e5\u548c\u7248\u672c\u6aa2\u8996</p>"},{"location":"zh/development/code_structure/#proxy","title":"proxy/ (\u6838\u5fc3\u61c9\u7528\u7a0b\u5f0f)","text":"<p>\u76ee\u7684\uff1a\u4e3b\u8981\u4ee3\u7406\u908f\u8f2f\u548c\u7bc0\u9ede\u7ba1\u7406</p> <p>\u7d50\u69cb\uff1a <pre><code>proxy/\n\u251c\u2500\u2500 models.py              # \u8cc7\u6599\u5eab\u6a21\u578b\uff08Node\u3001ProxyConfig\uff09\n\u251c\u2500\u2500 serializers.py         # DRF \u5e8f\u5217\u5316\u5668\n\u251c\u2500\u2500 views.py              # API \u6aa2\u8996\uff08state\u3001health\u3001config\uff09\n\u251c\u2500\u2500 views_proxy.py        # \u4ee3\u7406\u7aef\u9ede\uff08generate\u3001chat\u3001embed\uff09\n\u251c\u2500\u2500 viewsets.py           # REST viewsets\uff08NodeViewSet\uff09\n\u251c\u2500\u2500 urls.py               # URL \u8def\u7531\n\u251c\u2500\u2500 apps.py               # \u61c9\u7528\u7a0b\u5f0f\u914d\u7f6e\uff08\u751f\u547d\u9031\u671f\u9264\u5b50\uff09\n\u251c\u2500\u2500 admin.py              # Django \u7ba1\u7406\u54e1\u914d\u7f6e\n\u251c\u2500\u2500 forms.py              # \u7db2\u9801\u8868\u55ae\n\u251c\u2500\u2500 signals.py            # Django \u8a0a\u865f\n\u251c\u2500\u2500 streaming.py          # \u4e32\u6d41\u56de\u61c9\u5de5\u5177\n\u251c\u2500\u2500 web.py                # \u7db2\u9801 UI \u6aa2\u8996\n\u251c\u2500\u2500 utils/                # \u5de5\u5177\u6a21\u7d44\n\u2502   \u2514\u2500\u2500 proxy_manager.py  # HA \u7ba1\u7406\u54e1\u548c\u7bc0\u9ede\u9078\u64c7\n\u251c\u2500\u2500 tests/                # \u6e2c\u8a66\u5957\u4ef6\n\u251c\u2500\u2500 templates/            # HTML \u6a21\u677f\n\u251c\u2500\u2500 static/               # \u975c\u614b\u6a94\u6848\uff08CSS\u3001JS\uff09\n\u2514\u2500\u2500 migrations/           # \u8cc7\u6599\u5eab\u9077\u79fb\n</code></pre></p> <p>\u95dc\u9375\u5143\u4ef6\uff1a</p> <ol> <li>\u6a21\u578b (<code>models.py</code>)</li> <li><code>Node</code>\uff1a\u5f8c\u7aef Ollama \u4f3a\u670d\u5668\u5b9a\u7fa9</li> <li> <p><code>ProxyConfig</code>\uff1a\u5168\u57df\u4ee3\u7406\u914d\u7f6e</p> </li> <li> <p>\u4ee3\u7406\u7ba1\u7406\u54e1 (<code>utils/proxy_manager.py</code>)</p> </li> <li>\u7bc0\u9ede\u9078\u64c7\u6f14\u7b97\u6cd5</li> <li>\u5065\u5eb7\u76e3\u63a7</li> <li>\u4e3b\u52d5/\u5f85\u547d\u6c60\u7ba1\u7406</li> <li>\u5ef6\u9072\u8ffd\u8e64</li> <li> <p>\u6a21\u578b\u767c\u73fe</p> </li> <li> <p>API \u6aa2\u8996 (<code>views.py</code>\u3001<code>viewsets.py</code>)</p> </li> <li>\u7bc0\u9ede CRUD \u64cd\u4f5c</li> <li>\u72c0\u614b\u6aa2\u67e5</li> <li>\u914d\u7f6e\u7ba1\u7406</li> <li> <p>\u6a21\u578b\u62c9\u53d6</p> </li> <li> <p>\u4ee3\u7406\u7aef\u9ede (<code>views_proxy.py</code>)</p> </li> <li><code>/api/generate</code> - \u6587\u5b57\u751f\u6210</li> <li><code>/api/chat</code> - \u804a\u5929\u5b8c\u6210</li> <li><code>/api/embed</code> - \u55ae\u4e00\u5d4c\u5165</li> <li><code>/api/embeddings</code> - \u6279\u6b21\u5d4c\u5165</li> <li><code>/api/tags</code> - \u5217\u51fa\u6a21\u578b</li> <li><code>/api/ps</code> - \u57f7\u884c\u4e2d\u7684\u6a21\u578b</li> </ol>"},{"location":"zh/development/code_structure/#account","title":"account/ (\u4f7f\u7528\u8005\u7ba1\u7406)","text":"<p>\u76ee\u7684\uff1a\u4f7f\u7528\u8005\u8a8d\u8b49\u548c\u5e33\u6236\u7ba1\u7406</p> <p>\u95dc\u9375\u6a94\u6848\uff1a - <code>models.py</code> - \u4f7f\u7528\u8005\u6a21\u578b\uff08\u5982\u679c\u6709\u4efb\u4f55\u81ea\u8a02\u6a21\u578b\uff09 - <code>serializers.py</code> - \u4f7f\u7528\u8005\u5e8f\u5217\u5316\u5668 - <code>views.py</code> - \u8a8d\u8b49\u6aa2\u8996 - <code>urls.py</code> - \u5e33\u6236 URL \u8def\u7531</p>"},{"location":"zh/development/code_structure/#logviewer","title":"logviewer/ (\u65e5\u8a8c\u6aa2\u8996\u5668)","text":"<p>\u76ee\u7684\uff1a\u6aa2\u8996 JSON \u65e5\u8a8c\u7684\u7db2\u9801\u4ecb\u9762</p> <p>\u95dc\u9375\u6a94\u6848\uff1a - <code>views.py</code> - \u65e5\u8a8c\u64f7\u53d6 API - <code>web.py</code> - \u65e5\u8a8c\u6aa2\u8996\u5668 UI - <code>templates/</code> - \u65e5\u8a8c\u6aa2\u8996\u5668 HTML - <code>static/</code> - \u65e5\u8a8c\u6aa2\u8996\u5668 CSS/JS</p>"},{"location":"zh/development/code_structure/#ui","title":"ui/ (\u524d\u7aef)","text":"<p>\u76ee\u7684\uff1a\u7db2\u9801\u4ecb\u9762\u7684\u975c\u614b\u6a94\u6848\u548c\u6a21\u677f</p> <p>\u7d50\u69cb\uff1a <pre><code>ui/\n\u251c\u2500\u2500 static/\n\u2502   \u251c\u2500\u2500 css/\n\u2502   \u2514\u2500\u2500 js/\n\u2514\u2500\u2500 templates/\n</code></pre></p>"},{"location":"zh/development/code_structure/#_4","title":"\u95dc\u9375\u67b6\u69cb\u6a21\u5f0f","text":""},{"location":"zh/development/code_structure/#_5","title":"\u4ee3\u7406\u7ba1\u7406\u54e1\u55ae\u4f8b","text":"<p>\u4ee3\u7406\u7ba1\u7406\u54e1\u521d\u59cb\u5316\u70ba\u55ae\u4f8b\uff1a - \u5728\u61c9\u7528\u7a0b\u5f0f\u555f\u52d5\u671f\u9593\u5efa\u7acb\uff08ASGI \u751f\u547d\u9031\u671f\u4e8b\u4ef6\uff09 - \u53ef\u900f\u904e <code>get_global_manager()</code> \u5b58\u53d6 - \u7ba1\u7406\u8de8\u5de5\u4f5c\u8005\u7684\u5171\u4eab\u72c0\u614b - \u4f7f\u7528 Redis \u9032\u884c\u8de8\u7a0b\u5e8f\u901a\u8a0a</p>"},{"location":"zh/development/code_structure/#_6","title":"\u6a21\u578b\u611f\u77e5\u8def\u7531","text":"<ol> <li>\u5ba2\u6236\u7aef\u4f9d\u540d\u7a31\u8acb\u6c42\u6a21\u578b</li> <li>\u7ba1\u7406\u54e1\u6aa2\u67e5\u54ea\u4e9b\u7bc0\u9ede\u6709\u8a72\u6a21\u578b</li> <li>\u4f7f\u7528\u7b56\u7565\u9078\u64c7\u6700\u4f73\u53ef\u7528\u7bc0\u9ede</li> <li>\u5c07\u8acb\u6c42\u8def\u7531\u5230\u9078\u5b9a\u7684\u7bc0\u9ede</li> <li>\u8ffd\u8e64\u6d3b\u8e8d\u8acb\u6c42</li> <li>\u5b8c\u6210\u6642\u91cb\u653e\u7bc0\u9ede</li> </ol>"},{"location":"zh/development/code_structure/#_7","title":"\u5065\u5eb7\u6aa2\u67e5\u6392\u7a0b\u5668","text":"<ul> <li>\u6bcf 60 \u79d2\u57f7\u884c\u4e00\u6b21\uff08\u53ef\u914d\u7f6e\uff09</li> <li>\u6aa2\u67e5\u6240\u6709\u914d\u7f6e\u7684\u7bc0\u9ede</li> <li>\u66f4\u65b0\u4e3b\u52d5/\u5f85\u547d\u6c60</li> <li>\u91cd\u65b0\u6574\u7406\u6a21\u578b\u53ef\u7528\u6027</li> <li>\u6e2c\u91cf\u5ef6\u9072</li> </ul>"},{"location":"zh/development/code_structure/#_8","title":"\u8cc7\u6599\u6d41\u7a0b","text":""},{"location":"zh/development/code_structure/#_9","title":"\u8acb\u6c42\u6d41\u7a0b","text":"<pre><code>\u5ba2\u6236\u7aef\u8acb\u6c42\n    \u2193\nDjango URL \u8def\u7531\u5668\n    \u2193\nAPI \u6aa2\u8996 (views_proxy.py)\n    \u2193\n\u4ee3\u7406\u7ba1\u7406\u54e1\n    \u2193\n\u7bc0\u9ede\u9078\u64c7 (\u7b56\u7565)\n    \u2193\nHTTPX \u5ba2\u6236\u7aef\u8acb\u6c42\n    \u2193\nOllama \u7bc0\u9ede\n    \u2193\n\u4e32\u6d41\u56de\u61c9\n    \u2193\n\u5ba2\u6236\u7aef\n</code></pre>"},{"location":"zh/development/code_structure/#_10","title":"\u7bc0\u9ede\u72c0\u614b\u7ba1\u7406","text":"<pre><code>\u8cc7\u6599\u5eab (PostgreSQL)\n    \u2193\n\u4ee3\u7406\u7ba1\u7406\u54e1\n    \u2193\nRedis \u5feb\u53d6\n    \u2193\n\u4e3b\u52d5/\u5f85\u547d\u6c60\n    \u2193\n\u8acb\u6c42\u9078\u64c7\n</code></pre>"},{"location":"zh/development/code_structure/#_11","title":"\u91cd\u8981\u6a94\u6848\u53c3\u8003","text":""},{"location":"zh/development/code_structure/#_12","title":"\u914d\u7f6e","text":"<ul> <li><code>src/aivonx/settings.py</code> - \u6240\u6709\u8a2d\u5b9a</li> <li><code>pyproject.toml</code> - \u4f9d\u8cf4</li> <li><code>docker-compose.yml</code> - \u670d\u52d9</li> </ul>"},{"location":"zh/development/code_structure/#_13","title":"\u6838\u5fc3\u908f\u8f2f","text":"<ul> <li><code>src/proxy/utils/proxy_manager.py</code> - HA \u7ba1\u7406\u54e1</li> <li><code>src/proxy/views_proxy.py</code> - \u4ee3\u7406\u7aef\u9ede</li> <li><code>src/proxy/models.py</code> - \u8cc7\u6599\u6a21\u578b</li> </ul>"},{"location":"zh/development/code_structure/#api","title":"API","text":"<ul> <li><code>src/aivonx/urls.py</code> - \u4e3b\u8981\u8def\u7531</li> <li><code>src/proxy/urls.py</code> - \u4ee3\u7406\u8def\u7531</li> <li><code>src/proxy/viewsets.py</code> - REST viewsets</li> </ul>"},{"location":"zh/development/code_structure/#_14","title":"\u8a2d\u8a08\u539f\u5247","text":"<ol> <li>\u95dc\u6ce8\u9ede\u5206\u96e2\uff1a\u6bcf\u500b\u61c9\u7528\u7a0b\u5f0f\u8655\u7406\u7279\u5b9a\u529f\u80fd</li> <li>DRY\uff08\u4e0d\u8981\u91cd\u8907\u81ea\u5df1\uff09\uff1a\u5171\u4eab\u5de5\u5177\u5728 utils/</li> <li>\u53ef\u64f4\u5c55\u6027\uff1a\u7121\u72c0\u614b\u8a2d\u8a08\uff0c\u4f7f\u7528 Redis \u5171\u4eab\u72c0\u614b</li> <li>\u53ef\u6e2c\u8a66\u6027\uff1a\u6e05\u6670\u4ecb\u9762\u548c\u4f9d\u8cf4\u6ce8\u5165</li> <li>\u53ef\u7dad\u8b77\u6027\uff1a\u6e05\u6670\u547d\u540d\u548c\u6587\u4ef6</li> </ol>"},{"location":"zh/development/contributing/","title":"\u8ca2\u737b\u6307\u5357","text":"<p>\u6211\u5011\u6b61\u8fce\u5c0d Aivonx Proxy \u7684\u8ca2\u737b\uff01\u4ee5\u4e0b\u662f\u5982\u4f55\u958b\u59cb\u3002</p>"},{"location":"zh/development/contributing/#_2","title":"\u958b\u59cb\u4f7f\u7528","text":"<ol> <li>Fork \u5132\u5b58\u5eab</li> <li>\u5728 GitHub \u4e0a Fork \u5c08\u6848</li> <li> <p>\u672c\u5730\u514b\u9686\u60a8\u7684 Fork    <pre><code>git clone https://github.com/YOUR_USERNAME/aivonx_proxy.git\ncd aivonx_proxy\n</code></pre></p> </li> <li> <p>\u8a2d\u5b9a\u958b\u767c\u74b0\u5883 <pre><code># \u5b89\u88dd\u4f9d\u8cf4\nuv sync\n\n# \u57f7\u884c\u9077\u79fb\nuv run src/manage.py migrate\n\n# \u5efa\u7acb\u8d85\u7d1a\u4f7f\u7528\u8005\nuv run src/manage.py createsuperuser\n</code></pre></p> </li> <li> <p>\u5efa\u7acb\u529f\u80fd\u5206\u652f <pre><code>git checkout -b feature/your-feature-name\n</code></pre></p> </li> </ol>"},{"location":"zh/development/contributing/#_3","title":"\u958b\u767c\u5de5\u4f5c\u6d41\u7a0b","text":""},{"location":"zh/development/contributing/#_4","title":"\u57f7\u884c\u6e2c\u8a66","text":"<p>\u5728\u63d0\u4ea4\u66f4\u6539\u4e4b\u524d\uff0c\u8acb\u78ba\u4fdd\u6240\u6709\u6e2c\u8a66\u901a\u904e\uff1a</p> <pre><code># \u57f7\u884c\u6240\u6709\u6e2c\u8a66\npython src/manage.py test\n\n# \u57f7\u884c\u7279\u5b9a\u61c9\u7528\u7a0b\u5f0f\u6e2c\u8a66\npython src/manage.py test proxy\n\n# \u4f7f\u7528\u8986\u84cb\u7387\u57f7\u884c\ncoverage run --source='.' src/manage.py test\ncoverage report\n</code></pre>"},{"location":"zh/development/contributing/#_5","title":"\u7a0b\u5f0f\u78bc\u98a8\u683c","text":"<ul> <li>\u9075\u5faa\u73fe\u6709\u7684\u7a0b\u5f0f\u78bc\u98a8\u683c\u548c\u6163\u4f8b</li> <li>\u4f7f\u7528\u6709\u610f\u7fa9\u7684\u8b8a\u6578\u548c\u51fd\u6578\u540d\u7a31</li> <li>\u70ba\u65b0\u51fd\u6578\u548c\u985e\u5225\u65b0\u589e\u6587\u4ef6\u5b57\u4e32</li> <li>\u4fdd\u6301\u51fd\u6578\u5c08\u6ce8\u548c\u6a21\u7d44\u5316</li> </ul>"},{"location":"zh/development/contributing/#_6","title":"\u9032\u884c\u66f4\u6539","text":"<ol> <li>\u5728\u60a8\u7684\u529f\u80fd\u5206\u652f\u4e2d\u9032\u884c\u66f4\u6539</li> <li>\u6839\u64da\u9700\u8981\u7de8\u5beb\u6216\u66f4\u65b0\u6e2c\u8a66</li> <li>\u5982\u6709\u5fc5\u8981\uff0c\u66f4\u65b0\u6587\u4ef6</li> <li>\u57f7\u884c\u6e2c\u8a66\u4ee5\u78ba\u4fdd\u4e00\u5207\u6b63\u5e38</li> <li>\u4f7f\u7528\u6e05\u6670\u3001\u63cf\u8ff0\u6027\u7684\u8a0a\u606f\u63d0\u4ea4</li> </ol> <pre><code>git add .\ngit commit -m \"[Types] description of changes\"\n</code></pre> <p>\u985e\u578b\uff1a<code>[update]</code>\u3001<code>[fix]</code>\u3001<code>[tests]</code>\u3001<code>[docs]</code></p>"},{"location":"zh/development/contributing/#_7","title":"\u63d0\u4ea4\u62c9\u53d6\u8acb\u6c42","text":"<ol> <li> <p>\u63a8\u9001\u81f3\u60a8\u7684 Fork <pre><code>git push origin feature/your-feature-name\n</code></pre></p> </li> <li> <p>\u5efa\u7acb\u62c9\u53d6\u8acb\u6c42</p> </li> <li>\u524d\u5f80 GitHub \u4e0a\u7684\u539f\u59cb\u5132\u5b58\u5eab</li> <li>\u9ede\u64ca \"New Pull Request\"</li> <li>\u9078\u64c7\u60a8\u7684\u5206\u652f</li> <li> <p>\u4f7f\u7528\u4ee5\u4e0b\u5167\u5bb9\u586b\u5beb PR \u6a21\u677f\uff1a</p> <ul> <li>\u66f4\u6539\u63cf\u8ff0</li> <li>\u52d5\u6a5f\u548c\u80cc\u666f</li> <li>\u76f8\u95dc\u554f\u984c\u7de8\u865f</li> <li>\u57f7\u884c\u7684\u6e2c\u8a66</li> </ul> </li> <li> <p>PR \u5be9\u6838\u6d41\u7a0b</p> </li> <li>\u7dad\u8b77\u8005\u5c07\u5be9\u6838\u60a8\u7684 PR</li> <li>\u8655\u7406\u4efb\u4f55\u56de\u994b\u6216\u8acb\u6c42\u7684\u66f4\u6539</li> <li>\u4e00\u65e6\u6279\u51c6\uff0c\u60a8\u7684 PR \u5c07\u88ab\u5408\u4f75</li> </ol>"},{"location":"zh/development/contributing/#_8","title":"\u6307\u5357","text":""},{"location":"zh/development/contributing/#_9","title":"\u7a0b\u5f0f\u78bc\u54c1\u8cea","text":"<ul> <li>\u7de8\u5beb\u4e7e\u6de8\u3001\u53ef\u8b80\u7684\u7a0b\u5f0f\u78bc</li> <li>\u9075\u5faa Django \u548c Python \u6700\u4f73\u5be6\u52d9</li> <li>\u907f\u514d\u4e0d\u5fc5\u8981\u7684\u8907\u96dc\u6027</li> <li>\u4fdd\u6301\u63d0\u4ea4\u539f\u5b50\u5316\u548c\u5c08\u6ce8</li> </ul>"},{"location":"zh/development/contributing/#_10","title":"\u6587\u4ef6","text":"<ul> <li>\u66f4\u65b0\u76f8\u95dc\u6587\u4ef6</li> <li>\u70ba\u516c\u958b API \u65b0\u589e\u6587\u4ef6\u5b57\u4e32</li> <li>\u5982\u9069\u7528\uff0c\u66f4\u65b0 CHANGELOG</li> <li>\u70ba\u65b0\u529f\u80fd\u5305\u542b\u7bc4\u4f8b</li> </ul>"},{"location":"zh/development/contributing/#_11","title":"\u6e2c\u8a66","text":"<ul> <li>\u70ba\u65b0\u529f\u80fd\u7de8\u5beb\u6e2c\u8a66</li> <li>\u78ba\u4fdd\u73fe\u6709\u6e2c\u8a66\u901a\u904e</li> <li>\u81f4\u529b\u65bc\u826f\u597d\u7684\u6e2c\u8a66\u8986\u84cb\u7387</li> <li>\u6e2c\u8a66\u908a\u7de3\u60c5\u6cc1\u548c\u932f\u8aa4\u689d\u4ef6</li> </ul>"},{"location":"zh/development/contributing/#_12","title":"\u63d0\u4ea4\u8a0a\u606f","text":"<p>\u9075\u5faa\u6163\u4f8b\u63d0\u4ea4\u683c\u5f0f\uff1a</p> <pre><code>- \u63cf\u8ff0 1\n- \u63cf\u8ff0 2\n- \u63cf\u8ff0 3\n</code></pre>"},{"location":"zh/development/contributing/#_13","title":"\u8ca2\u737b\u4ec0\u9ebc","text":""},{"location":"zh/development/contributing/#_14","title":"\u597d\u7684\u9996\u6b21\u554f\u984c","text":"<ul> <li>\u6587\u4ef6\u6539\u9032</li> <li>\u932f\u8aa4\u4fee\u5fa9</li> <li>\u6e2c\u8a66\u8986\u84cb\u7387\u6539\u9032</li> <li>\u7a0b\u5f0f\u78bc\u8a3b\u91cb\u548c\u6f84\u6e05</li> </ul>"},{"location":"zh/development/contributing/#_15","title":"\u529f\u80fd\u8acb\u6c42","text":"<ul> <li>\u5148\u958b\u555f\u554f\u984c\u9032\u884c\u8a0e\u8ad6</li> <li>\u5728\u5be6\u4f5c\u524d\u7372\u5f97\u56de\u994b</li> <li>\u78ba\u4fdd\u5b83\u7b26\u5408\u5c08\u6848\u76ee\u6a19</li> </ul>"},{"location":"zh/development/contributing/#_16","title":"\u932f\u8aa4\u5831\u544a","text":"<p>\u5831\u544a\u932f\u8aa4\u6642\uff0c\u8acb\u5305\u542b\uff1a - \u554f\u984c\u7684\u6e05\u6670\u63cf\u8ff0 - \u91cd\u73fe\u6b65\u9a5f - \u9810\u671f\u8207\u5be6\u969b\u884c\u70ba - \u74b0\u5883\u8a73\u7d30\u8cc7\u8a0a\uff08\u4f5c\u696d\u7cfb\u7d71\u3001Python \u7248\u672c\u7b49\uff09 - \u76f8\u95dc\u65e5\u8a8c\u6216\u932f\u8aa4\u8a0a\u606f</p>"},{"location":"zh/development/contributing/#_17","title":"\u884c\u70ba\u6e96\u5247","text":"<ul> <li>\u5c0a\u91cd\u548c\u5c08\u696d</li> <li>\u6b61\u8fce\u65b0\u624b</li> <li>\u63d0\u4f9b\u5efa\u8a2d\u6027\u56de\u994b</li> <li>\u5c08\u6ce8\u65bc\u5408\u4f5c</li> </ul>"},{"location":"zh/development/contributing/#_18","title":"\u6709\u554f\u984c\u55ce\uff1f","text":"<p>\u5982\u679c\u60a8\u6709\u554f\u984c\uff1a - \u6aa2\u67e5\u73fe\u6709\u6587\u4ef6 - \u641c\u5c0b\u5df2\u95dc\u9589\u7684\u554f\u984c - \u958b\u555f\u65b0\u554f\u984c\u9032\u884c\u8a0e\u8ad6 - \u52a0\u5165\u793e\u7fa4\u8a0e\u8ad6</p> <p>\u611f\u8b1d\u60a8\u7684\u8ca2\u737b\uff01</p>"},{"location":"zh/development/testing/","title":"\u6e2c\u8a66","text":"<p>Aivonx Proxy \u7684\u5168\u9762\u6e2c\u8a66\u6307\u5357\u3002</p>"},{"location":"zh/development/testing/#_2","title":"\u57f7\u884c\u6e2c\u8a66","text":"<p>\u5c08\u6848\u5305\u542b\u4f4d\u65bc <code>src/*/tests/</code> \u7684 pytest \u914d\u7f6e\u7684\u55ae\u5143\u6e2c\u8a66\u3002</p>"},{"location":"zh/development/testing/#django","title":"Django \u6e2c\u8a66\u57f7\u884c\u5668","text":"<pre><code># \u57f7\u884c\u6240\u6709\u6e2c\u8a66\npython src/manage.py test proxy.tests account.tests logviewer.tests --verbosity 1 --keepdb\n</code></pre>"},{"location":"zh/getting_started/deployment_options/","title":"\u90e8\u7f72\u9078\u9805","text":"<p>Aivonx Proxy \u652f\u63f4\u591a\u7a2e\u90e8\u7f72\u7b56\u7565\uff0c\u4ee5\u7b26\u5408\u4e0d\u540c\u9700\u6c42\u8207\u74b0\u5883\u3002</p>"},{"location":"zh/getting_started/deployment_options/#1-docker-compose","title":"1. Docker Compose\uff08\u958b\u767c\u63a8\u85a6\uff09","text":"<p>\u4f7f\u7528\u5c08\u6848\u63d0\u4f9b\u7684 <code>docker-compose.yml</code> \u505a\u4e00\u9375\u90e8\u7f72\uff1a</p> <pre><code>docker-compose up -d\n</code></pre> <p>\u5305\u542b\u670d\u52d9\uff1a - Django \u61c9\u7528\u4f3a\u670d\u5668 - PostgreSQL \u8cc7\u6599\u5eab - Redis \u5feb\u53d6 - Ollama \u670d\u52d9\uff08\u53ef\u9078\uff09</p>"},{"location":"zh/getting_started/deployment_options/#2-kubernetes","title":"2. Kubernetes\uff08\u751f\u7522\uff09","text":"<p>\u751f\u7522\u74b0\u5883\u5efa\u8b70\u4f7f\u7528 Kubernetes\uff1a - \u4f7f\u7528\u8a17\u7ba1\u7684 PostgreSQL \u8207 Redis - \u8a2d\u5b9a Horizontal Pod Autoscaler - \u8a2d\u5b9a\u8cc7\u6e90\u9650\u5236\u8207\u8acb\u6c42 - \u4f7f\u7528 Ingress \u505a SSL/TLS \u7d42\u7aef</p>"},{"location":"zh/getting_started/deployment_options/#3-asgi","title":"3. ASGI \u4f3a\u670d\u5668\uff08\u9069\u5408\u4e32\u6d41\uff09","text":"<p>\u82e5\u9700\u8981\u5373\u6642\u4e32\u6d41\u6216 WebSocket \u652f\u63f4\uff0c\u4f7f\u7528 ASGI\uff1a</p> <pre><code># \u4f7f\u7528 uvicorn\nuvicorn aivonx.asgi:application --host 0.0.0.0 --port 8000 --workers 4\n\n# \u6216\u642d\u914d gunicorn \u8207 uvicorn workers\ngunicorn aivonx.asgi:application -k uvicorn.workers.UvicornWorker --bind 0.0.0.0:8000 --workers 4\n</code></pre>"},{"location":"zh/getting_started/deployment_options/#4-wsgi","title":"4. WSGI \u4f3a\u670d\u5668\uff08\u50b3\u7d71\u90e8\u7f72\uff09","text":"<p>\u540c\u6b65\u5de5\u4f5c\u8ca0\u8f09\u53ef\u4f7f\u7528 WSGI\uff1a</p> <pre><code>gunicorn aivonx.wsgi:application --bind 0.0.0.0:8000 --workers 4\n</code></pre>"},{"location":"zh/getting_started/deployment_options/#_2","title":"\u74b0\u5883\u8b8a\u6578","text":"<p>\u95dc\u9375\u74b0\u5883\u8b8a\u6578\uff08\u8a73\u7d30\u8acb\u53c3\u8003 <code>src/aivonx/settings.py</code>\uff09\uff1a</p>"},{"location":"zh/getting_started/deployment_options/#_3","title":"\u751f\u7522\u9700\u8981","text":"<ul> <li><code>DJANGO_SECRET_KEY</code>\uff1a\u5fc5\u8981 - Django \u7684\u5bc6\u78bc\u5b78\u79d8\u5bc6</li> <li><code>DJANGO_DEBUG</code>\uff1a\u751f\u7522\u8acb\u8a2d\u70ba <code>false</code></li> <li><code>DJANGO_ALLOWED_HOSTS</code>\uff1a\u5141\u8a31\u7684\u4e3b\u6a5f\u540d\u7a31\u5217\u8868</li> </ul>"},{"location":"zh/getting_started/deployment_options/#_4","title":"\u8cc7\u6599\u5eab\u914d\u7f6e","text":"<ul> <li><code>POSTGRES_DB</code>\uff1a\u8cc7\u6599\u5eab\u540d\u7a31\uff08\u9810\u8a2d\uff1a<code>app_db</code>\uff09</li> <li><code>POSTGRES_USER</code>\uff1a\u8cc7\u6599\u5eab\u4f7f\u7528\u8005\uff08\u9810\u8a2d\uff1a<code>user</code>\uff09</li> <li><code>POSTGRES_PASSWORD</code>\uff1a\u8cc7\u6599\u5eab\u5bc6\u78bc\uff08\u9810\u8a2d\uff1a<code>password</code>\uff09</li> <li><code>POSTGRES_HOST</code>\uff1a\u8cc7\u6599\u5eab\u4e3b\u6a5f\uff08\u9810\u8a2d\uff1a<code>postgres</code>\uff09</li> <li><code>POSTGRES_PORT</code>\uff1a\u8cc7\u6599\u5eab\u9023\u63a5\u57e0\uff08\u9810\u8a2d\uff1a<code>5432</code>\uff09</li> </ul>"},{"location":"zh/getting_started/deployment_options/#_5","title":"\u5feb\u53d6\u914d\u7f6e","text":"<ul> <li><code>REDIS_URL</code>\uff1aRedis \u9023\u7dda URL\uff08\u9810\u8a2d\uff1a<code>redis://redis:6379/1</code>\uff09</li> </ul>"},{"location":"zh/getting_started/deployment_options/#_6","title":"\u5b89\u5168\u914d\u7f6e","text":"<ul> <li><code>DJANGO_CORS_ALLOWED_ORIGINS</code>\uff1a\u5141\u8a31\u7684 CORS \u4f86\u6e90</li> <li><code>DJANGO_CSRF_TRUSTED_ORIGINS</code>\uff1a\u53d7\u4fe1\u4efb\u7684 CSRF \u4f86\u6e90</li> <li><code>ROOT_PASSWORD</code>\uff1a\u9810\u8a2d <code>root</code> \u4f7f\u7528\u8005\u7684\u5bc6\u78bc</li> </ul>"},{"location":"zh/getting_started/deployment_options/#_7","title":"\u751f\u7522\u6aa2\u67e5\u6e05\u55ae","text":"<ul> <li>[ ] \u8a2d\u5b9a\u5f37\u96a8\u6a5f <code>DJANGO_SECRET_KEY</code></li> <li>[ ] \u95dc\u9589 debug \u6a21\u5f0f (<code>DJANGO_DEBUG=false</code>)</li> <li>[ ] \u8a2d\u5b9a\u6b63\u78ba\u7684 <code>ALLOWED_HOSTS</code></li> <li>[ ] \u4f7f\u7528\u8a17\u7ba1\u7684 PostgreSQL \u8207 Redis</li> <li>[ ] \u8a2d\u5b9a SSL/TLS \u6191\u8b49</li> <li>[ ] \u914d\u7f6e\u65e5\u8a8c\u8207\u76e3\u63a7</li> <li>[ ] \u8b8a\u66f4\u9810\u8a2d <code>root</code> \u5bc6\u78bc</li> <li>[ ] \u8a2d\u5b9a\u81ea\u52d5\u5099\u4efd</li> <li>[ ] \u8a2d\u5b9a\u9632\u706b\u7246\u898f\u5247</li> </ul>"},{"location":"zh/getting_started/faq/","title":"\u5e38\u898b\u554f\u984c","text":""},{"location":"zh/getting_started/faq/#_2","title":"\u4e00\u822c\u554f\u984c","text":""},{"location":"zh/getting_started/faq/#aivonx-proxy","title":"\u4ec0\u9ebc\u662f Aivonx Proxy\uff1f","text":"<p>Aivonx Proxy \u662f\u4e00\u500b\u7528\u65bc\u591a\u500b Ollama \u6a21\u578b\u670d\u52d9\u7bc0\u9ede\u7684\u53cd\u5411\u4ee3\u7406\u548c\u7ba1\u7406\u5e73\u53f0\u3002\u5b83\u900f\u904e REST API \u548c\u7db2\u9801\u5f0f\u7ba1\u7406\u4ecb\u9762\u63d0\u4f9b\u667a\u6167\u8def\u7531\u3001\u8ca0\u8f09\u5e73\u8861\u548c\u9ad8\u53ef\u7528\u6027\u529f\u80fd\u3002</p>"},{"location":"zh/getting_started/faq/#_3","title":"\u5b83\u89e3\u6c7a\u4e86\u4ec0\u9ebc\u554f\u984c\uff1f","text":"<p>\u5b83\u900f\u904e\u4ee5\u4e0b\u65b9\u5f0f\u89e3\u6c7a\u7ba1\u7406\u591a\u500b Ollama \u5be6\u4f8b\u7684\u6311\u6230\uff1a - \u63d0\u4f9b\u7d71\u4e00\u7684 API \u7aef\u9ede - \u81ea\u52d5\u5c07\u8acb\u6c42\u8def\u7531\u5230\u5065\u5eb7\u7684\u7bc0\u9ede - \u57fa\u65bc\u7bc0\u9ede\u53ef\u7528\u6027\u548c\u6548\u80fd\u9032\u884c\u8ca0\u8f09\u5e73\u8861 - \u652f\u63f4\u6a21\u578b\u611f\u77e5\u8def\u7531\uff08\u8acb\u6c42\u50c5\u50b3\u9001\u5230\u5177\u6709\u6240\u9700\u6a21\u578b\u7684\u7bc0\u9ede\uff09</p>"},{"location":"zh/getting_started/faq/#api","title":"API \u6587\u4ef6","text":""},{"location":"zh/getting_started/faq/#api_1","title":"\u5982\u4f55\u6aa2\u8996 API \u6587\u4ef6\uff1f","text":"<p>\u555f\u52d5\u61c9\u7528\u7a0b\u5f0f\u5f8c\uff0c\u5728\u4ee5\u4e0b\u4f4d\u7f6e\u5b58\u53d6\u4e92\u52d5\u5f0f API \u6587\u4ef6\uff1a - Swagger UI\uff1a<code>/swagger</code> - ReDoc\uff1a<code>/redoc</code></p> <p>\u9019\u4e9b\u7531 drf-spectacular \u81ea\u52d5\u751f\u6210\uff0c\u4e26\u63d0\u4f9b\u4e92\u52d5\u5f0f\u8acb\u6c42\u6e2c\u8a66\u3002</p>"},{"location":"zh/getting_started/faq/#api_2","title":"\u6709\u54ea\u4e9b API \u7aef\u9ede\u53ef\u7528\uff1f","text":"<p>\u95dc\u9375\u7aef\u9ede\u5305\u62ec\uff1a - <code>/api/proxy/nodes</code> - \u7bc0\u9ede\u7684 CRUD \u64cd\u4f5c - <code>/api/proxy/state</code> - \u6aa2\u8996\u4ee3\u7406\u7ba1\u7406\u54e1\u72c0\u614b - <code>/api/proxy/active-requests</code> - \u76e3\u63a7\u6bcf\u500b\u7bc0\u9ede\u7684\u6d3b\u8e8d\u8acb\u6c42 - <code>/api/proxy/pull</code> - \u5c07\u6a21\u578b\u62c9\u53d6\u5230\u7bc0\u9ede - <code>/api/generate</code> - \u751f\u6210\u88dc\u5168 - <code>/api/chat</code> - \u804a\u5929\u88dc\u5168 - <code>/api/tags</code> - \u5217\u51fa\u53ef\u7528\u6a21\u578b</p>"},{"location":"zh/getting_started/faq/#_4","title":"\u7bc0\u9ede\u7ba1\u7406","text":""},{"location":"zh/getting_started/faq/#_5","title":"\u5982\u4f55\u65b0\u589e\u7bc0\u9ede\uff1f","text":"<p>\u900f\u904e API\uff1a <pre><code>curl -X POST http://localhost:8000/api/proxy/nodes \\\n  -H \"Content-Type: application/json\" \\\n  -H \"Authorization: Bearer YOUR_TOKEN\" \\\n  -d '{\n    \"name\": \"node1\",\n    \"address\": \"192.168.1.100\",\n    \"port\": 11434\n  }'\n</code></pre></p> <p>\u900f\u904e\u7db2\u9801 UI\uff1a 1. \u767b\u5165\u7ba1\u7406\u4ecb\u9762 2. \u5c0e\u822a\u5230\u7bc0\u9ede\u5340\u6bb5 3. \u9ede\u64ca\u300c\u65b0\u589e\u7bc0\u9ede\u300d\u4e26\u586b\u5165\u8a73\u7d30\u8cc7\u8a0a</p> <p>\u7cfb\u7d71\u6703\u81ea\u52d5\u5c0d\u65b0\u7bc0\u9ede\u57f7\u884c\u5065\u5eb7\u6aa2\u67e5\u3002</p>"},{"location":"zh/getting_started/faq/#_6","title":"\u7bc0\u9ede\u9078\u64c7\u5982\u4f55\u904b\u4f5c\uff1f","text":"<p>\u4ee3\u7406\u4f7f\u7528\u53ef\u914d\u7f6e\u7684\u7b56\u7565\uff1a - \u6700\u5c11\u6d3b\u8e8d\uff08\u9810\u8a2d\uff09\uff1a\u8def\u7531\u5230\u6d3b\u8e8d\u8acb\u6c42\u6700\u5c11\u7684\u7bc0\u9ede - \u6700\u4f4e\u5ef6\u9072\uff1a\u8def\u7531\u5230\u56de\u61c9\u6642\u9593\u6700\u597d\u7684\u7bc0\u9ede</p> <p>\u60a8\u53ef\u4ee5\u900f\u904e <code>/api/proxy/config</code> \u7aef\u9ede\u8b8a\u66f4\u7b56\u7565\u3002</p>"},{"location":"zh/getting_started/faq/#_7","title":"\u5982\u679c\u7bc0\u9ede\u7576\u6a5f\u6703\u767c\u751f\u4ec0\u9ebc\uff1f","text":"<p>\u5065\u5eb7\u6aa2\u67e5\u6392\u7a0b\u5668\uff08\u9810\u8a2d\u6bcf\u5206\u9418\u57f7\u884c\u4e00\u6b21\uff09\u6703\u81ea\u52d5\uff1a - \u5075\u6e2c\u4e0d\u5065\u5eb7\u7684\u7bc0\u9ede - \u5c07\u5b83\u5011\u79fb\u81f3\u5f85\u547d\u6c60 - \u505c\u6b62\u5c07\u65b0\u8acb\u6c42\u8def\u7531\u5230\u5b83\u5011 - \u7576\u5b83\u5011\u6062\u5fa9\u6642\u91cd\u65b0\u65b0\u589e</p>"},{"location":"zh/getting_started/faq/#_8","title":"\u6545\u969c\u6392\u9664","text":""},{"location":"zh/getting_started/faq/#_9","title":"\u65e5\u8a8c\u5728\u54ea\u88e1\uff1f","text":"<p>\u65e5\u8a8c\u5132\u5b58\u5728\uff1a - <code>logs/django.json</code> - \u4e00\u822c Django \u65e5\u8a8c - <code>logs/proxy.json</code> - \u4ee3\u7406\u7279\u5b9a\u65e5\u8a8c - <code>logs/django_error.log</code> - \u932f\u8aa4\u65e5\u8a8c</p>"},{"location":"zh/getting_started/faq/#_10","title":"\u5982\u4f55\u6aa2\u67e5\u7bc0\u9ede\u662f\u5426\u5065\u5eb7\uff1f","text":"<p>\u4f7f\u7528\u72c0\u614b\u7aef\u9ede\uff1a <pre><code>curl http://localhost:8000/api/proxy/state\n</code></pre></p> <p>\u9019\u6703\u8fd4\u56de\u6d3b\u8e8d\u548c\u5f85\u547d\u6c60\u3001\u5ef6\u9072\u4ee5\u53ca\u6d3b\u8e8d\u8acb\u6c42\u8a08\u6578\u3002</p>"},{"location":"zh/getting_started/faq/#_11","title":"\u4e32\u6d41\u56de\u61c9\u7121\u6cd5\u904b\u4f5c","text":"<p>\u78ba\u4fdd\u60a8\u4f7f\u7528 ASGI \u4f3a\u670d\u5668\uff08uvicorn\uff09\u800c\u975e WSGI\uff08gunicorn \u8207\u540c\u6b65\u5de5\u4f5c\u8005\uff09\u3002\u4e32\u6d41\u9700\u8981\u975e\u540c\u6b65\u652f\u63f4\u3002</p>"},{"location":"zh/getting_started/faq/#_12","title":"\u914d\u7f6e","text":""},{"location":"zh/getting_started/faq/#_13","title":"\u6211\u53ef\u4ee5\u8b8a\u66f4\u5065\u5eb7\u6aa2\u67e5\u9593\u9694\u55ce\uff1f","text":"<p>\u662f\u7684\uff0c\u4fee\u6539 Django \u8a2d\u5b9a\u4e2d\u7684 APScheduler \u914d\u7f6e\uff0c\u6216\u76f4\u63a5\u5728\u4ee3\u7406\u61c9\u7528\u914d\u7f6e\u4e2d\u8abf\u6574\u6392\u7a0b\u5668\u3002</p>"},{"location":"zh/getting_started/faq/#api_3","title":"\u5982\u4f55\u4fdd\u8b77 API\uff1f","text":"<p>API \u4f7f\u7528\uff1a - JWT \u8a8d\u8b49\uff08\u900f\u904e djangorestframework-simplejwt\uff09 - \u6703\u8a71\u8a8d\u8b49 - Token \u8a8d\u8b49</p> <p>\u78ba\u4fdd\u5728\u751f\u7522\u4e2d\u8a2d\u5b9a\u9069\u7576\u7684 CORS \u548c CSRF \u53d7\u4fe1\u4efb\u4f86\u6e90\u3002</p>"},{"location":"zh/getting_started/introduction/","title":"\u7c21\u4ecb","text":"<p>Aivonx Proxy \u662f\u4e00\u500b\u57fa\u65bc Django \u7684\u53cd\u5411\u4ee3\u7406\u8207\u7ba1\u7406\u670d\u52d9\uff0c\u8a2d\u8a08\u7528\u65bc Ollama \u6a21\u578b\u4f3a\u670d\u7bc0\u9ede\u3002</p>"},{"location":"zh/getting_started/introduction/#_2","title":"\u4e3b\u8981\u529f\u80fd","text":"<ul> <li>\u7bc0\u9ede\u7ba1\u7406\uff1a\u7ba1\u7406\u591a\u500b\u6a21\u578b\u670d\u52d9\u7bc0\u9ede\uff0c\u652f\u63f4 active/standby \u6c60\u7684\u5206\u914d</li> <li>REST API\uff1a\u63d0\u4f9b\u7bc0\u9ede\u7ba1\u7406\u3001\u6a21\u578b\u62c9\u53d6\u3001\u72c0\u614b\u76e3\u63a7\u8207\u5065\u5eb7\u6aa2\u67e5\u7b49\u7aef\u9ede</li> <li>Web UI\uff1a\u5167\u5efa\u7ba1\u7406\u4ecb\u9762\uff08\u4f4d\u65bc <code>ui/</code> \u8207 <code>proxy.web</code>\uff09\u4f9b\u767b\u5165\u8207\u7ba1\u7406\u4f7f\u7528</li> </ul>"},{"location":"zh/getting_started/introduction/#_3","title":"\u6838\u5fc3\u5143\u4ef6","text":"<ul> <li>\u7a0b\u5f0f\u78bc\u6839\u76ee\u9304\uff1a<code>src/</code></li> <li>\u5c08\u6848\u8a2d\u5b9a\uff1a<code>src/aivonx/settings.py</code></li> <li>Proxy \u908f\u8f2f\uff1a<code>src/proxy/</code></li> </ul>"},{"location":"zh/getting_started/introduction/#_4","title":"\u67b6\u69cb\u6982\u89bd","text":"<p>\u4ee3\u7406\u626e\u6f14\u7d71\u4e00\u9598\u9053\uff0c\u6703\u4f9d\u64da\u4ee5\u4e0b\u689d\u4ef6\u5c07\u8acb\u6c42\u8def\u7531\u5230\u5f8c\u7aef Ollama \u7bc0\u9ede\uff1a - \u6a21\u578b\u662f\u5426\u5b58\u5728\u65bc\u7bc0\u9ede\u4e0a - \u7bc0\u9ede\u5065\u5eb7\u72c0\u614b - \u8ca0\u8f09\u5e73\u8861\u7b56\u7565\uff08\u6700\u5c11\u6d3b\u52d5\u6216\u6700\u4f4e\u5ef6\u9072\uff09 - \u5373\u6642\u76e3\u63a7\u8207\u6545\u969c\u8f49\u79fb\u6a5f\u5236</p>"},{"location":"zh/getting_started/quick_start_guide/","title":"\u5feb\u901f\u4e0a\u624b\u6307\u5357","text":""},{"location":"zh/getting_started/quick_start_guide/#1docker-compose","title":"\u9078\u9805 1\uff1aDocker Compose\uff08\u5efa\u8b70\uff09","text":"<p>\u6700\u5feb\u4e0a\u624b\u7684\u65b9\u5f0f\u662f\u5f9e\u5c08\u6848\u6839\u76ee\u9304\u4f7f\u7528 Docker Compose\uff1a</p> <pre><code># \u6a19\u6e96\u90e8\u7f72\ndocker-compose up --build\n\n# \u6216\u4f7f\u7528\u6e2c\u8a66\u7d44\u614b\ndocker-compose -f docker-compose-test.yml up --build\n</code></pre> <p>\u555f\u52d5\u5f8c\u5b58\u53d6\u4ecb\u9762\uff1a - Web UI\uff1ahttp://localhost:8000 - API \u6587\u4ef6\uff1ahttp://localhost:8000/swagger \u6216 http://localhost:8000/redoc</p>"},{"location":"zh/getting_started/quick_start_guide/#_2","title":"\u9810\u8a2d\u5e33\u865f","text":"<ul> <li>\u4f7f\u7528\u8005\u540d\u7a31\uff1a<code>root</code></li> <li>\u5bc6\u78bc\uff1a<code>changeme</code></li> </ul> <p>\u26a0\ufe0f \u91cd\u8981\uff1a\u8acb\u900f\u904e <code>.env</code> \u8a2d\u5b9a <code>ROOT_PASSWORD</code> \u4f86\u4fee\u6539\u9810\u8a2d\u5bc6\u78bc\u3002</p>"},{"location":"zh/getting_started/quick_start_guide/#2","title":"\u9078\u9805 2\uff1a\u672c\u6a5f\u958b\u767c\u4f3a\u670d\u5668","text":"<p>\u672c\u6a5f\u958b\u767c\uff08\u652f\u63f4\u71b1\u91cd\u8f09\uff09\uff1a</p> <pre><code># \u5b89\u88dd\u76f8\u4f9d\nuv sync\n\n# \u57f7\u884c migrations\npython src/manage.py migrate\n\n# \u555f\u52d5 ASGI \u958b\u767c\uff08\u542b reload\uff09\nuv run main.py --reload --port 8000\n\n# \u6216\u4f7f\u7528 Django \u958b\u767c\u4f3a\u670d\u5668\uff08WSGI\uff09\npython src/manage.py runserver\n</code></pre>"},{"location":"zh/getting_started/quick_start_guide/#_3","title":"\u6aa2\u8996\u6587\u4ef6","text":"<p>\u672c\u6a5f\u555f\u52d5\u6587\u4ef6\u4f3a\u670d\uff1a</p> <pre><code>mkdocs serve -f mkdocs.yml\n</code></pre> <p>\u7db2\u5740\u901a\u5e38\u70ba\uff1ahttp://localhost:8000\uff08\u6216 mkdocs \u6307\u5b9a\u7684 port\uff09</p>"},{"location":"zh/getting_started/quick_start_guide/#_4","title":"\u975c\u614b\u6a94\u6848","text":"<p>\u5728\u672c\u6a5f ASGI \u904b\u884c\u6642\uff0c\u4fee\u6539\u975c\u614b\u6a94\u5f8c\u8acb\u57f7\u884c\uff1a</p> <pre><code>python src/manage.py collectstatic --noinput\n</code></pre>"},{"location":"zh/getting_started/requirements/","title":"\u9700\u6c42","text":""},{"location":"zh/getting_started/requirements/#_2","title":"\u7cfb\u7d71\u9700\u6c42","text":"<ul> <li>Python\uff1a&gt;=3.12, &lt;3.13</li> <li>\u4f5c\u696d\u7cfb\u7d71\uff1aLinux\u3001macOS \u6216 Windows\uff08\u5efa\u8b70\u5728\u751f\u7522\u74b0\u5883\u4f7f\u7528 Linux\uff09</li> </ul>"},{"location":"zh/getting_started/requirements/#_3","title":"\u6838\u5fc3\u76f8\u4f9d\u5957\u4ef6","text":"<p>\u6240\u6709\u5c08\u6848\u76f8\u4f9d\u5957\u4ef6\u5747\u6307\u5b9a\u5728 <code>pyproject.toml</code> \u4e2d\u3002\u95dc\u9375\u5957\u4ef6\u5305\u62ec\uff1a</p> <ul> <li>Django\uff1a&gt;=5.2.8 - Web \u6846\u67b6</li> <li>Django REST Framework\uff1a\u5e36\u8a8d\u8b49\u7684 API \u6846\u67b6</li> <li>drf-spectacular\uff1aOpenAPI 3 \u67b6\u69cb\u751f\u6210</li> <li>uvicorn / gunicorn\uff1aASGI/WSGI \u4f3a\u670d\u5668\u9078\u9805</li> <li>Redis\uff1a&gt;=7.1.0 - \u5feb\u53d6\u548c\u6703\u8a71\u5132\u5b58</li> <li>django-redis\uff1aRedis \u5feb\u53d6\u5f8c\u7aef</li> <li>PostgreSQL\uff1a\u751f\u7522\u8cc7\u6599\u5eab\uff08psycopg2-binary\uff09</li> <li>httpx\uff1a\u73fe\u4ee3\u975e\u540c\u6b65 HTTP \u5ba2\u6236\u7aef</li> <li>APScheduler\uff1a\u80cc\u666f\u4efb\u52d9\u6392\u7a0b</li> </ul>"},{"location":"zh/getting_started/requirements/#_4","title":"\u958b\u767c\u5de5\u5177","text":"<p>\u5efa\u8b70\u7528\u65bc\u958b\u767c\uff1a - <code>ipykernel</code>\uff1aJupyter \u6838\u5fc3\u652f\u63f4 - <code>jupyterlab</code>\uff1a\u4e92\u52d5\u5f0f\u958b\u767c\u74b0\u5883 - <code>pytest</code>\uff1a\u6e2c\u8a66\u6846\u67b6 - <code>mkdocs</code> \u548c <code>mkdocs-material</code>\uff1a\u6587\u4ef6\u751f\u6210</p>"},{"location":"zh/getting_started/requirements/#_5","title":"\u5b89\u88dd","text":"<p>\u4f7f\u7528 <code>uv</code> \u5b89\u88dd\uff08\u63a8\u85a6\uff09\uff1a</p> <pre><code>uv sync\n</code></pre> <p>\u6216\u4f7f\u7528 pip\uff1a</p> <pre><code>pip install -e .[dev]\n</code></pre>"},{"location":"zh/reference/api_documentation/","title":"API \u6587\u4ef6","text":"<p>Aivonx Proxy \u7684\u5b8c\u6574 API \u53c3\u8003\u3002\u6240\u6709\u7aef\u9ede\u4f7f\u7528 OpenAPI 3.0 \u898f\u7bc4\u8a18\u9304\u3002</p>"},{"location":"zh/reference/api_documentation/#_1","title":"\u4e92\u52d5\u5f0f\u6587\u4ef6","text":"<p>\u555f\u52d5\u61c9\u7528\u5f8c\u53ef\u5b58\u53d6\u4e92\u52d5\u5f0f API \u6587\u4ef6\uff1a</p> <ul> <li>Swagger UI: http://localhost:8000/swagger</li> <li>ReDoc: http://localhost:8000/redoc</li> <li>OpenAPI Schema: http://localhost:8000/api/schema</li> </ul>"},{"location":"zh/reference/api_documentation/#_2","title":"\u6838\u5fc3\u7aef\u9ede","text":""},{"location":"zh/reference/api_documentation/#_3","title":"\u5065\u5eb7\u6aa2\u67e5","text":"<p>Endpoint: <code>GET /api/health</code></p> <p>\u63cf\u8ff0: \u5168\u57df\u5065\u5eb7\u6aa2\u67e5</p> <p>\u56de\u61c9: <pre><code>{\n  \"status\": \"healthy\"\n}\n</code></pre></p>"},{"location":"zh/reference/api_documentation/#proxy-api","title":"Proxy \u7ba1\u7406 API","text":"<p>\u6240\u6709 proxy \u7ba1\u7406\u7aef\u9ede\u4f4d\u65bc <code>/api/proxy/</code>\u3002\u591a\u6578\u9700\u9a57\u8b49\u3002</p>"},{"location":"zh/reference/api_documentation/#proxy","title":"Proxy \u72c0\u614b","text":"<p>Endpoint: <code>GET /api/proxy/state</code></p> <p>\u8a8d\u8b49: Not required (AllowAny)</p> <p>\u63cf\u8ff0: \u6aa2\u8996\u76ee\u524d\u4ee3\u7406\u7ba1\u7406\u5668\u72c0\u614b\uff0c\u5305\u62ec active/standby \u6c60\u3001\u7bc0\u9ede\u5c0d\u61c9\u3001\u5ef6\u9072\u8207\u6d3b\u52d5\u8acb\u6c42\u6578\u3002</p> <p>\u56de\u61c9: <pre><code>{\n  \"active\": [\"http://node1:11434\", \"http://node2:11434\"],\n  \"standby\": [],\n  \"node_id_map\": {\n    \"1\": \"http://node1:11434\",\n    \"2\": \"http://node2:11434\"\n  },\n  \"latencies\": {\n    \"http://node1:11434\": 0.123,\n    \"http://node2:11434\": 0.145\n  },\n  \"active_counts\": {\n    \"http://node1:11434\": 2,\n    \"http://node2:11434\": 1\n  },\n  \"models\": {\n    \"http://node1:11434\": [\"llama2\", \"codellama\"],\n    \"http://node2:11434\": [\"llama2\", \"mistral\"]\n  }\n}\n</code></pre></p>"},{"location":"zh/reference/api_documentation/#active-requests","title":"Active Requests","text":"<p>Endpoint: <code>GET /api/proxy/active-requests</code></p> <p>Query Parameters: - <code>node_id</code> (optional): Filter by specific node ID</p> <p>\u8a8d\u8b49: Not required (AllowAny)</p> <p>\u63cf\u8ff0: \u53d6\u5f97\u6240\u6709\u7bc0\u9ede\u6216\u7279\u5b9a\u7bc0\u9ede\u7684\u6d3b\u52d5\u8acb\u6c42\u8a08\u6578\u3002</p>"},{"location":"zh/reference/api_documentation/#pull-model","title":"Pull Model","text":"<p>Endpoint: <code>POST /api/proxy/pull</code></p> <p>\u8a8d\u8b49: Not required (AllowAny)</p> <p>\u63cf\u8ff0: \u5c07\u6a21\u578b\u62c9\u53d6\u81f3\u4e00\u500b\u6216\u6240\u6709\u7bc0\u9ede\u3002</p>"},{"location":"zh/reference/api_documentation/#proxy-configuration","title":"Proxy Configuration","text":"<p>Endpoint: <code>GET/PUT/PATCH /api/proxy/config</code></p> <p>\u8a8d\u8b49: Required (IsAuthenticated)</p> <p>\u63cf\u8ff0: \u53d6\u5f97\u6216\u66f4\u65b0\u5168\u57df proxy \u8a2d\u5b9a\uff08\u9078\u64c7\u7b56\u7565\uff09\u3002</p>"},{"location":"zh/reference/api_documentation/#api_1","title":"\u7bc0\u9ede\u7ba1\u7406 API","text":""},{"location":"zh/reference/api_documentation/#_4","title":"\u5217\u8868/\u5efa\u7acb/\u66f4\u65b0/\u522a\u9664 \u7bc0\u9ede","text":"<p>Endpoints: <code>GET/POST/PUT/PATCH/DELETE /api/proxy/nodes</code></p> <p>\u7531 <code>NodeViewSet</code> \u7ba1\u7406\u3002\u8acb\u53c3\u95b1 <code>src/proxy/viewsets.py</code></p>"},{"location":"zh/reference/api_documentation/#proxy-ollama","title":"Proxy \u7aef\u9ede\uff08Ollama \u76f8\u5bb9\uff09","text":"<ul> <li><code>POST /api/generate</code> - \u7522\u751f\u6587\u672c</li> <li><code>POST /api/chat</code> - \u804a\u5929\u751f\u6210</li> <li><code>POST /api/embed</code> - \u55ae\u7b46 embedding</li> <li><code>POST /api/embeddings</code> - \u6279\u6b21 embedding</li> <li><code>GET /api/tags</code> - \u5217\u51fa\u53ef\u7528\u6a21\u578b</li> <li><code>GET /api/ps</code> - \u5217\u51fa\u6b63\u5728\u57f7\u884c\u7684\u6a21\u578b</li> </ul> <p>\u5be6\u4f5c\u4f4d\u7f6e\uff1a<code>src/proxy/views_proxy.py</code></p>"},{"location":"zh/reference/api_documentation/#_5","title":"\u6a21\u578b\u8207\u5e8f\u5217\u5316","text":"<p>\u8a73\u7d30\u6b04\u4f4d\u8acb\u53c3\u8003\uff1a - Models: <code>src/proxy/models.py</code> - Serializers: <code>src/proxy/serializers.py</code></p>"},{"location":"zh/reference/cli_commands/","title":"CLI \u6307\u4ee4","text":"<p>Django \u7ba1\u7406\u6307\u4ee4\u8207\u5e38\u7528\u64cd\u4f5c\u3002</p>"},{"location":"zh/reference/cli_commands/#_1","title":"\u5e38\u7528\u6307\u4ee4","text":"<ul> <li><code>python src/manage.py migrate</code> \u2014 \u57f7\u884c\u8cc7\u6599\u5eab\u9077\u79fb</li> <li><code>python src/manage.py createsuperuser</code> \u2014 \u5efa\u7acb\u7ba1\u7406\u54e1\u5e33\u865f</li> <li><code>python src/manage.py test</code> \u2014 \u57f7\u884c\u6e2c\u8a66</li> <li><code>python src/manage.py collectstatic</code> \u2014 \u6536\u96c6\u975c\u614b\u6a94</li> <li><code>python src/manage.py runserver</code> \u2014 \u555f\u52d5\u958b\u767c\u4f3a\u670d\u5668\uff08WSGI\uff09</li> </ul>"},{"location":"zh/reference/cli_commands/#asgi","title":"\u958b\u767c\u4f3a\u670d\u5668\uff08ASGI \u63a8\u85a6\uff09","text":"<p>\u4f7f\u7528 uvicorn\uff08ASGI\uff0c\u5efa\u8b70\u7528\u65bc\u4e32\u6d41\uff09\uff1a</p> <pre><code>uv run main.py --reload --port 8000\n</code></pre>"},{"location":"zh/reference/cli_commands/#docker","title":"Docker \u74b0\u5883","text":"<p>\u5728\u5bb9\u5668\u5167\u57f7\u884c\u6307\u4ee4\uff1a</p> <pre><code>docker-compose run --rm web python src/manage.py migrate\n</code></pre>"},{"location":"zh/reference/cli_commands/#shell","title":"\u4e92\u52d5 Shell","text":"<p>\u4f7f\u7528 Django shell \u9032\u884c\u4e92\u52d5\u5f0f\u6e2c\u8a66\uff1a</p> <pre><code>python src/manage.py shell\n</code></pre>"},{"location":"zh/reference/configuration/","title":"\u8a2d\u5b9a\u53c3\u8003","text":"<p>\u4e3b\u8981\u8a2d\u5b9a\u6a94\u4f4d\u65bc <code>src/aivonx/settings.py</code>\u3002</p>"},{"location":"zh/reference/configuration/#_2","title":"\u6838\u5fc3\u8a2d\u5b9a","text":""},{"location":"zh/reference/configuration/#debug","title":"Debug \u6a21\u5f0f","text":"<ul> <li>\u8a2d\u5b9a: <code>DEBUG</code></li> <li>\u74b0\u5883\u8b8a\u6578: <code>DJANGO_DEBUG</code></li> <li>\u9810\u8a2d: <code>True</code>\uff08\u958b\u767c\u74b0\u5883\uff09</li> <li>\u751f\u7522: \u5fc5\u9808\u8a2d\u70ba <code>false</code></li> </ul> <pre><code>DJANGO_DEBUG=false\n</code></pre>"},{"location":"zh/reference/configuration/#secret-key","title":"Secret Key","text":"<ul> <li>\u8a2d\u5b9a: <code>SECRET_KEY</code></li> <li>\u74b0\u5883\u8b8a\u6578: <code>DJANGO_SECRET_KEY</code></li> <li>\u5fc5\u8981: \u662f\uff08\u751f\u7522\u74b0\u5883\uff09</li> <li>\u63cf\u8ff0: Django \u7528\u65bc\u52a0\u5bc6\u7c3d\u540d\u7684\u91d1\u9470</li> </ul> <pre><code>DJANGO_SECRET_KEY=your-secret-key-here\n</code></pre> <p>\u26a0\ufe0f \u5207\u52ff\u5c07 secret key \u63d0\u4ea4\u81f3\u7248\u672c\u63a7\u5236</p>"},{"location":"zh/reference/configuration/#allowed-hosts","title":"Allowed Hosts","text":"<ul> <li>\u8a2d\u5b9a: <code>ALLOWED_HOSTS</code></li> <li>\u74b0\u5883\u8b8a\u6578: <code>DJANGO_ALLOWED_HOSTS</code></li> <li>\u683c\u5f0f: \u4ee5\u9017\u865f\u5206\u9694\u7684\u4e3b\u6a5f\u6e05\u55ae</li> <li>\u9810\u8a2d: <code>*</code>\uff08\u50c5\u958b\u767c\u74b0\u5883\uff09</li> </ul> <pre><code>DJANGO_ALLOWED_HOSTS=example.com,api.example.com\n</code></pre>"},{"location":"zh/reference/configuration/#_3","title":"\u8cc7\u6599\u5eab\u8a2d\u5b9a","text":"<p>\u9810\u8a2d\u4f7f\u7528 PostgreSQL\uff0c\u8acb\u900f\u904e\u74b0\u5883\u8b8a\u6578\u8a2d\u5b9a\uff1a</p> <pre><code>POSTGRES_DB=app_db\nPOSTGRES_USER=user\nPOSTGRES_PASSWORD=secure_password\nPOSTGRES_HOST=postgres\nPOSTGRES_PORT=5432\n</code></pre> <p>\u8cc7\u6599\u5eab\u5f15\u64ce: <code>django.db.backends.postgresql</code></p>"},{"location":"zh/reference/configuration/#_4","title":"\u5feb\u53d6\u8a2d\u5b9a","text":"<p>\u4f7f\u7528 Redis \u505a\u70ba\u5feb\u53d6\u8207 session \u5b58\u653e\uff1a</p> <pre><code>REDIS_URL=redis://redis:6379/1\n</code></pre> <p>\u5f8c\u7aef: <code>django_redis.cache.RedisCache</code></p>"},{"location":"zh/reference/configuration/#_5","title":"\u5b89\u5168\u8a2d\u5b9a","text":""},{"location":"zh/reference/configuration/#cors","title":"CORS\uff08\u8de8\u4f86\u6e90\u8cc7\u6e90\u5206\u4eab\uff09","text":"<pre><code>DJANGO_CORS_ALLOWED_ORIGINS=https://example.com,https://app.example.com\n</code></pre> <ul> <li>\u8a2d\u5b9a: <code>CORS_ALLOWED_ORIGINS</code></li> <li>\u683c\u5f0f: \u542b\u5354\u5b9a\uff08http:// \u6216 https://\uff09\u4e4b\u9017\u865f\u5206\u9694 URL \u6e05\u55ae</li> <li>\u6ce8\u610f: \u82e5\u7f3a\u5c11\u5354\u5b9a\uff0c\u7cfb\u7d71\u6703\u81ea\u52d5\u88dc\u4e0a <code>http://</code> \u6216 <code>https://</code></li> </ul>"},{"location":"zh/reference/configuration/#csrf","title":"CSRF\uff08\u8de8\u7ad9\u8acb\u6c42\u507d\u9020\uff09","text":"<pre><code>DJANGO_CSRF_TRUSTED_ORIGINS=https://example.com,https://app.example.com\n</code></pre>"},{"location":"zh/reference/configuration/#_6","title":"\u975c\u614b\u6a94\u6848","text":""},{"location":"zh/reference/configuration/#static-url-root","title":"Static URL \u8207 Root","text":"<ul> <li>STATIC_URL: <code>/static/</code></li> <li>STATIC_ROOT: <code>{BASE_DIR}/staticfiles</code></li> <li>STATICFILES_DIRS: <code>[{BASE_DIR}/ui/static]</code></li> </ul>"},{"location":"zh/reference/configuration/#whitenoise","title":"WhiteNoise \u8a2d\u5b9a","text":"<p>\u5c08\u6848\u4f7f\u7528 WhiteNoise \u4ee5\u6709\u6548\u7387\u5730\u63d0\u4f9b\u975c\u614b\u6a94\u6848\uff1a</p> <ul> <li>Storage: <code>whitenoise.storage.CompressedManifestStaticFilesStorage</code></li> <li>Middleware: <code>whitenoise.middleware.WhiteNoiseMiddleware</code></li> </ul>"},{"location":"zh/reference/configuration/#_7","title":"\u6536\u96c6\u975c\u614b\u6a94\u6848","text":"<pre><code>python src/manage.py collectstatic --noinput\n</code></pre>"},{"location":"zh/reference/configuration/#_8","title":"\u65e5\u8a8c\u8a2d\u5b9a","text":"<p>\u65e5\u8a8c\u8a2d\u5b9a\u5305\u542b\u591a\u500b handler \u8207 formatter\uff1a</p>"},{"location":"zh/reference/configuration/#_9","title":"\u65e5\u8a8c\u6a94","text":"<ul> <li>\u4e00\u822c\u65e5\u8a8c: <code>logs/django.json</code>\uff08JSON \u683c\u5f0f\uff0c\u8f2a\u66ff\uff09</li> <li>Proxy \u65e5\u8a8c: <code>logs/proxy.json</code>\uff08JSON \u683c\u5f0f\uff0c\u8f2a\u66ff\uff09</li> <li>\u932f\u8aa4\u65e5\u8a8c: <code>logs/django_error.log</code>\uff08\u50c5 ERROR \u7b49\u7d1a\uff09</li> <li>\u9664\u932f\u65e5\u8a8c: <code>logs/django_debug.log</code>\uff08DEBUG \u7b49\u7d1a\uff09</li> </ul>"},{"location":"zh/reference/configuration/#_10","title":"\u65e5\u8a8c\u8f2a\u66ff","text":"<ul> <li>\u6700\u5927\u6a94\u6848\u5927\u5c0f: \u6bcf\u6a94 10 MB</li> <li>\u5099\u4efd\u6578\u91cf: 3 \u500b\u6a94\u6848</li> <li>Formatter: JSON\uff08pythonjsonlogger\uff09</li> </ul>"},{"location":"zh/reference/configuration/#_11","title":"\u74b0\u5883\u8b8a\u6578","text":"<pre><code>LOG_JSON_PATH=logs/django.json\nPROXY_LOG_JSON_PATH=logs/proxy.json\n</code></pre>"},{"location":"zh/reference/configuration/#api","title":"API \u6587\u4ef6\u8a2d\u5b9a","text":""},{"location":"zh/reference/configuration/#drf-spectacular","title":"drf-spectacular \u8a2d\u5b9a","text":"<pre><code>SPECTACULAR_SETTINGS = {\n    'TITLE': 'aivonx proxy API',\n    'DESCRIPTION': 'API documentation for aivonx proxy',\n    'VERSION': '1.0.0',\n}\n</code></pre>"},{"location":"zh/reference/configuration/#api-url","title":"API \u6587\u4ef6 URL","text":"<ul> <li>OpenAPI Schema: <code>/api/schema</code></li> <li>Swagger UI: <code>/swagger</code></li> <li>ReDoc: <code>/redoc</code></li> </ul>"},{"location":"zh/reference/configuration/#rest-framework","title":"REST Framework \u8a2d\u5b9a","text":""},{"location":"zh/reference/configuration/#_12","title":"\u8a8d\u8b49","text":"<ul> <li>JWT\uff08SimpleJWT\uff09</li> <li>Session Authentication</li> <li>Token Authentication</li> </ul>"},{"location":"zh/reference/configuration/#_13","title":"\u6b0a\u9650","text":"<p>\u9810\u8a2d: <code>IsAuthenticated</code>\uff08\u9664\u975e\u660e\u78ba\u8a2d\u70ba <code>AllowAny</code>\uff0c\u5426\u5247\u6240\u6709\u7aef\u9ede\u9700\u9a57\u8b49\uff09</p>"},{"location":"zh/reference/configuration/#_14","title":"\u5206\u9801","text":"<ul> <li>Class: <code>LimitOffsetPagination</code></li> <li>Page Size: 100 items</li> <li>\u53c3\u6578: <code>?limit=N&amp;offset=M</code></li> </ul>"},{"location":"zh/reference/configuration/#schema","title":"Schema \u7522\u751f","text":"<p>Class: <code>drf_spectacular.openapi.AutoSchema</code></p>"},{"location":"zh/reference/configuration/#_15","title":"\u8a8d\u8b49\u76f8\u95dc\u8a2d\u5b9a","text":""},{"location":"zh/reference/configuration/#loginlogout-url","title":"Login/Logout URL","text":"<ul> <li>LOGIN_URL: <code>/</code></li> <li>LOGIN_REDIRECT_URL: <code>/ui/manage</code></li> <li>LOGOUT_REDIRECT_URL: <code>/</code></li> </ul>"},{"location":"zh/reference/configuration/#root","title":"\u9810\u8a2d root \u5bc6\u78bc","text":"<pre><code>ROOT_PASSWORD=changeme\n</code></pre>"},{"location":"zh/reference/configuration/#_16","title":"\u6a21\u677f\u8a2d\u5b9a","text":"<p>\u6a21\u677f\u76ee\u9304\uff1a - <code>{BASE_DIR}/ui/templates</code> - <code>{BASE_DIR}/proxy/templates</code> - <code>{BASE_DIR}/logviewer/templates</code></p>"},{"location":"zh/reference/configuration/#_17","title":"\u570b\u969b\u5316","text":"<ul> <li>Language Code: <code>zh-hant</code>\uff08\u7e41\u9ad4\u4e2d\u6587\uff09</li> <li>Time Zone: <code>Asia/Taipei</code></li> <li>USE_I18N: <code>True</code></li> <li>USE_TZ: <code>True</code></li> </ul>"},{"location":"zh/reference/configuration/#middleware","title":"Middleware \u6e05\u55ae","text":"<ol> <li><code>django.middleware.security.SecurityMiddleware</code></li> <li><code>django.contrib.sessions.middleware.SessionMiddleware</code></li> <li><code>django.middleware.common.CommonMiddleware</code></li> <li><code>django.middleware.csrf.CsrfViewMiddleware</code></li> <li><code>django.contrib.auth.middleware.AuthenticationMiddleware</code></li> <li><code>django.contrib.messages.middleware.MessageMiddleware</code></li> <li><code>django.middleware.clickjacking.XFrameOptionsMiddleware</code></li> <li><code>corsheaders.middleware.CorsMiddleware</code></li> <li><code>whitenoise.middleware.WhiteNoiseMiddleware</code></li> </ol>"},{"location":"zh/reference/configuration/#_18","title":"\u5df2\u5b89\u88dd\u61c9\u7528","text":"<ul> <li><code>django.contrib.admin</code></li> <li><code>django.contrib.auth</code></li> <li><code>django.contrib.contenttypes</code></li> <li><code>django.contrib.sessions</code></li> <li><code>django.contrib.messages</code></li> <li><code>django.contrib.staticfiles</code></li> <li><code>rest_framework</code></li> <li><code>drf_spectacular</code></li> <li><code>corsheaders</code></li> <li><code>proxy</code> (custom)</li> <li><code>account</code> (custom)</li> <li><code>logviewer</code> (custom)</li> </ul>"},{"location":"zh/resources/glossary/","title":"\u8853\u8a9e\u8868\uff08\u7e41\u9ad4\u4e2d\u6587\uff09","text":"<p>\u672c\u6587\u4ef6\u5217\u51fa Aivonx Proxy \u5e38\u7528\u7684\u8853\u8a9e\u8207\u6982\u5ff5\u8aaa\u660e\u3002</p>"},{"location":"zh/resources/glossary/#_2","title":"\u6838\u5fc3\u6982\u5ff5","text":""},{"location":"zh/resources/glossary/#node","title":"\u7bc0\u9ede\uff08Node\uff09","text":"<p>\u63d0\u4f9b\u6a21\u578b\u63a8\u8ad6\u80fd\u529b\u7684\u5f8c\u7aef Ollama \u670d\u52d9\u3002\u6bcf\u500b\u7bc0\u9ede\u5305\u542b\uff1a - \u552f\u4e00\u8b58\u5225\u78bc\uff08ID\uff09 - \u7db2\u8def\u4f4d\u5740\uff08host:port\uff09 - \u53ef\u627f\u8f09\u591a\u500b\u6a21\u578b - \u6d3b\u8e8d / \u4e0d\u6d3b\u8e8d \u72c0\u614b - \u6703\u88ab\u76e3\u63a7\u5065\u5eb7\u72c0\u614b\u8207\u5ef6\u9072</p> <p>\u8cc7\u6599\u6a21\u578b\uff1a\u5b9a\u7fa9\u65bc <code>src/proxy/models.py</code></p>"},{"location":"zh/resources/glossary/#active-pool","title":"\u6d3b\u8e8d\u6c60\uff08Active Pool\uff09","text":"<p>\u76ee\u524d\u5065\u5eb7\u4e14\u53ef\u63a5\u6536\u8acb\u6c42\u7684\u7bc0\u9ede\u96c6\u5408\u3002\u6d3b\u8e8d\u6c60\u4e2d\u7684\u7bc0\u9ede\uff1a - \u901a\u904e\u8fd1\u671f\u5065\u5eb7\u6aa2\u67e5 - \u53ef\u7531 proxy \u7ba1\u7406\u5668\u9078\u53d6 - \u5176\u5ef6\u9072\u8207\u7576\u524d\u8655\u7406\u4e2d\u8acb\u6c42\u6578\u6703\u88ab\u8ffd\u8e64</p>"},{"location":"zh/resources/glossary/#standby-pool","title":"\u5f85\u547d\u6c60\uff08Standby Pool\uff09","text":"<p>\u5df2\u8a2d\u5b9a\u4f46\u76ee\u524d\u4e0d\u5065\u5eb7\u6216\u975e\u6d3b\u8e8d\u7684\u7bc0\u9ede\u96c6\u5408\u3002\u7bc0\u9ede\u6703\u5728\u4ee5\u4e0b\u60c5\u6cc1\u79fb\u5165\u5f85\u547d\u6c60\uff1a - \u5065\u5eb7\u6aa2\u67e5\u5931\u6557 - \u88ab\u624b\u52d5\u8a2d\u5b9a\u70ba\u4e0d\u6d3b\u8e8d - \u767c\u751f\u9023\u7dda\u932f\u8aa4</p> <p>\u7bc0\u9ede\u6062\u5fa9\u5f8c\u6703\u81ea\u52d5\u79fb\u56de\u6d3b\u8e8d\u6c60\u3002</p>"},{"location":"zh/resources/glossary/#proxy-manager","title":"\u4ee3\u7406\u7ba1\u7406\u5668\uff08Proxy Manager\uff09","text":"<p>\u6838\u5fc3\u5143\u4ef6\uff0c\u8ca0\u8cac\uff1a - \u7dad\u8b77\u6d3b\u8e8d\u8207\u5f85\u547d\u6c60 - \u70ba\u8acb\u6c42\u9078\u53d6\u9069\u7576\u7bc0\u9ede - \u8ffd\u8e64\u5ef6\u9072\u8207\u6d3b\u8e8d\u8acb\u6c42\u6578 - \u9031\u671f\u6027\u57f7\u884c\u5065\u5eb7\u6aa2\u67e5 - \u7ba1\u7406\u7bc0\u9ede\u751f\u547d\u9031\u671f</p> <p>\u5be6\u4f5c\u4f4d\u7f6e\uff1a<code>src/proxy/utils/proxy_manager.py</code></p>"},{"location":"zh/resources/glossary/#proxyconfig","title":"ProxyConfig","text":"<p>\u4ee3\u7406\u7bc0\u9ede\u9078\u64c7\u7b56\u7565\u7684\u5168\u57df\u8a2d\u5b9a\uff0c\u5305\u542b\uff1a - \u7b56\u7565\uff08Strategy\uff09\uff1a\u9078\u53d6\u6f14\u7b97\u6cd5\uff08<code>least_active</code> \u6216 <code>lowest_latency</code>\uff09 - \u6700\u5f8c\u66f4\u65b0\u6642\u9593\uff08Updated At\uff09\uff1a\u6700\u5f8c\u4fee\u6539\u6642\u9593\u6233</p> <p>\u8cc7\u6599\u6a21\u578b\uff1a\u5b9a\u7fa9\u65bc <code>src/proxy/models.py</code></p>"},{"location":"zh/resources/glossary/#_3","title":"\u9078\u53d6\u7b56\u7565","text":""},{"location":"zh/resources/glossary/#least-active","title":"\u6700\u5c11\u6d3b\u8e8d\uff08Least Active\uff0c\u9810\u8a2d\uff09","text":"<p>\u9078\u64c7\u7576\u524d\u8655\u7406\u4e2d\u8acb\u6c42\u6578\u6700\u5c11\u7684\u7bc0\u9ede\uff0c\u9069\u7528\u65bc\uff1a - \u8ca0\u8f09\u5e73\u8861 - \u907f\u514d\u55ae\u4e00\u7bc0\u9ede\u904e\u8f09 - \u5747\u52fb\u5206\u914d\u5de5\u4f5c</p>"},{"location":"zh/resources/glossary/#lowest-latency","title":"\u6700\u4f4e\u5ef6\u9072\uff08Lowest Latency\uff09","text":"<p>\u9078\u64c7\u56de\u61c9\u6642\u9593\u6700\u77ed\u7684\u7bc0\u9ede\uff0c\u9069\u7528\u65bc\uff1a - \u6700\u5c0f\u5316\u56de\u61c9\u5ef6\u9072 - \u5730\u7406\u4f4d\u7f6e\u512a\u5316 - \u5c0d\u5ef6\u9072\u654f\u611f\u7684\u61c9\u7528</p>"},{"location":"zh/resources/glossary/#_4","title":"\u8acb\u6c42\u76f8\u95dc\u6982\u5ff5","text":""},{"location":"zh/resources/glossary/#active-request","title":"\u6d3b\u8e8d\u8acb\u6c42\uff08Active Request\uff09","text":"<p>\u7bc0\u9ede\u6b63\u5728\u8655\u7406\u4e2d\u7684\u8acb\u6c42\u3002\u8a08\u6578\u6703\uff1a - \u5728\u6d3e\u9001\u8acb\u6c42\u6642\u905e\u589e - \u5728\u56de\u61c9\u5b8c\u6210\u6642\u905e\u6e1b - \u5b58\u653e\u65bc Redis \u4ee5\u652f\u63f4\u8de8\u7a0b\u5e8f\u53ef\u898b\u6027 - \u88ab <code>least_active</code> \u7b56\u7565\u4f7f\u7528</p>"},{"location":"zh/resources/glossary/#model-aware-routing","title":"\u6a21\u578b\u611f\u77e5\u8def\u7531\uff08Model-Aware Routing\uff09","text":"<p>\u4ee3\u7406\u50c5\u6703\u5c07\u8acb\u6c42\u8def\u7531\u81f3\u5177\u6709\u8a72\u6a21\u578b\u7684\u7bc0\u9ede\uff0c\u78ba\u4fdd\uff1a - \u4e0d\u6703\u56e0\u70ba\u6a21\u578b\u4e0d\u5b58\u5728\u800c\u767c\u751f\u5931\u6557 - \u6709\u6548\u5229\u7528\u7bc0\u9ede\u8cc7\u6e90 - \u82e5\u6a21\u578b\u53ef\u7528\u6027\u6539\u8b8a\uff0c\u6703\u81ea\u52d5\u6545\u969c\u8f49\u79fb</p>"},{"location":"zh/resources/glossary/#streaming-response","title":"\u4e32\u6d41\u56de\u61c9\uff08Streaming Response\uff09","text":"<p>\u9010\u6b65\u8f38\u51fa\u56de\u61c9\uff08\u908a\u7522\u751f\u908a\u50b3\u9001\uff09\uff0c\u800c\u975e\u7b49\u5230\u5b8c\u6574\u7d50\u679c\u624d\u56de\u50b3\u3002\u512a\u9ede\uff1a - \u964d\u4f4e\u9996\u500b token \u7684\u5ef6\u9072 - \u6539\u5584\u804a\u5929\u61c9\u7528\u7684\u4f7f\u7528\u9ad4\u9a57 - \u6e1b\u5c11\u8a18\u61b6\u9ad4\u4f7f\u7528\u91cf</p> <p>\u9700\u6c42\uff1aASGI \u4f3a\u670d\u5668\uff08\u4f8b\u5982 <code>uvicorn</code>\uff09</p>"},{"location":"zh/resources/glossary/#_5","title":"\u5065\u5eb7\u6aa2\u67e5\u8207\u76e3\u63a7","text":""},{"location":"zh/resources/glossary/#health-check","title":"\u5065\u5eb7\u6aa2\u67e5\uff08Health Check\uff09","text":"<p>\u5b9a\u671f\u5411\u7bc0\u9ede\u7684 <code>/api/health</code> \u767c\u51fa\u8acb\u6c42\u4ee5\u78ba\u8a8d\uff1a - \u7bc0\u9ede\u53ef\u9054 - \u670d\u52d9\u6709\u56de\u61c9 - \u7bc0\u9ede\u61c9\u8655\u65bc\u6d3b\u8e8d\u6c60</p> <p>\u983b\u7387\uff1a\u9810\u8a2d\u6bcf 1 \u5206\u9418</p>"},{"location":"zh/resources/glossary/#latency","title":"\u5ef6\u9072\uff08Latency\uff09","text":"<p>\u5065\u5eb7\u6aa2\u67e5\u7684\u4f86\u56de\u6642\u9593\uff08round-trip time\uff09\uff0c\u7528\u65bc\uff1a - <code>lowest_latency</code> \u9078\u53d6\u7b56\u7565 - \u76e3\u63a7\u8207\u8a3a\u65b7 - \u6548\u80fd\u512a\u5316</p> <p>\u5132\u5b58\uff1aRedis \u5feb\u53d6</p>"},{"location":"zh/resources/glossary/#available-models","title":"\u53ef\u7528\u6a21\u578b\uff08Available Models\uff09","text":"<p>\u7bc0\u9ede\u4e0a\u76ee\u524d\u53ef\u7528\u7684\u6a21\u578b\u6e05\u55ae\uff0c\u4f86\u6e90\u65bc\uff1a - \u67e5\u8a62 <code>/api/tags</code> \u7aef\u9ede - \u9031\u671f\u6027\u5237\u65b0\uff08\u9810\u8a2d\u6bcf 1 \u5206\u9418\uff09 - \u624b\u52d5\u62c9\u53d6\u6a21\u578b\u8cc7\u8a0a</p> <p>\u5132\u5b58\uff1a\u8cc7\u6599\u5eab\u8207 Redis \u5feb\u53d6</p>"},{"location":"zh/resources/glossary/#api","title":"API \u76f8\u95dc\u6982\u5ff5","text":""},{"location":"zh/resources/glossary/#viewset","title":"ViewSet","text":"<p>Django REST Framework \u7684\u985e\u5225\uff0c\u7528\u65bc\u63d0\u4f9b\u8cc7\u6e90\u7684 CRUD \u64cd\u4f5c\u3002\u4f8b\u5982\uff1a - <code>NodeViewSet</code>\uff1a\u7bc0\u9ede\u8cc7\u6e90\u7ba1\u7406 - \u63d0\u4f9b\uff1a\u5217\u8868\u3001\u5efa\u7acb\u3001\u53d6\u5f97\u3001\u66f4\u65b0\u3001\u522a\u9664</p> <p>\u4f4d\u7f6e\uff1a<code>src/proxy/viewsets.py</code></p>"},{"location":"zh/resources/glossary/#serializer","title":"Serializer","text":"<p>\u8ca0\u8cac\u5728 Python \u7269\u4ef6\u8207 JSON \u4e4b\u9593\u4e92\u76f8\u8f49\u63db\uff0c\u7528\u65bc API \u56de\u61c9\u3002\u529f\u80fd\u5305\u542b\uff1a - \u8cc7\u6599\u9a57\u8b49 - \u6b04\u4f4d\u5c64\u7d1a\u7684\u6b0a\u9650\u8655\u7406 - \u652f\u63f4\u5de2\u72c0\u95dc\u806f</p> <p>\u4f4d\u7f6e\uff1a<code>src/proxy/serializers.py</code></p>"},{"location":"zh/resources/glossary/#jwtjson-web-token","title":"JWT\uff08JSON Web Token\uff09","text":"<p>\u4e00\u7a2e\u7121\u72c0\u614b\u7684\u8a8d\u8b49 token\uff0c\u7528\u65bc API \u5b58\u53d6\uff0c\u901a\u5e38\u5305\u542b\uff1a - \u4f7f\u7528\u8005\u8b58\u5225\u8cc7\u8a0a - \u5230\u671f\u6642\u9593 - \u52a0\u5bc6\u7c3d\u7ae0</p>"},{"location":"zh/resources/glossary/#_6","title":"\u57fa\u790e\u5efa\u8a2d","text":""},{"location":"zh/resources/glossary/#asgiasynchronous-server-gateway-interface","title":"ASGI\uff08Asynchronous Server Gateway Interface\uff09","text":"<p>\u73fe\u4ee3 Python Web \u4f3a\u670d\u5668\u4ecb\u9762\uff0c\u652f\u63f4\uff1a - \u975e\u540c\u6b65\uff08async/await\uff09 - WebSocket - \u4e32\u6d41\u56de\u61c9 - \u9577\u9023\u7dda</p> <p>\u5be6\u4f5c\u7bc4\u4f8b\uff1a<code>uvicorn</code>, <code>Daphne</code></p>"},{"location":"zh/resources/glossary/#wsgiweb-server-gateway-interface","title":"WSGI\uff08Web Server Gateway Interface\uff09","text":"<p>\u50b3\u7d71\u7684\u540c\u6b65 Web \u4f3a\u670d\u5668\u4ecb\u9762\uff0c\u7528\u65bc\uff1a - \u540c\u6b65\u8acb\u6c42/\u56de\u61c9\u6d41\u7a0b - \u50b3\u7d71 Web \u61c9\u7528</p> <p>\u5be6\u4f5c\u7bc4\u4f8b\uff1a<code>Gunicorn</code>, <code>uWSGI</code></p>"},{"location":"zh/resources/glossary/#redis","title":"Redis","text":"<p>\u8a18\u61b6\u9ad4\u578b\u8cc7\u6599\u5eab\uff0c\u7528\u65bc\uff1a - \u5feb\u53d6\u7bc0\u9ede\u72c0\u614b - \u5132\u5b58\u6d3b\u8e8d\u8acb\u6c42\u8a08\u6578 - Session \u5b58\u653e - \u4efb\u52d9\u4f47\u5217\uff08\u53ef\u9078\uff09</p>"},{"location":"zh/resources/glossary/#postgresql","title":"PostgreSQL","text":"<p>\u95dc\u806f\u5f0f\u8cc7\u6599\u5eab\uff0c\u7528\u65bc\u5132\u5b58\uff1a - \u7bc0\u9ede\u8a2d\u5b9a - \u4ee3\u7406\u8a2d\u5b9a - \u4f7f\u7528\u8005\u5e33\u865f - \u7a3d\u6838\u65e5\u8a8c</p>"},{"location":"zh/resources/glossary/#django","title":"Django \u6982\u5ff5","text":""},{"location":"zh/resources/glossary/#migration","title":"Migration","text":"<p>\u63cf\u8ff0\u8cc7\u6599\u5eab\u7d50\u69cb\u8b8a\u66f4\u7684 Python \u6a94\u6848\uff0c\u7528\u65bc\uff1a - \u5c0d\u8cc7\u6599\u5eab\u7d50\u69cb\u9032\u884c\u7248\u672c\u63a7\u5236 - \u90e8\u7f72\u7d50\u69cb\u8b8a\u66f4 - \u9700\u8981\u6642\u56de\u6efe\u8b8a\u66f4</p> <p>\u4f4d\u7f6e\uff1a<code>src/*/migrations/</code></p>"},{"location":"zh/resources/glossary/#app-config","title":"App Config","text":"<p>Django \u61c9\u7528\u8a2d\u5b9a\uff0c\u53ef\u7528\u4f86\uff1a - \u521d\u59cb\u5316\u5168\u57df\u72c0\u614b - \u8a3b\u518a signal \u8655\u7406\u5668 - \u8a2d\u5b9a\u61c9\u7528\u76f8\u95dc\u53c3\u6578</p> <p>\u7bc4\u4f8b\uff1a<code>src/proxy/apps.py</code> \u4e2d\u7684 proxy \u7ba1\u7406\u5668\u521d\u59cb\u5316</p>"},{"location":"zh/resources/glossary/#middleware","title":"Middleware","text":"<p>\u8655\u7406\u5168\u57df\u8acb\u6c42/\u56de\u61c9\u6d41\u7a0b\u7684\u5143\u4ef6\uff0c\u5305\u542b\uff1a - \u5b89\u5168\u6a19\u982d - CORS - \u8a8d\u8b49 - \u65e5\u8a8c</p>"},{"location":"zh/resources/glossary/#_7","title":"\u7e2e\u5beb\u6e05\u55ae","text":"<ul> <li>API\uff1aApplication Programming Interface\uff08\u61c9\u7528\u7a0b\u5f0f\u4ecb\u9762\uff09</li> <li>ASGI\uff1aAsynchronous Server Gateway Interface</li> <li>CORS\uff1aCross-Origin Resource Sharing\uff08\u8de8\u4f86\u6e90\u8cc7\u6e90\u5171\u7528\uff09</li> <li>CRUD\uff1aCreate, Read, Update, Delete\uff08\u65b0\u589e\u3001\u8b80\u53d6\u3001\u66f4\u65b0\u3001\u522a\u9664\uff09</li> <li>CSRF\uff1aCross-Site Request Forgery\uff08\u8de8\u7ad9\u8acb\u6c42\u507d\u9020\uff09</li> <li>DRF\uff1aDjango REST Framework</li> <li>HA\uff1aHigh Availability\uff08\u9ad8\u53ef\u7528\u6027\uff09</li> <li>HTTP\uff1aHypertext Transfer Protocol</li> <li>HTTPS\uff1aHTTP Secure\uff08\u5b89\u5168\u7684 HTTP\uff09</li> <li>JSON\uff1aJavaScript Object Notation</li> <li>JWT\uff1aJSON Web Token</li> <li>REST\uff1aRepresentational State Transfer</li> <li>SSL\uff1aSecure Sockets Layer</li> <li>TLS\uff1aTransport Layer Security</li> <li>UI\uff1aUser Interface\uff08\u4f7f\u7528\u8005\u4ecb\u9762\uff09</li> <li>URL\uff1aUniform Resource Locator\uff08\u7d71\u4e00\u8cc7\u6e90\u5b9a\u4f4d\u7b26\uff09</li> <li>WSGI\uff1aWeb Server Gateway Interface</li> </ul>"},{"location":"zh/resources/security/","title":"\u5b89\u5168\u6027","text":"<p>\u672c\u6587\u4ef6\u63d0\u4f9b aivonx_proxy \u61c9\u7528\u7a0b\u5f0f\u7684\u5168\u9762\u5b89\u5168\u6027\u6307\u5357\u548c\u914d\u7f6e\u9078\u9805\u3002\u5b83\u6db5\u84cb\u8a8d\u8b49\u3001\u6388\u6b0a\u3001\u74b0\u5883\u914d\u7f6e\u4ee5\u53ca\u751f\u7522\u90e8\u7f72\u7684\u6700\u4f73\u5be6\u8e10\u3002</p>"},{"location":"zh/resources/security/#_2","title":"\u76ee\u9304","text":"<ul> <li><code>\u5b89\u5168\u6027\u6982\u8ff0</code></li> <li><code>\u74b0\u5883\u914d\u7f6e</code></li> <li><code>\u8a8d\u8b49\u8207\u6388\u6b0a</code></li> <li><code>CORS \u8207 CSRF \u4fdd\u8b77</code></li> <li><code>\u8cc7\u6599\u5eab\u5b89\u5168\u6027</code></li> <li><code>\u5bc6\u78bc\u5b89\u5168\u6027</code></li> <li><code>\u751f\u7522\u5b89\u5168\u6027\u6aa2\u67e5\u6e05\u55ae</code></li> <li><code>\u5b89\u5168\u6027\u4e2d\u4ecb\u8edf\u9ad4</code></li> <li><code>API \u7aef\u9ede\u5b89\u5168\u6027</code></li> <li><code>\u65e5\u8a8c\u8207\u76e3\u63a7</code></li> <li><code>\u5bb9\u5668\u5b89\u5168\u6027</code></li> </ul>"},{"location":"zh/resources/security/#_3","title":"\u5b89\u5168\u6027\u6982\u8ff0","text":"<p>aivonx_proxy \u61c9\u7528\u7a0b\u5f0f\u5be6\u4f5c\u591a\u5c64\u5b89\u5168\u6027\u4f86\u4fdd\u8b77\u5e38\u898b\u6f0f\u6d1e\uff1a</p> <ul> <li>\u8a8d\u8b49\uff1a\u591a\u65b9\u6cd5\u8a8d\u8b49\uff0c\u5305\u62ec JWT\u3001Session \u548c Token \u8a8d\u8b49</li> <li>\u6388\u6b0a\uff1a\u57fa\u65bc\u89d2\u8272\u7684\u5b58\u53d6\u63a7\u5236\u8207\u6b0a\u9650\u985e\u5225</li> <li>CORS \u4fdd\u8b77\uff1a\u53ef\u914d\u7f6e\u7684\u8de8\u4f86\u6e90\u8cc7\u6e90\u5171\u4eab\u653f\u7b56</li> <li>CSRF \u4fdd\u8b77\uff1a\u91dd\u5c0d\u72c0\u614b\u8b8a\u66f4\u64cd\u4f5c\u7684\u8de8\u7ad9\u8acb\u6c42\u507d\u9020\u4fdd\u8b77</li> <li>\u5bc6\u78bc\u9a57\u8b49\uff1aDjango \u7684\u5168\u9762\u5bc6\u78bc\u9a57\u8b49\u6846\u67b6</li> <li>\u5b89\u5168\u9810\u8a2d\uff1a\u751f\u7522\u5b89\u5168\u7684\u9810\u8a2d\u503c\u8207\u660e\u78ba\u7684\u74b0\u5883\u914d\u7f6e</li> </ul>"},{"location":"zh/resources/security/#_4","title":"\u74b0\u5883\u914d\u7f6e","text":""},{"location":"zh/resources/security/#_5","title":"\u5fc5\u9700\u7684\u74b0\u5883\u8b8a\u6578\uff08\u751f\u7522\u74b0\u5883\uff09","text":"<p>\u4ee5\u4e0b\u74b0\u5883\u8b8a\u6578\u5fc5\u9808\u5728\u751f\u7522\u74b0\u5883\u4e2d\u914d\u7f6e\uff1a</p>"},{"location":"zh/resources/security/#django_secret_key","title":"<code>DJANGO_SECRET_KEY</code>","text":"<p>\u95dc\u9375\uff1aDjango \u79d8\u5bc6\u91d1\u9470\u7528\u65bc\u5bc6\u78bc\u5b78\u7c3d\u7f72\uff0c\u5fc5\u9808\u4fdd\u5bc6\u3002</p> <pre><code>DJANGO_SECRET_KEY=\"your-long-random-secret-key-here\"\n</code></pre> <p>\u8981\u6c42\uff1a - \u7576 <code>DJANGO_DEBUG=false</code> \u6642\u5fc5\u9808\u8a2d\u5b9a - \u61c9\u81f3\u5c11 50 \u500b\u5b57\u5143\u9577 - \u5fc5\u9808\u96a8\u6a5f\u4e14\u4e0d\u53ef\u9810\u6e2c - \u6c38\u9060\u4e0d\u8981\u63d0\u4ea4\u5230\u7248\u672c\u63a7\u5236 - \u5728\u751f\u7522\u4e2d\u5b9a\u671f\u8f2a\u63db</p> <p>\u751f\u6210\u7bc4\u4f8b\uff1a <pre><code>python -c 'from django.core.management.utils import get_random_secret_key; print(get_random_secret_key())'\n</code></pre></p>"},{"location":"zh/resources/security/#django_debug","title":"<code>DJANGO_DEBUG</code>","text":"<p>\u63a7\u5236 Django \u7684\u9664\u932f\u6a21\u5f0f\u3002\u5fc5\u9808\u5728\u751f\u7522\u4e2d\u505c\u7528\u3002</p> <pre><code>DJANGO_DEBUG=false\n</code></pre> <p>\u5b89\u5168\u6027\u5f71\u97ff\uff1a - \u7576 <code>true</code>\uff1a\u66b4\u9732\u8a73\u7d30\u7684\u932f\u8aa4\u8a0a\u606f\u3001\u8a2d\u5b9a\u548c\u5806\u758a\u8ffd\u8e64 - \u7576 <code>false</code>\uff1a\u986f\u793a\u901a\u7528\u932f\u8aa4\u9801\u9762\uff0c\u96b1\u85cf\u654f\u611f\u8cc7\u8a0a - \u7e3d\u662f\u5728\u751f\u7522\u4e2d\u8a2d\u5b9a\u70ba <code>false</code></p> <p>\u63a5\u53d7\u503c\uff1a<code>true</code>\u3001<code>false</code>\u3001<code>1</code>\u3001<code>0</code>\u3001<code>yes</code>\u3001<code>no</code>\uff08\u4e0d\u5340\u5206\u5927\u5c0f\u5beb\uff09</p>"},{"location":"zh/resources/security/#django_allowed_hosts","title":"<code>DJANGO_ALLOWED_HOSTS</code>","text":"<p>Django \u5c07\u670d\u52d9\u7684\u4ee5\u9017\u865f\u5206\u9694\u7684\u4e3b\u6a5f/\u57df\u540d\u5217\u8868\u3002</p> <pre><code>DJANGO_ALLOWED_HOSTS=\"yourdomain.com,www.yourdomain.com,api.yourdomain.com\"\n</code></pre> <p>\u8981\u6c42\uff1a - \u7576 <code>DJANGO_DEBUG=false</code> \u6642\u5fc5\u9700 - \u5fc5\u9808\u5305\u542b\u6240\u6709\u5c07\u5b58\u53d6\u60a8\u61c9\u7528\u7a0b\u5f0f\u7684\u57df\u540d - \u9632\u6b62 HTTP Host \u6a19\u982d\u653b\u64ca - \u50c5\u5728\u958b\u767c\u4e2d\u4f7f\u7528 <code>*</code>\uff08\u751f\u7522\u4e2d\u4e0d\u5b89\u5168\uff09</p> <p>\u7bc4\u4f8b\uff1a <pre><code># \u751f\u7522\nDJANGO_ALLOWED_HOSTS=\"example.com,www.example.com\"\n\n# \u958b\u767c\uff08\u975e\u751f\u7522\uff09\nDJANGO_ALLOWED_HOSTS=\"*\"\n\n# \u57fa\u65bc IP \u7684\u5b58\u53d6\nDJANGO_ALLOWED_HOSTS=\"192.168.1.100,10.0.0.50\"\n</code></pre></p>"},{"location":"zh/resources/security/#_6","title":"\u53ef\u9078\u7684\u5b89\u5168\u6027\u74b0\u5883\u8b8a\u6578","text":""},{"location":"zh/resources/security/#root_password","title":"<code>ROOT_PASSWORD</code>","text":"<p>\u521d\u59cb\u9077\u79fb\u671f\u9593\u5efa\u7acb\u7684\u6839\u7ba1\u7406\u4f7f\u7528\u8005\u7684\u9810\u8a2d\u5bc6\u78bc\u3002</p> <pre><code>ROOT_PASSWORD=\"your-secure-password\"\n</code></pre> <p>\u91cd\u8981\uff1a - \u9810\u8a2d\u503c\uff1a<code>changeme</code>\uff08\u4e0d\u5b89\u5168\uff09 - \u5fc5\u9808\u5728\u751f\u7522\u90e8\u7f72\u524d\u8b8a\u66f4 - \u6839\u4f7f\u7528\u8005\u81ea\u52d5\u5efa\u7acb\uff0c\u4f7f\u7528\u8005\u540d\u7a31\u70ba <code>root</code> - \u7528\u65bc\u7db2\u9801 UI \u548c API \u7684\u7ba1\u7406\u5b58\u53d6</p> <p>\u5b89\u5168\u6027\u6ce8\u610f\uff1a\u6b64\u5bc6\u78bc\u50c5\u5728\u521d\u59cb\u8cc7\u6599\u5eab\u9077\u79fb\u671f\u9593\u4f7f\u7528\u3002\u90e8\u7f72\u5f8c\uff0c\u7acb\u5373\u900f\u904e Django \u7ba1\u7406\u4ecb\u9762\u6216\u547d\u4ee4\u5217\u8b8a\u66f4\u5b83\u3002</p>"},{"location":"zh/resources/security/#_7","title":"\u8a8d\u8b49\u8207\u6388\u6b0a","text":""},{"location":"zh/resources/security/#_8","title":"\u8a8d\u8b49\u65b9\u6cd5","text":"<p>\u61c9\u7528\u7a0b\u5f0f\u652f\u63f4\u4e09\u7a2e\u8a8d\u8b49\u65b9\u6cd5\uff08\u5728 <code>../src/aivonx/settings.py#L187-L196</code> \u4e2d\u914d\u7f6e\uff09\uff1a</p>"},{"location":"zh/resources/security/#1-jwt","title":"1. JWT \u8a8d\u8b49\uff08\u4e3b\u8981\uff09","text":"<p>\u4f7f\u7528 <code>djangorestframework-simplejwt</code> \u7684 JSON Web Token \u8a8d\u8b49\u3002</p> <p>\u7aef\u9ede\uff1a<code>POST /api/account/login</code></p> <p>\u8acb\u6c42\uff1a <pre><code>{\n  \"username\": \"root\",\n  \"password\": \"your-password\"\n}\n</code></pre></p> <p>\u56de\u61c9\uff1a <pre><code>{\n  \"access\": \"eyJ0eXAiOiJKV1QiLCJhbGc...\",\n  \"refresh\": \"eyJ0eXAiOiJKV1QiLCJhbGc...\"\n}\n</code></pre></p> <p>\u4f7f\u7528\uff1a <pre><code># \u5728 Authorization \u6a19\u982d\u4e2d\u5305\u542b\u5b58\u53d6\u6b0a\u6756\nAuthorization: Bearer eyJ0eXAiOiJKV1QiLCJhbGc...\n</code></pre></p> <p>\u5b89\u5168\u6027\u529f\u80fd\uff1a - \u7121\u72c0\u614b\u8a8d\u8b49 - \u6709\u6642\u9593\u9650\u5236\u7684\u5b58\u53d6\u6b0a\u6756 - \u652f\u63f4\u91cd\u65b0\u6574\u7406\u6b0a\u6756\u8f2a\u63db - \u4e0d\u9700\u8981\u4f3a\u670d\u5668\u7aef\u6703\u8a71\u5132\u5b58</p>"},{"location":"zh/resources/security/#2-session","title":"2. Session \u8a8d\u8b49","text":"<p>\u4f7f\u7528 cookie \u7684\u50b3\u7d71 Django \u6703\u8a71\u5f0f\u8a8d\u8b49\u3002</p> <p>\u4f7f\u7528\u6848\u4f8b\uff1a\u900f\u904e\u767b\u5165\u8868\u55ae\u7684\u7db2\u9801 UI \u8a8d\u8b49</p> <p>\u767b\u5165 URL\uff1a<code>/ui/login</code>\uff08\u900f\u904e <code>../src/aivonx/settings.py#L176</code> \u4e2d\u7684 <code>LOGIN_URL</code> \u914d\u7f6e\uff09</p> <p>\u529f\u80fd\uff1a - \u555f\u7528 CSRF \u4fdd\u8b77 - \u6703\u8a71 cookie \u5b89\u5168\u6027 - \u900f\u904e Redis \u7684\u4f3a\u670d\u5668\u7aef\u6703\u8a71\u7ba1\u7406</p>"},{"location":"zh/resources/security/#3-token","title":"3. Token \u8a8d\u8b49","text":"<p>Django REST Framework token \u8a8d\u8b49\u3002</p> <p>\u4f7f\u7528\uff1a <pre><code>Authorization: Token 9944b09199c62bcf9418ad846dd0e4bbdfc6ee4b\n</code></pre></p>"},{"location":"zh/resources/security/#_9","title":"\u6388\u6b0a\u8207\u6b0a\u9650","text":""},{"location":"zh/resources/security/#_10","title":"\u9810\u8a2d\u6b0a\u9650\u653f\u7b56","text":"<p>\u5168\u57df\u8a2d\u5b9a\uff1a\u6240\u6709 API \u7aef\u9ede\u9810\u8a2d\u9700\u8981\u8a8d\u8b49\u3002</p> <pre><code>\"DEFAULT_PERMISSION_CLASSES\": (\n    \"rest_framework.permissions.IsAuthenticated\",\n)\n</code></pre>"},{"location":"zh/resources/security/#_11","title":"\u6b0a\u9650\u88dd\u98fe\u5668","text":"<p>\u500b\u5225\u7aef\u9ede\u53ef\u4ee5\u8986\u5beb\u9810\u8a2d\u653f\u7b56\uff1a</p> \u88dd\u98fe\u5668 \u884c\u70ba \u4f7f\u7528\u6848\u4f8b <code>@permission_classes([IsAuthenticated])</code> \u9700\u8981\u6709\u6548\u8a8d\u8b49 \u53d7\u4fdd\u8b77\u7aef\u9ede <code>@permission_classes([AllowAny])</code> \u4e0d\u9700\u8981\u8a8d\u8b49 \u516c\u958b\u7aef\u9ede <code>@login_required</code> \u9700\u8981\u6703\u8a71\u767b\u5165 \u7db2\u9801 UI \u6aa2\u8996"},{"location":"zh/resources/security/#_12","title":"\u7aef\u9ede\u6b0a\u9650\u5c0d\u61c9","text":"\u7aef\u9ede \u6b0a\u9650 \u7406\u7531 <code>POST /api/account/login</code> <code>AllowAny</code> \u516c\u958b\u767b\u5165\u7aef\u9ede <code>GET /api/proxy/state</code> <code>AllowAny</code> \u516c\u958b\u5065\u5eb7/\u8a3a\u65b7 <code>POST /api/proxy/generate</code> <code>AllowAny</code> \u516c\u958b\u4ee3\u7406\u7aef\u9ede\uff08\u53ef\u914d\u7f6e\uff09 <code>POST /api/proxy/chat</code> <code>AllowAny</code> \u516c\u958b\u4ee3\u7406\u7aef\u9ede\uff08\u53ef\u914d\u7f6e\uff09 <code>POST /api/proxy/embeddings</code> <code>AllowAny</code> \u516c\u958b\u4ee3\u7406\u7aef\u9ede\uff08\u53ef\u914d\u7f6e\uff09 <code>GET /api/tags</code> <code>AllowAny</code> \u516c\u958b\u6a21\u578b\u767c\u73fe <code>GET /api/config</code> <code>IsAuthenticated</code> \u53d7\u4fdd\u8b77\u914d\u7f6e\u5b58\u53d6 \u7db2\u9801 UI (<code>/ui/manage</code>) <code>@login_required</code> \u6703\u8a71\u5f0f\u8a8d\u8b49 \u7ba1\u7406\u9762\u677f (<code>/admin/</code>) \u50c5\u9650\u54e1\u5de5\u4f7f\u7528\u8005 Django \u5167\u5efa\u7ba1\u7406 <p>\u5b89\u5168\u6027\u8003\u91cf\uff1a\u4ee3\u7406\u7aef\u9ede\uff08<code>/api/proxy/*</code>\uff09\u9810\u8a2d\u4f7f\u7528 <code>AllowAny</code> \u4ee5\u4fbf\u8207\u5916\u90e8\u5de5\u5177\u6574\u5408\u3002\u5c0d\u65bc\u9700\u8981\u5b58\u53d6\u63a7\u5236\u7684\u751f\u7522\u90e8\u7f72\uff0c\u8acb\u8003\u616e\uff1a 1. \u5be6\u4f5c API \u91d1\u9470\u8a8d\u8b49 2. \u4f7f\u7528\u53cd\u5411\u4ee3\u7406\uff08nginx\u3001Traefik\uff09\u9032\u884c IP \u767d\u540d\u55ae 3. \u5728\u79c1\u6709\u7db2\u8def/VPN \u4e2d\u90e8\u7f72</p>"},{"location":"zh/resources/security/#ui","title":"\u7db2\u9801 UI \u8a8d\u8b49","text":"<p>\u7db2\u9801\u5f0f\u7ba1\u7406\u4ecb\u9762\u9700\u8981\u6703\u8a71\u8a8d\u8b49\uff1a</p> <ul> <li>\u767b\u5165 URL\uff1a<code>/ui/login</code></li> <li>\u53d7\u4fdd\u8b77 URL\uff1a<code>/ui/manage</code></li> <li>\u767b\u51fa URL\uff1a<code>/logout</code></li> <li>\u88dd\u98fe\u5668\uff1a<code>@login_required</code> + <code>@csrf_protect</code></li> </ul> <p>\u529f\u80fd\uff1a - \u4f7f\u7528 Redis \u5f8c\u7aef\u7684\u6703\u8a71\u5f0f\u8a8d\u8b49 - \u5728\u6240\u6709 POST \u8acb\u6c42\u4e0a\u555f\u7528 CSRF \u4fdd\u8b77 - \u672a\u8a8d\u8b49\u4f7f\u7528\u8005\u81ea\u52d5\u91cd\u65b0\u5c0e\u5411\u81f3\u767b\u5165\u9801\u9762 - \u6210\u529f\u767b\u5165\u5f8c\u91cd\u65b0\u5c0e\u5411\u81f3\u7ba1\u7406\u9801\u9762</p>"},{"location":"zh/resources/security/#cors-csrf","title":"CORS \u8207 CSRF \u4fdd\u8b77","text":""},{"location":"zh/resources/security/#cors","title":"CORS\uff08\u8de8\u4f86\u6e90\u8cc7\u6e90\u5171\u4eab\uff09","text":""},{"location":"zh/resources/security/#django_cors_allowed_origins","title":"<code>DJANGO_CORS_ALLOWED_ORIGINS</code>","text":"<p>\u5141\u8a31\u9032\u884c\u8de8\u4f86\u6e90\u8acb\u6c42\u7684\u4f86\u6e90\u4ee5\u9017\u865f\u5206\u9694\u5217\u8868\u3002</p> <pre><code>DJANGO_CORS_ALLOWED_ORIGINS=\"https://example.com,https://app.example.com\"\n</code></pre> <p>\u914d\u7f6e\uff1a - \u5982\u679c\u7f3a\u5c11\u65b9\u6848\uff0c\u81ea\u52d5\u52a0\u4e0a <code>http://</code> - \u652f\u63f4 HTTP \u548c HTTPS \u4f86\u6e90 - \u9810\u8a2d\u70ba\u7a7a\uff08\u4e0d\u5141\u8a31\u4efb\u4f55\u4f86\u6e90\uff09 - \u5c0d\u65bc\u4e0d\u540c\u57df\u540d\u7684\u700f\u89bd\u5668\u5f0f\u5ba2\u6236\u7aef\u5fc5\u9700</p> <p>\u7bc4\u4f8b\uff1a <pre><code># \u591a\u500b\u4f86\u6e90\u8207\u660e\u78ba\u65b9\u6848\nDJANGO_CORS_ALLOWED_ORIGINS=\"https://example.com,https://api.example.com\"\n\n# \u5c07\u81ea\u52d5\u52a0\u4e0a http://\nDJANGO_CORS_ALLOWED_ORIGINS=\"localhost:3000,192.168.1.100:8080\"\n\n# \u591a\u500b\u524d\u7aef\u57df\u540d\u7684\u751f\u7522\nDJANGO_CORS_ALLOWED_ORIGINS=\"https://app.example.com,https://admin.example.com,https://mobile.example.com\"\n</code></pre></p>"},{"location":"zh/resources/security/#cors_1","title":"CORS \u8a2d\u5b9a","text":"<pre><code>CORS_ALLOW_CREDENTIALS = True  # \u5141\u8a31\u8de8\u4f86\u6e90\u8acb\u6c42\u4e2d\u7684 cookie\n</code></pre> <p>\u5b89\u5168\u6027\u6ce8\u610f\uff1a\u50c5\u5728\u60a8\u7684\u524d\u7aef\u9700\u8981\u50b3\u9001 cookie \u6216\u8a8d\u8b49\u6a19\u982d\u6642\u555f\u7528 <code>CORS_ALLOW_CREDENTIALS</code>\u3002\u7e3d\u662f\u8207\u9650\u5236\u6027\u7684 <code>DJANGO_CORS_ALLOWED_ORIGINS</code> \u5217\u8868\u914d\u5c0d\u3002</p>"},{"location":"zh/resources/security/#csrf","title":"CSRF\uff08\u8de8\u7ad9\u8acb\u6c42\u507d\u9020\uff09","text":""},{"location":"zh/resources/security/#django_csrf_trusted_origins","title":"<code>DJANGO_CSRF_TRUSTED_ORIGINS</code>","text":"<p>\u53d7\u4fe1\u4efb\u7684\u4f86\u6e90\u5217\u8868\uff0c\u7528\u65bc CSRF \u4fdd\u8b77\u8acb\u6c42\uff08\u7279\u5225\u662f POST\u3001PUT\u3001DELETE\uff09\u3002</p> <pre><code>DJANGO_CSRF_TRUSTED_ORIGINS=\"https://example.com,https://admin.example.com\"\n</code></pre> <p>\u8981\u6c42\uff1a - \u5fc5\u9808\u5305\u542b\u65b9\u6848\uff08<code>http://</code> \u6216 <code>https://</code>\uff09 - \u5c0d\u65bc\u4efb\u4f55\u9032\u884c POST/PUT/DELETE \u8acb\u6c42\u7684\u57df\u540d\u5fc5\u9700 - \u5982\u679c\u7f3a\u5c11\u65b9\u6848\uff0c\u81ea\u52d5\u52a0\u4e0a <code>http://</code> - \u5fc5\u9808\u5339\u914d\u4f7f\u7528\u8005\u5c07\u5b58\u53d6\u7684\u57df\u540d</p> <p>\u7bc4\u4f8b\uff1a <pre><code># HTTPS \u751f\u7522\u90e8\u7f72\nDJANGO_CSRF_TRUSTED_ORIGINS=\"https://example.com,https://www.example.com\"\n\n# \u958b\u767c\u74b0\u5883\nDJANGO_CSRF_TRUSTED_ORIGINS=\"http://localhost:8000,http://127.0.0.1:8000\"\n\n# \u6df7\u5408\u74b0\u5883\uff08\u4e0d\u63a8\u85a6\uff09\nDJANGO_CSRF_TRUSTED_ORIGINS=\"http://localhost:8000,https://production.example.com\"\n</code></pre></p>"},{"location":"zh/resources/security/#csrf_1","title":"CSRF \u4e2d\u4ecb\u8edf\u9ad4","text":"<p>CSRF \u4fdd\u8b77\u900f\u904e Django \u7684 <code>CsrfViewMiddleware</code> \u5f37\u5236\u57f7\u884c\uff1a</p> <pre><code>MIDDLEWARE = [\n    ...\n    'django.middleware.csrf.CsrfViewMiddleware',\n    ...\n]\n</code></pre> <p>\u53d7\u4fdd\u8b77\u6aa2\u8996\uff1a\u6240\u6709\u5e36\u6709 <code>@csrf_protect</code> \u88dd\u98fe\u5668\u7684\u7db2\u9801 UI \u6aa2\u8996\u5728 POST \u8acb\u6c42\u4e2d\u9700\u8981\u6709\u6548\u7684 CSRF \u6b0a\u6756\u3002</p>"},{"location":"zh/resources/security/#_13","title":"\u8cc7\u6599\u5eab\u5b89\u5168\u6027","text":""},{"location":"zh/resources/security/#postgresql","title":"PostgreSQL \u914d\u7f6e","text":"<p>\u61c9\u7528\u7a0b\u5f0f\u4f7f\u7528 PostgreSQL \u4f5c\u70ba\u4e3b\u8981\u8cc7\u6599\u5eab\u3002\u6191\u8b49\u900f\u904e\u74b0\u5883\u8b8a\u6578\u914d\u7f6e\uff1a</p> <pre><code>POSTGRES_USER=\"user\"\nPOSTGRES_PASSWORD=\"secure-password-here\"\nPOSTGRES_DB=\"app_db\"\nPOSTGRES_HOST=\"postgres\"\nPOSTGRES_PORT=\"5432\"\n</code></pre> <p>\u5b89\u5168\u6027\u5efa\u8b70\uff1a 1. \u4f7f\u7528\u5f37\u5bc6\u78bc\uff1a\u81f3\u5c11 16 \u500b\u5b57\u5143\uff0c\u5305\u542b\u5927\u5c0f\u5beb\u3001\u6578\u5b57\u548c\u7b26\u865f 2. \u9650\u5236\u7db2\u8def\u5b58\u53d6\uff1a\u914d\u7f6e <code>pg_hba.conf</code> \u4ee5\u9650\u5236\u9023\u7dda 3. \u4f7f\u7528 SSL/TLS\uff1a\u5728\u751f\u7522\u4e2d\u555f\u7528 SSL \u9023\u7dda 4. \u5b9a\u671f\u5099\u4efd\uff1a\u5be6\u4f5c\u81ea\u52d5\u5316\u5099\u4efd\u7a0b\u5e8f 5. \u6700\u5c0f\u6b0a\u9650\uff1a\u5efa\u7acb\u61c9\u7528\u7a0b\u5f0f\u7279\u5b9a\u7684\u8cc7\u6599\u5eab\u4f7f\u7528\u8005\uff0c\u5177\u6709\u6700\u5c0f\u6b0a\u9650</p>"},{"location":"zh/resources/security/#redis","title":"Redis \u914d\u7f6e","text":"<p>Redis \u7528\u65bc\u5feb\u53d6\u548c\u6703\u8a71\u5132\u5b58\uff1a</p> <pre><code>REDIS_URL=\"redis://redis:6379/1\"\n</code></pre> <p>\u5b89\u5168\u6027\u5efa\u8b70\uff1a 1. \u555f\u7528\u8a8d\u8b49\uff1a\u5728 redis.conf \u4e2d\u8a2d\u5b9a <code>requirepass</code> 2. \u7d81\u5b9a\u5230 localhost\uff1a\u9664\u975e\u5fc5\u9700\uff0c\u5426\u5247\u9632\u6b62\u5916\u90e8\u5b58\u53d6 3. \u4f7f\u7528\u55ae\u7368\u8cc7\u6599\u5eab\uff1a\u9694\u96e2\u5feb\u53d6\u548c\u6703\u8a71\u8cc7\u6599 4. \u505c\u7528\u5371\u96aa\u547d\u4ee4\uff1a\u5c0d FLUSHDB\u3001FLUSHALL \u7b49\u4f7f\u7528 <code>rename-command</code></p>"},{"location":"zh/resources/security/#_14","title":"\u9023\u7dda\u5b89\u5168\u6027","text":"<pre><code>DATABASES = {\n    'default': {\n        'ENGINE': 'django.db.backends.postgresql',\n        'NAME': os.getenv(\"POSTGRES_DB\", \"app_db\"),\n        'USER': os.getenv(\"POSTGRES_USER\", \"user\"),\n        'PASSWORD': os.getenv(\"POSTGRES_PASSWORD\", \"password\"),\n        'HOST': os.getenv(\"POSTGRES_HOST\", \"postgres\"),\n        'PORT': os.getenv(\"POSTGRES_PORT\", \"5432\"),\n    }\n}\n</code></pre> <p>\u751f\u7522\u5f37\u5316\uff1a - \u555f\u7528 SSL\uff1a\u5c07 <code>'OPTIONS': {'sslmode': 'require'}</code> \u65b0\u589e\u5230\u8cc7\u6599\u5eab\u914d\u7f6e - \u4f7f\u7528\u9023\u7dda\u6c60 - \u8a2d\u5b9a\u9069\u7576\u7684\u9023\u7dda\u903e\u6642 - \u76e3\u63a7\u8cc7\u6599\u5eab\u65e5\u8a8c\u4ee5\u767c\u73fe\u53ef\u7591\u6d3b\u52d5</p>"},{"location":"zh/resources/security/#_15","title":"\u5bc6\u78bc\u5b89\u5168\u6027","text":""},{"location":"zh/resources/security/#_16","title":"\u5bc6\u78bc\u9a57\u8b49","text":"<p>Django \u900f\u904e\u9a57\u8b49\u5668\u5f37\u5236\u5f37\u5bc6\u78bc\u8981\u6c42\uff1a</p> <pre><code>AUTH_PASSWORD_VALIDATORS = [\n    {\n        'NAME': 'django.contrib.auth.password_validation.UserAttributeSimilarityValidator',\n        # \u9632\u6b62\u5bc6\u78bc\u985e\u4f3c\u4f7f\u7528\u8005\u5c6c\u6027\uff08\u4f7f\u7528\u8005\u540d\u7a31\u3001\u96fb\u5b50\u90f5\u4ef6\u7b49\uff09\n    },\n    {\n        'NAME': 'django.contrib.auth.password_validation.MinimumLengthValidator',\n        # \u9810\u8a2d\uff1a\u81f3\u5c11 8 \u500b\u5b57\u5143\n    },\n    {\n        'NAME': 'django.contrib.auth.password_validation.CommonPasswordValidator',\n        # \u9632\u6b62\u4f7f\u7528\u5e38\u898b\u5bc6\u78bc\uff08\u524d 20,000 \u500b\u6700\u5e38\u898b\uff09\n    },\n    {\n        'NAME': 'django.contrib.auth.password_validation.NumericPasswordValidator',\n        # \u9632\u6b62\u5b8c\u5168\u6578\u503c\u7684\u5bc6\u78bc\n    },\n]\n</code></pre> <p>\u5f37\u5236\u8981\u6c42\uff1a - \u2713 \u81f3\u5c11 8 \u500b\u5b57\u5143\uff08\u53ef\u914d\u7f6e\uff09 - \u2713 \u4e0d\u80fd\u5b8c\u5168\u6578\u503c - \u2713 \u4e0d\u80fd\u592a\u985e\u4f3c\u4f7f\u7528\u8005\u540d\u7a31\u6216\u96fb\u5b50\u90f5\u4ef6 - \u2713 \u4e0d\u80fd\u662f\u5e38\u7528\u5bc6\u78bc - \u2713 \u5728\u4f7f\u7528\u8005\u5efa\u7acb\u548c\u5bc6\u78bc\u8b8a\u66f4\u6642\u9a57\u8b49</p>"},{"location":"zh/resources/security/#_17","title":"\u5bc6\u78bc\u96dc\u6e4a","text":"<p>Django \u4f7f\u7528 PBKDF2 \u6f14\u7b97\u6cd5\u8207 SHA256 \u96dc\u6e4a\u9032\u884c\u5bc6\u78bc\u5132\u5b58\uff1a</p> <ul> <li>\u6f14\u7b97\u6cd5\uff1aPBKDF2-HMAC-SHA256</li> <li>\u8fed\u4ee3\uff1a870,000\uff08Django 5.2 \u9810\u8a2d\uff0c\u6bcf\u500b\u7248\u672c\u589e\u52a0\uff09</li> <li>\u81ea\u52d5\u5347\u7d1a\uff1a\u5982\u679c\u8fed\u4ee3\u8a08\u6578\u589e\u52a0\uff0c\u5bc6\u78bc\u5728\u767b\u5165\u6642\u91cd\u65b0\u96dc\u6e4a</li> </ul> <p>\u5b89\u5168\u6027\u6ce8\u610f\uff1a\u5bc6\u78bc\u6c38\u9060\u4e0d\u6703\u4ee5\u660e\u6587\u5132\u5b58\u3002\u9077\u79fb <code>../src/account/migrations/0003_create_root.py</code> \u4f7f\u7528 <code>make_password()</code> \u5728\u5132\u5b58\u524d\u96dc\u6e4a\u6839\u5bc6\u78bc\u3002</p>"},{"location":"zh/resources/security/#_18","title":"\u751f\u7522\u5b89\u5168\u6027\u6aa2\u67e5\u6e05\u55ae","text":"<p>\u5728\u90e8\u7f72\u5230\u751f\u7522\u524d\u4f7f\u7528\u6b64\u6aa2\u67e5\u6e05\u55ae\uff1a</p>"},{"location":"zh/resources/security/#_19","title":"\u95dc\u9375\uff08\u5fc5\u9808\u6709\uff09","text":"<ul> <li>[ ] \u8a2d\u5b9a <code>DJANGO_DEBUG=false</code></li> <li>[ ] \u4f7f\u7528\u5f37\u96a8\u6a5f\u503c\uff0850+ \u5b57\u5143\uff09\u914d\u7f6e <code>DJANGO_SECRET_KEY</code></li> <li>[ ] \u5c07 <code>DJANGO_ALLOWED_HOSTS</code> \u8a2d\u5b9a\u70ba\u60a8\u7684\u5be6\u969b\u57df\u540d</li> <li>[ ] \u5f9e\u9810\u8a2d <code>changeme</code> \u8b8a\u66f4 <code>ROOT_PASSWORD</code></li> <li>[ ] \u70ba\u6240\u6709\u9023\u7dda\u555f\u7528 HTTPS/TLS</li> <li>[ ] \u4f7f\u7528\u60a8\u7684\u57df\u540d\uff08\u5305\u62ec <code>https://</code> \u65b9\u6848\uff09\u914d\u7f6e <code>DJANGO_CSRF_TRUSTED_ORIGINS</code></li> <li>[ ] \u8a2d\u5b9a\u5f37 <code>POSTGRES_PASSWORD</code>\uff0816+ \u5b57\u5143\uff09</li> <li>[ ] \u6aa2\u8996\u4e26\u9650\u5236 <code>DJANGO_CORS_ALLOWED_ORIGINS</code></li> </ul>"},{"location":"zh/resources/security/#_20","title":"\u63a8\u85a6","text":"<ul> <li>[ ] \u555f\u7528\u8cc7\u6599\u5eab SSL \u9023\u7dda</li> <li>[ ] \u914d\u7f6e Redis \u8a8d\u8b49\uff08<code>requirepass</code>\uff09</li> <li>[ ] \u8a2d\u5b9a\u65e5\u8a8c\u76e3\u63a7\u548c\u8b66\u5831</li> <li>[ ] \u5728\u8a8d\u8b49\u7aef\u9ede\u4e0a\u5be6\u4f5c\u901f\u7387\u9650\u5236</li> <li>[ ] \u4f7f\u7528\u74b0\u5883\u7279\u5b9a\u7684 <code>.env</code> \u6a94\u6848\uff08\u6c38\u9060\u4e0d\u8981\u63d0\u4ea4\u5230 git\uff09</li> <li>[ ] \u555f\u7528 Redis \u6301\u4e45\u6027\u4ee5\u9032\u884c\u6703\u8a71\u8cc7\u6599</li> <li>[ ] \u914d\u7f6e\u9632\u706b\u7246\u898f\u5247\u4ee5\u9650\u5236\u8cc7\u6599\u5eab\u5b58\u53d6</li> <li>[ ] \u8a2d\u5b9a\u81ea\u52d5\u5316\u8cc7\u6599\u5eab\u5099\u4efd</li> <li>[ ] \u6aa2\u8996\u6240\u6709 <code>AllowAny</code> \u6b0a\u9650\u7aef\u9ede\u4e26\u8996\u9700\u8981\u9650\u5236</li> <li>[ ] \u70ba\u4ee3\u7406\u7aef\u9ede\u5be6\u4f5c API \u91d1\u9470\u8a8d\u8b49\uff08\u5982\u9700\u8981\uff09</li> </ul>"},{"location":"zh/resources/security/#_21","title":"\u5b89\u5168\u6027\u6a19\u982d\uff08\u63a8\u85a6\u65b0\u589e\uff09","text":"<p>\u8003\u616e\u65b0\u589e\u9019\u4e9b\u5b89\u5168\u6027\u4e2d\u4ecb\u8edf\u9ad4\u548c\u6a19\u982d\uff1a</p> <pre><code># settings.py \u65b0\u589e\u4ee5\u9032\u884c\u751f\u7522\n\n# \u5b89\u5168\u6027\u4e2d\u4ecb\u8edf\u9ad4\u8a2d\u5b9a\nSECURE_SSL_REDIRECT = True  # \u5c07 HTTP \u91cd\u65b0\u5c0e\u5411\u81f3 HTTPS\nSECURE_HSTS_SECONDS = 31536000  # 1 \u5e74\nSECURE_HSTS_INCLUDE_SUBDOMAINS = True\nSECURE_HSTS_PRELOAD = True\nSECURE_CONTENT_TYPE_NOSNIFF = True\nSECURE_BROWSER_XSS_FILTER = True\nX_FRAME_OPTIONS = 'DENY'  # \u9632\u6b62\u9ede\u64ca\u52ab\u6301\nSESSION_COOKIE_SECURE = True  # HTTPS \u50c5 cookie\nCSRF_COOKIE_SECURE = True  # HTTPS \u50c5 CSRF cookie\nSESSION_COOKIE_HTTPONLY = True  # \u9632\u6b62 JavaScript \u5b58\u53d6\u6703\u8a71 cookie\nCSRF_COOKIE_HTTPONLY = True\n</code></pre> <p>\u6ce8\u610f\uff1a\u9019\u4e9b\u8a2d\u5b9a\u9810\u8a2d\u672a\u555f\u7528\uff0c\u4f46\u5f37\u70c8\u63a8\u85a6\u7528\u65bc HTTPS \u751f\u7522\u90e8\u7f72\u3002</p>"},{"location":"zh/resources/security/#_22","title":"\u5b89\u5168\u6027\u4e2d\u4ecb\u8edf\u9ad4","text":"<p>\u61c9\u7528\u7a0b\u5f0f\u4f7f\u7528 Django \u7684\u5b89\u5168\u6027\u4e2d\u4ecb\u8edf\u9ad4\u5806\u758a\uff08\u5728 <code>../src/aivonx/settings.py#L68-L77</code> \u4e2d\u914d\u7f6e\uff09\uff1a</p> <pre><code>MIDDLEWARE = [\n    'django.middleware.security.SecurityMiddleware',  # \u5b89\u5168\u6027\u6a19\u982d\n    'django.contrib.sessions.middleware.SessionMiddleware',  # \u6703\u8a71\u7ba1\u7406\n    'django.middleware.common.CommonMiddleware',  # \u901a\u7528\u5de5\u5177\n    'django.middleware.csrf.CsrfViewMiddleware',  # CSRF \u4fdd\u8b77\n    'django.contrib.auth.middleware.AuthenticationMiddleware',  # \u8a8d\u8b49\n    'django.contrib.messages.middleware.MessageMiddleware',  # \u5feb\u9583\u8a0a\u606f\n    'django.middleware.clickjacking.XFrameOptionsMiddleware',  # \u9ede\u64ca\u52ab\u6301\u4fdd\u8b77\n    'corsheaders.middleware.CorsMiddleware',  # CORS \u8655\u7406\n    'whitenoise.middleware.WhiteNoiseMiddleware',  # \u975c\u614b\u6a94\u6848\u670d\u52d9\n]\n</code></pre>"},{"location":"zh/resources/security/#_23","title":"\u4e2d\u4ecb\u8edf\u9ad4\u529f\u80fd","text":"\u4e2d\u4ecb\u8edf\u9ad4 \u529f\u80fd \u5b89\u5168\u6027\u76ca\u8655 <code>SecurityMiddleware</code> \u65b0\u589e\u5b89\u5168\u6027\u6a19\u982d HSTS\u3001SSL \u91cd\u65b0\u5c0e\u5411\u3001\u5167\u5bb9\u985e\u578b\u55c5\u63a2\u4fdd\u8b77 <code>SessionMiddleware</code> \u7ba1\u7406\u4f7f\u7528\u8005\u6703\u8a71 \u900f\u904e Redis \u7684\u5b89\u5168\u6703\u8a71\u8655\u7406 <code>CsrfViewMiddleware</code> CSRF \u6b0a\u6756\u9a57\u8b49 \u9632\u6b62 CSRF \u653b\u64ca\u65bc\u72c0\u614b\u8b8a\u66f4\u64cd\u4f5c <code>AuthenticationMiddleware</code> \u4f7f\u7528\u8005\u8a8d\u8b49 \u5c07\u8a8d\u8b49\u4f7f\u7528\u8005\u9644\u52a0\u5230\u8acb\u6c42 <code>XFrameOptionsMiddleware</code> X-Frame-Options \u6a19\u982d \u9632\u6b62\u9ede\u64ca\u52ab\u6301\u653b\u64ca <code>CorsMiddleware</code> CORS \u653f\u7b56\u5f37\u5236 \u63a7\u5236\u8de8\u4f86\u6e90\u8cc7\u6e90\u5b58\u53d6"},{"location":"zh/resources/security/#api","title":"API \u7aef\u9ede\u5b89\u5168\u6027","text":""},{"location":"zh/resources/security/#_24","title":"\u516c\u958b\u7aef\u9ede\uff08\u4e0d\u9700\u8981\u8a8d\u8b49\uff09","text":"<p>\u9019\u4e9b\u7aef\u9ede\u4f7f\u7528 <code>@permission_classes([AllowAny])</code>\uff1a</p> \u7aef\u9ede \u65b9\u6cd5 \u76ee\u7684 \u5b89\u5168\u6027\u6ce8\u610f <code>/api/account/login</code> POST \u4f7f\u7528\u8005\u8a8d\u8b49 \u8a2d\u8a08\u70ba\u516c\u958b\uff08\u767b\u5165\u7aef\u9ede\uff09 <code>/api/proxy/state</code> GET \u5065\u5eb7\u6aa2\u67e5 \u8a3a\u65b7\u7aef\u9ede\uff0c\u6700\u5c0f\u8cc7\u8a0a\u66b4\u9732 <code>/api/proxy/generate</code> POST Ollama \u4ee3\u7406 \u8003\u616e\u5728\u751f\u7522\u4e2d\u9650\u5236 <code>/api/proxy/chat</code> POST Ollama \u4ee3\u7406 \u8003\u616e\u5728\u751f\u7522\u4e2d\u9650\u5236 <code>/api/proxy/embeddings</code> POST Ollama \u4ee3\u7406 \u8003\u616e\u5728\u751f\u7522\u4e2d\u9650\u5236 <code>/api/proxy/embed</code> POST Ollama \u4ee3\u7406 \u8003\u616e\u5728\u751f\u7522\u4e2d\u9650\u5236 <code>/api/tags</code> GET \u6a21\u578b\u5217\u8868 \u516c\u958b\u6a21\u578b\u767c\u73fe <code>/health</code> GET \u61c9\u7528\u7a0b\u5f0f\u5065\u5eb7 \u57fa\u672c\u5065\u5eb7\u6aa2\u67e5"},{"location":"zh/resources/security/#_25","title":"\u53d7\u4fdd\u8b77\u7aef\u9ede\uff08\u9700\u8981\u8a8d\u8b49\uff09","text":"<p>\u9019\u4e9b\u7aef\u9ede\u9700\u8981\u6709\u6548\u8a8d\u8b49\uff08JWT\u3001Session \u6216 Token\uff09\uff1a</p> \u7aef\u9ede \u65b9\u6cd5 \u6b0a\u9650 \u76ee\u7684 <code>/api/config</code> GET <code>IsAuthenticated</code> \u914d\u7f6e\u64f7\u53d6 <code>/api/proxy/nodes</code> GET/POST/PUT/DELETE \u9810\u8a2d\uff08<code>IsAuthenticated</code>\uff09 \u7bc0\u9ede\u7ba1\u7406 <code>/ui/manage</code> GET/POST <code>@login_required</code> \u7db2\u9801 UI \u7ba1\u7406\u4ecb\u9762 <code>/admin/*</code> ALL \u54e1\u5de5\u4f7f\u7528\u8005 Django \u7ba1\u7406\u9762\u677f"},{"location":"zh/resources/security/#_26","title":"\u4ee3\u7406\u7aef\u9ede\u7684\u5b89\u5168\u6027\u5efa\u8b70","text":"<p>\u4ee3\u7406\u7aef\u9ede\uff08<code>/api/proxy/*</code>\uff09\u9810\u8a2d\u70ba\u516c\u958b\u4ee5\u4fbf\u8207 Ollama \u76f8\u5bb9\u5de5\u5177\u6574\u5408\u3002\u5c0d\u65bc\u9700\u8981\u5b58\u53d6\u63a7\u5236\u7684\u751f\u7522\u90e8\u7f72\uff1a</p>"},{"location":"zh/resources/security/#1","title":"\u9078\u9805 1\uff1a\u53cd\u5411\u4ee3\u7406\u8a8d\u8b49","text":"<p>\u4f7f\u7528 nginx \u6216 Traefik \u65b0\u589e\u8a8d\u8b49\uff1a</p> <pre><code>location /api/proxy/ {\n    auth_basic \"Restricted Access\";\n    auth_basic_user_file /etc/nginx/.htpasswd;\n    proxy_pass http://django:8000;\n}\n</code></pre>"},{"location":"zh/resources/security/#2ip","title":"\u9078\u9805 2\uff1aIP \u767d\u540d\u55ae","text":"<p>\u9650\u5236\u5b58\u53d6\u5df2\u77e5 IP \u4f4d\u5740\uff1a</p> <pre><code>location /api/proxy/ {\n    allow 192.168.1.0/24;\n    allow 10.0.0.0/8;\n    deny all;\n    proxy_pass http://django:8000;\n}\n</code></pre>"},{"location":"zh/resources/security/#3vpn","title":"\u9078\u9805 3\uff1aVPN/\u79c1\u6709\u7db2\u8def","text":"<p>\u5728\u50c5\u900f\u904e VPN \u5b58\u53d6\u7684\u79c1\u6709\u7db2\u8def\u4e2d\u90e8\u7f72\u3002</p>"},{"location":"zh/resources/security/#4","title":"\u9078\u9805 4\uff1a\u81ea\u8a02\u8a8d\u8b49","text":"<p>\u4fee\u6539\u7a0b\u5f0f\u78bc\u4ee5\u9700\u8981\u8a8d\u8b49\uff1a</p> <pre><code># \u5728 views_proxy.py \u4e2d\uff0c\u8b8a\u66f4\uff1a\n@permission_classes([AllowAny])\n# \u70ba\uff1a\n@permission_classes([IsAuthenticated])\n</code></pre>"},{"location":"zh/resources/security/#_27","title":"\u65e5\u8a8c\u8207\u76e3\u63a7","text":""},{"location":"zh/resources/security/#_28","title":"\u5b89\u5168\u6027\u76f8\u95dc\u65e5\u8a8c","text":"<p>\u61c9\u7528\u7a0b\u5f0f\u5be6\u4f5c\u5168\u9762\u65e5\u8a8c\uff08\u5728 <code>../src/aivonx/settings.py#L214-L326</code> \u4e2d\u914d\u7f6e\uff09\uff1a</p>"},{"location":"zh/resources/security/#_29","title":"\u65e5\u8a8c\u6a94\u6848","text":"\u65e5\u8a8c\u6a94\u6848 \u76ee\u7684 \u5167\u5bb9 <code>logs/django.json</code> \u4e00\u822c\u61c9\u7528\u7a0b\u5f0f\u65e5\u8a8c INFO \u7d1a\u5225\uff0c\u6240\u6709 Django \u64cd\u4f5c <code>logs/django_error.log</code> \u932f\u8aa4\u65e5\u8a8c ERROR \u7d1a\u5225\uff0c\u4f8b\u5916\u548c\u932f\u8aa4 <code>logs/proxy.json</code> \u4ee3\u7406\u64cd\u4f5c\u65e5\u8a8c \u4ee3\u7406\u8acb\u6c42\u3001\u7bc0\u9ede\u9078\u64c7\u3001\u932f\u8aa4"},{"location":"zh/resources/security/#_30","title":"\u8a18\u9304\u7684\u5b89\u5168\u6027\u4e8b\u4ef6","text":"<ul> <li>\u8a8d\u8b49\u5617\u8a66\uff08\u6210\u529f/\u5931\u6557\uff09</li> <li>\u6388\u6b0a\u5931\u6557</li> <li>\u8acb\u6c42\u932f\u8aa4\uff08400\u3001401\u3001403\u3001404\u3001500 \u7cfb\u5217\uff09</li> <li>\u8cc7\u6599\u5eab\u9023\u7dda\u554f\u984c</li> <li>\u4ee3\u7406\u7bc0\u9ede\u5931\u6557</li> </ul>"},{"location":"zh/resources/security/#_31","title":"\u65e5\u8a8c\u683c\u5f0f","text":"<ul> <li>JSON \u683c\u5f0f\uff1a\u7d50\u69cb\u5316\u65e5\u8a8c\uff0c\u4fbf\u65bc\u89e3\u6790\u548c\u5206\u6790</li> <li>\u8a73\u7d30\u683c\u5f0f\uff1a\u8a73\u7d30\u65e5\u8a8c\uff0c\u5177\u6709\u6a21\u7d44\u3001\u8655\u7406\u5e8f\u3001\u57f7\u884c\u7dd2\u8cc7\u8a0a</li> <li>\u8f2a\u63db\uff1a\u6bcf\u500b\u6a94\u6848 10MB\uff0c\u4fdd\u7559 3 \u500b\u5099\u4efd</li> </ul>"},{"location":"zh/resources/security/#_32","title":"\u76e3\u63a7\u5efa\u8b70","text":"<ol> <li>\u76e3\u63a7\u5931\u6557\u8a8d\u8b49\u5617\u8a66\uff1a\u5075\u6e2c\u66b4\u529b\u653b\u64ca</li> <li>\u8ffd\u8e64\u932f\u8aa4\u7387\uff1a\u8b58\u5225\u6f5b\u5728\u653b\u64ca\u6216\u7cfb\u7d71\u554f\u984c</li> <li>\u76e3\u63a7\u4ee3\u7406\u7aef\u9ede\u4f7f\u7528\uff1a\u5075\u6e2c\u6feb\u7528\u6216\u7570\u5e38\u6a21\u5f0f</li> <li>\u8cc7\u6599\u5eab\u9023\u7dda\u76e3\u63a7\uff1a\u5075\u6e2c\u6f5b\u5728\u8cc7\u6599\u5eab\u653b\u64ca</li> <li>\u65e5\u8a8c\u805a\u5408\uff1a\u4f7f\u7528 ELK \u5806\u758a\u3001Splunk \u6216\u985e\u4f3c\u9032\u884c\u96c6\u4e2d\u5f0f\u65e5\u8a8c</li> </ol>"},{"location":"zh/resources/security/#_33","title":"\u7bc4\u4f8b\uff1a\u76e3\u63a7\u5931\u6557\u767b\u5165","text":"<pre><code># \u89e3\u6790 JSON \u65e5\u8a8c\u4ee5\u5c0b\u627e\u5931\u6557\u767b\u5165\u5617\u8a66\ncat logs/django.json | jq 'select(.message | contains(\"Invalid credentials\"))'\n\n# \u8a08\u7b97\u904e\u53bb\u4e00\u5c0f\u6642\u7684\u5931\u6557\u767b\u5165\u5617\u8a66\u6578\ncat logs/django.json | \\\n  jq -r 'select(.message | contains(\"Invalid credentials\")) | .asctime' | \\\n  awk -v now=\"$(date +%s)\" '{ ... }' | wc -l\n</code></pre>"},{"location":"zh/resources/security/#_34","title":"\u5bb9\u5668\u5b89\u5168\u6027","text":""},{"location":"zh/resources/security/#docker","title":"Docker \u914d\u7f6e","text":"<p>\u61c9\u7528\u7a0b\u5f0f\u5728\u5177\u6709\u5b89\u5168\u6027\u914d\u7f6e\u7684 Docker \u5bb9\u5668\u4e2d\u57f7\u884c\uff1a</p>"},{"location":"zh/resources/security/#docker-composeymll1-l8","title":"\u5bb9\u5668\u8a2d\u5b9a\uff08<code>../docker-compose.yml#L1-L8</code>\uff09","text":"<pre><code>x-default-opts: &amp;default-opts\n  restart: unless-stopped\n  tty: true\n  stdin_open: true\n  privileged: false  # \u6c38\u9060\u4e0d\u8981\u4ee5\u63d0\u5347\u6b0a\u9650\u57f7\u884c\n  ipc: private  # \u9694\u96e2 IPC \u547d\u540d\u7a7a\u9593\n</code></pre> <p>\u5b89\u5168\u6027\u529f\u80fd\uff1a - \u2713 <code>privileged: false</code> - \u9632\u6b62\u5bb9\u5668\u7372\u5f97\u6839\u7b49\u6548\u4e3b\u6a5f\u5b58\u53d6 - \u2713 <code>ipc: private</code> - \u9694\u96e2\u8655\u7406\u5e8f\u9593\u901a\u8a0a - \u2713 \u975e\u6839\u4f7f\u7528\u8005\u4e0a\u4e0b\u6587\uff08\u63a8\u85a6\u65b0\u589e\uff0c\u8acb\u53c3\u898b\u4e0b\u65b9\uff09 - \u2713 \u6240\u6709\u670d\u52d9\u7684\u5065\u5eb7\u6aa2\u67e5 - \u2713 \u9694\u96e2\u6a4b\u63a5\u7db2\u8def</p>"},{"location":"zh/resources/security/#_35","title":"\u5bb9\u5668\u5f37\u5316\u5efa\u8b70","text":""},{"location":"zh/resources/security/#1_1","title":"1. \u4ee5\u975e\u6839\u4f7f\u7528\u8005\u57f7\u884c","text":"<p>\u65b0\u589e\u5230 Dockerfile\uff1a</p> <pre><code>RUN useradd -m -u 1000 appuser\nUSER appuser\n</code></pre>"},{"location":"zh/resources/security/#2","title":"2. \u552f\u8b80\u6a94\u6848\u7cfb\u7d71","text":"<pre><code>services:\n  django:\n    read_only: true\n    tmpfs:\n      - /tmp\n      - /app/logs\n</code></pre>"},{"location":"zh/resources/security/#3","title":"3. \u8cc7\u6e90\u9650\u5236","text":"<pre><code>services:\n  django:\n    deploy:\n      resources:\n        limits:\n          cpus: '2'\n          memory: 2G\n        reservations:\n          memory: 512M\n</code></pre>"},{"location":"zh/resources/security/#4_1","title":"4. \u7db2\u8def\u5206\u6bb5","text":"<pre><code>networks:\n  frontend:\n    driver: bridge\n  backend:\n    driver: bridge\n    internal: true  # \u7121\u7db2\u969b\u7db2\u8def\u5b58\u53d6\n\nservices:\n  django:\n    networks:\n      - frontend\n      - backend\n  postgres:\n    networks:\n      - backend  # \u8cc7\u6599\u5eab\u50c5\u5f9e\u5f8c\u7aef\u7db2\u8def\u5b58\u53d6\n</code></pre>"},{"location":"zh/resources/security/#5","title":"5. \u79d8\u5bc6\u7ba1\u7406","text":"<p>\u4f7f\u7528 Docker \u79d8\u5bc6\u800c\u975e\u74b0\u5883\u8b8a\u6578\u9032\u884c\u654f\u611f\u8cc7\u6599\uff1a</p> <pre><code>secrets:\n  db_password:\n    external: true\n  secret_key:\n    external: true\n\nservices:\n  django:\n    secrets:\n      - db_password\n      - secret_key\n</code></pre>"},{"location":"zh/resources/security/#_36","title":"\u6620\u50cf\u5b89\u5168\u6027","text":"<ul> <li>\u57fa\u790e\u6620\u50cf\uff1a<code>python:3.12-slim-bookworm</code>\uff08\u6700\u5c0f\u653b\u64ca\u9762\uff09</li> <li>\u5957\u4ef6\u66f4\u65b0\uff1a\u5b9a\u671f\u57fa\u790e\u6620\u50cf\u66f4\u65b0</li> <li>\u6f0f\u6d1e\u6383\u63cf\uff1a\u5b9a\u671f\u57f7\u884c <code>docker scan</code> \u6216 Trivy</li> </ul> <pre><code># \u6383\u63cf\u6f0f\u6d1e\ndocker scan aivonx_proxy:latest\n\n# \u6216\u4f7f\u7528 Trivy\ntrivy image aivonx_proxy:latest\n</code></pre>"},{"location":"zh/resources/security/#_37","title":"\u984d\u5916\u5b89\u5168\u6027\u8cc7\u6e90","text":""},{"location":"zh/resources/security/#django","title":"Django \u5b89\u5168\u6027\u6587\u4ef6","text":"<ul> <li>Django \u5b89\u5168\u6027\u6982\u8ff0</li> <li>Django \u90e8\u7f72\u6aa2\u67e5\u6e05\u55ae</li> <li>Django \u8a8d\u8b49\u7cfb\u7d71</li> </ul>"},{"location":"zh/resources/security/#owasp","title":"OWASP \u8cc7\u6e90","text":"<ul> <li>OWASP Top 10</li> <li>OWASP REST \u5b89\u5168\u6027\u901f\u67e5\u8868</li> <li>OWASP Docker \u5b89\u5168\u6027\u901f\u67e5\u8868</li> </ul>"},{"location":"zh/resources/security/#_38","title":"\u5b89\u5168\u6027\u6e2c\u8a66\u5de5\u5177","text":"<ul> <li>OWASP ZAP\uff1a\u81ea\u52d5\u5316\u5b89\u5168\u6027\u6e2c\u8a66</li> <li>Bandit\uff1aPython \u5b89\u5168\u6027 linter</li> <li>Safety\uff1aPython \u4f9d\u8cf4\u6f0f\u6d1e\u6383\u63cf\u5668</li> <li>Trivy\uff1a\u5bb9\u5668\u6f0f\u6d1e\u6383\u63cf\u5668</li> </ul> <pre><code># \u57f7\u884c\u5b89\u5168\u6027\u6aa2\u67e5\nbandit -r src/\nsafety check\ntrivy image your-image:tag\n</code></pre>"},{"location":"zh/resources/security/#_39","title":"\u5b89\u5168\u6027\u806f\u7d61","text":"<p>\u5982\u679c\u60a8\u767c\u73fe\u5b89\u5168\u6027\u6f0f\u6d1e\uff0c\u8acb\uff1a</p> <ol> <li>\u4e0d\u8981\u958b\u555f\u516c\u958b\u554f\u984c</li> <li>\u76f4\u63a5\u96fb\u5b50\u90f5\u4ef6\u7dad\u8b77\u8005\uff08\u8acb\u53c3\u898b <code>../../README.md</code>\uff09</li> <li>\u5305\u542b\u91cd\u73fe\u7684\u8a73\u7d30\u6b65\u9a5f</li> <li>\u5728\u516c\u958b\u62ab\u9732\u524d\u5141\u8a31\u5408\u7406\u6642\u9593\u4fee\u5fa9</li> </ol>"},{"location":"zh/resources/troubleshooting/","title":"\u6545\u969c\u6392\u9664","text":"<p>Aivonx Proxy \u7684\u5e38\u898b\u554f\u984c\u548c\u89e3\u6c7a\u65b9\u6848\u3002</p>"},{"location":"zh/resources/troubleshooting/#_2","title":"\u65e5\u8a8c\u8207\u8a3a\u65b7","text":""},{"location":"zh/resources/troubleshooting/#_3","title":"\u65e5\u8a8c\u6a94\u6848\u4f4d\u7f6e","text":"<ul> <li>\u4e00\u822c\u65e5\u8a8c\uff1a<code>logs/django.json</code>\uff08JSON \u683c\u5f0f\uff09</li> <li>\u4ee3\u7406\u65e5\u8a8c\uff1a<code>logs/proxy.json</code>\uff08JSON \u683c\u5f0f\uff09</li> <li>\u932f\u8aa4\u65e5\u8a8c\uff1a<code>logs/django_error.log</code>\uff08\u50c5 ERROR \u7d1a\u5225\uff09</li> <li>\u9664\u932f\u65e5\u8a8c\uff1a<code>logs/django_debug.log</code>\uff08DEBUG \u7d1a\u5225\uff0c\u5982\u679c\u555f\u7528\uff09</li> </ul>"},{"location":"zh/resources/troubleshooting/#_4","title":"\u6aa2\u8996\u65e5\u8a8c","text":"<pre><code># Tail \u4e00\u822c\u65e5\u8a8c\ntail -f logs/django.json | jq\n\n# Tail \u4ee3\u7406\u65e5\u8a8c\ntail -f logs/proxy.json | jq\n\n# \u6aa2\u8996\u932f\u8aa4\u65e5\u8a8c\ntail -f logs/django_error.log\n\n# Docker \u65e5\u8a8c\ndocker-compose logs -f django\n</code></pre>"},{"location":"zh/resources/troubleshooting/#_5","title":"\u5e38\u898b\u554f\u984c","text":""},{"location":"zh/resources/troubleshooting/#_6","title":"\u61c9\u7528\u7a0b\u5f0f\u7121\u6cd5\u555f\u52d5","text":""},{"location":"zh/resources/troubleshooting/#_7","title":"\u6aa2\u67e5\u8cc7\u6599\u5eab\u9023\u7dda","text":"<pre><code># \u9a57\u8b49 PostgreSQL \u6b63\u5728\u57f7\u884c\ndocker-compose ps postgres\n\n# \u6e2c\u8a66\u9023\u7dda\npsql -h localhost -U user -d app_db\n\n# \u6aa2\u67e5\u74b0\u5883\u8b8a\u6578\nenv | grep POSTGRES\n</code></pre> <p>\u89e3\u6c7a\u65b9\u6848\uff1a\u78ba\u4fdd PostgreSQL \u670d\u52d9\u6b63\u5728\u57f7\u884c\uff0c\u4e14 <code>.env</code> \u6216\u74b0\u5883\u8b8a\u6578\u4e2d\u7684\u6191\u8b49\u6b63\u78ba\u3002</p>"},{"location":"zh/resources/troubleshooting/#redis","title":"\u6aa2\u67e5 Redis \u9023\u7dda","text":"<pre><code># \u9a57\u8b49 Redis \u6b63\u5728\u57f7\u884c\ndocker-compose ps redis\n\n# \u6e2c\u8a66\u9023\u7dda\nredis-cli -h localhost ping\n\n# \u6aa2\u67e5\u74b0\u5883\u8b8a\u6578\necho $REDIS_URL\n</code></pre> <p>\u89e3\u6c7a\u65b9\u6848\uff1a\u78ba\u4fdd Redis \u670d\u52d9\u6b63\u5728\u57f7\u884c\uff0c\u4e14 <code>REDIS_URL</code> \u6b63\u78ba\u8a2d\u5b9a\u3002</p>"},{"location":"zh/resources/troubleshooting/#secret_key","title":"\u7f3a\u5c11 SECRET_KEY","text":"<p>\u932f\u8aa4\uff1a<code>ValueError: DJANGO_SECRET_KEY environment variable is required</code></p> <p>\u89e3\u6c7a\u65b9\u6848\uff1a\u5728\u60a8\u7684\u74b0\u5883\u4e2d\u8a2d\u5b9a <code>DJANGO_SECRET_KEY</code>\uff1a</p> <pre><code>export DJANGO_SECRET_KEY=\"your-secret-key-here\"\n# \u6216\u5728 .env \u6a94\u6848\u4e2d\necho \"DJANGO_SECRET_KEY=your-secret-key-here\" &gt;&gt; .env\n</code></pre>"},{"location":"zh/resources/troubleshooting/#_8","title":"\u7bc0\u9ede\u5065\u5eb7\u6aa2\u67e5\u5931\u6557","text":""},{"location":"zh/resources/troubleshooting/#_9","title":"\u75c7\u72c0","text":"<ul> <li>\u7bc0\u9ede\u5728 <code>/api/proxy/state</code> \u4e2d\u986f\u793a\u70ba\u975e\u6d3b\u8e8d</li> <li>\u8acb\u6c42\u8fd4\u56de\u300cno healthy nodes available\u300d</li> </ul>"},{"location":"zh/resources/troubleshooting/#_10","title":"\u8a3a\u65b7","text":"<pre><code># \u76f4\u63a5\u6aa2\u67e5\u7bc0\u9ede\u5065\u5eb7\ncurl http://node-address:11434/api/health\n\n# \u6aa2\u67e5\u4ee3\u7406\u72c0\u614b\ncurl http://localhost:8000/api/proxy/state\n\n# \u6aa2\u67e5\u6d3b\u8e8d\u8acb\u6c42\ncurl http://localhost:8000/api/proxy/active-requests\n</code></pre>"},{"location":"zh/resources/troubleshooting/#_11","title":"\u89e3\u6c7a\u65b9\u6848","text":"<ol> <li> <p>\u7db2\u8def\u9023\u7dda\uff1a\u78ba\u4fdd\u4ee3\u7406\u53ef\u4ee5\u5230\u9054\u7bc0\u9ede    <pre><code>ping node-address\ntelnet node-address 11434\n</code></pre></p> </li> <li> <p>\u9632\u706b\u7246\u898f\u5247\uff1a\u6aa2\u67e5\u9023\u63a5\u57e0 11434\uff08\u6216\u914d\u7f6e\u7684\u9023\u63a5\u57e0\uff09\u662f\u5426\u958b\u653e</p> </li> <li> <p>\u7bc0\u9ede\u5df2\u95dc\u9589\uff1a\u5728\u7bc0\u9ede\u4e0a\u91cd\u65b0\u555f\u52d5 Ollama \u670d\u52d9    <pre><code>systemctl restart ollama  # \u5728 Linux \u4e0a\n</code></pre></p> </li> <li> <p>\u5f37\u5236\u91cd\u65b0\u6574\u7406\uff1a\u5065\u5eb7\u6aa2\u67e5\u6bcf\u5206\u9418\u57f7\u884c\u4e00\u6b21\uff0c\u6216\u624b\u52d5\u89f8\u767c\uff1a    <pre><code>from proxy.utils.proxy_manager import get_global_manager\nmgr = get_global_manager()\nmgr.refresh_from_db()\n</code></pre></p> </li> </ol>"},{"location":"zh/resources/troubleshooting/#_12","title":"\u5feb\u53d6\u554f\u984c","text":""},{"location":"zh/resources/troubleshooting/#_13","title":"\u904e\u6642\u5feb\u53d6\u8cc7\u6599","text":"<p>\u75c7\u72c0\uff1a\u72c0\u614b\u7aef\u9ede\u986f\u793a\u904e\u6642\u8cc7\u8a0a</p> <p>\u89e3\u6c7a\u65b9\u6848\uff1a\u6e05\u9664 Redis \u5feb\u53d6</p> <pre><code># \u4f7f\u7528 Django shell\npython src/manage.py shell\n&gt;&gt;&gt; from django.core.cache import cache\n&gt;&gt;&gt; cache.clear()\n\n# \u6216\u76f4\u63a5\u4f7f\u7528 Redis\nredis-cli FLUSHDB\n</code></pre>"},{"location":"zh/resources/troubleshooting/#redis_1","title":"Redis \u9023\u7dda\u932f\u8aa4","text":"<p>\u932f\u8aa4\uff1a<code>ConnectionError: Error connecting to Redis</code></p> <p>\u89e3\u6c7a\u65b9\u6848\uff1a 1. \u9a57\u8b49 Redis \u6b63\u5728\u57f7\u884c 2. \u6aa2\u67e5 <code>REDIS_URL</code> \u683c\u5f0f\uff1a<code>redis://host:port/db</code> 3. \u6e2c\u8a66\u9023\u7dda\uff1a    <pre><code>redis-cli -u $REDIS_URL ping\n</code></pre></p>"},{"location":"zh/resources/troubleshooting/#_14","title":"\u4e32\u6d41\u554f\u984c","text":""},{"location":"zh/resources/troubleshooting/#_15","title":"\u4e32\u6d41\u56de\u61c9\u7121\u6cd5\u904b\u4f5c","text":"<p>\u75c7\u72c0\uff1a\u56de\u61c9\u5b8c\u5168\u7de9\u885d\u800c\u975e\u4e32\u6d41</p> <p>\u539f\u56e0\uff1a\u4f7f\u7528 WSGI \u4f3a\u670d\u5668\u800c\u975e ASGI</p> <p>\u89e3\u6c7a\u65b9\u6848\uff1a\u4f7f\u7528 uvicorn \u6216 gunicorn \u8207 uvicorn \u5de5\u4f5c\u8005\uff1a</p> <pre><code># \u958b\u767c\nuvicorn aivonx.asgi:application --reload\n\n# \u751f\u7522\ngunicorn aivonx.asgi:application -k uvicorn.workers.UvicornWorker --workers 4\n</code></pre>"},{"location":"zh/resources/troubleshooting/#_16","title":"\u975c\u614b\u6a94\u6848\u672a\u8f09\u5165","text":""},{"location":"zh/resources/troubleshooting/#_17","title":"\u958b\u767c","text":"<p>\u89e3\u6c7a\u65b9\u6848\uff1a\u78ba\u4fdd <code>DEBUG=True</code> \u6216\u57f7\u884c <code>collectstatic</code></p> <pre><code>python src/manage.py collectstatic --noinput\n</code></pre>"},{"location":"zh/resources/troubleshooting/#_18","title":"\u751f\u7522","text":"<p>\u89e3\u6c7a\u65b9\u6848\uff1a\u9a57\u8b49 WhiteNoise \u4e2d\u4ecb\u8edf\u9ad4\u5df2\u555f\u7528\u4e14\u975c\u614b\u6a94\u6848\u5df2\u6536\u96c6\uff1a</p> <pre><code>python src/manage.py collectstatic --noinput --clear\n</code></pre>"},{"location":"zh/resources/troubleshooting/#_19","title":"\u8cc7\u6599\u5eab\u9077\u79fb\u554f\u984c","text":""},{"location":"zh/resources/troubleshooting/#_20","title":"\u5047\u88dd\u9077\u79fb","text":"<p>\u5982\u679c\u9077\u79fb\u5df2\u624b\u52d5\u61c9\u7528\uff1a</p> <pre><code>python src/manage.py migrate --fake app_name migration_name\n</code></pre>"},{"location":"zh/resources/troubleshooting/#_21","title":"\u91cd\u8a2d\u9077\u79fb\uff08\u50c5\u958b\u767c\uff09","text":"<p>\u26a0\ufe0f \u8b66\u544a\uff1a\u9019\u5c07\u522a\u9664\u6240\u6709\u8cc7\u6599</p> <pre><code># \u522a\u9664\u8cc7\u6599\u5eab\ndropdb app_db\n\n# \u91cd\u65b0\u5efa\u7acb\ncreatedb app_db\n\n# \u57f7\u884c\u9077\u79fb\npython src/manage.py migrate\n</code></pre>"},{"location":"zh/resources/troubleshooting/#_22","title":"\u6b0a\u9650\u932f\u8aa4","text":""},{"location":"zh/resources/troubleshooting/#api-403-forbidden","title":"API \u7aef\u9ede\u4e0a\u7684 403 Forbidden","text":"<p>\u539f\u56e0\uff1a\u9700\u8981\u8a8d\u8b49\u4f46\u672a\u63d0\u4f9b</p> <p>\u89e3\u6c7a\u65b9\u6848\uff1a\u5305\u542b\u8a8d\u8b49\u6b0a\u6756\uff1a</p> <pre><code>curl -H \"Authorization: Bearer YOUR_JWT_TOKEN\" \\\n  http://localhost:8000/api/proxy/config\n</code></pre> <p>\u6216\u900f\u904e\u7db2\u9801 UI \u4f7f\u7528\u6703\u8a71\u8a8d\u8b49\u767b\u5165\u3002</p>"},{"location":"zh/resources/troubleshooting/#_23","title":"\u6548\u80fd\u554f\u984c","text":""},{"location":"zh/resources/troubleshooting/#_24","title":"\u9ad8\u8a18\u61b6\u9ad4\u4f7f\u7528","text":"<p>\u89e3\u6c7a\u65b9\u6848\uff1a 1. \u6e1b\u5c11\u5de5\u4f5c\u8005\u6578\u91cf 2. \u555f\u7528 Redis \u6301\u4e45\u6027 3. \u6e05\u9664\u820a\u65e5\u8a8c\u6a94\u6848 4. \u6aa2\u67e5\u81ea\u8a02\u7a0b\u5f0f\u78bc\u4e2d\u7684\u8a18\u61b6\u9ad4\u6d29\u6f0f</p>"},{"location":"zh/resources/troubleshooting/#_25","title":"\u6162\u56de\u61c9","text":"<p>\u8a3a\u65b7\uff1a <pre><code># \u6aa2\u67e5\u7bc0\u9ede\u5ef6\u9072\ncurl http://localhost:8000/api/proxy/state | jq '.latencies'\n\n# \u6aa2\u67e5\u6d3b\u8e8d\u8acb\u6c42\u8a08\u6578\ncurl http://localhost:8000/api/proxy/active-requests\n</code></pre></p> <p>\u89e3\u6c7a\u65b9\u6848\uff1a 1. \u65b0\u589e\u66f4\u591a\u7bc0\u9ede 2. \u5207\u63db\u5230 <code>lowest_latency</code> \u7b56\u7565 3. \u589e\u52a0\u5de5\u4f5c\u8005\u8a08\u6578 4. \u6aa2\u67e5\u5230\u7bc0\u9ede\u7684\u7db2\u8def\u5ef6\u9072</p>"},{"location":"zh/resources/troubleshooting/#_26","title":"\u9664\u932f\u6a21\u5f0f","text":""},{"location":"zh/resources/troubleshooting/#_27","title":"\u555f\u7528\u9664\u932f\u65e5\u8a8c","text":"<p>\u5728 <code>src/aivonx/settings.py</code> \u4e2d\uff0c\u66ab\u6642\u589e\u52a0\u65e5\u8a8c\u7d1a\u5225\uff1a</p> <pre><code>LOGGING = {\n    # ...\n    'loggers': {\n        'proxy': {\n            'handlers': ['console', 'proxy_file'],\n            'level': 'DEBUG',  # \u5f9e INFO \u8b8a\u66f4\n            'propagate': False,\n        },\n    },\n}\n</code></pre>"},{"location":"zh/resources/troubleshooting/#django","title":"Django \u9664\u932f\u5de5\u5177\u5217","text":"<p>\u5c0d\u65bc\u958b\u767c\uff0c\u5b89\u88dd Django \u9664\u932f\u5de5\u5177\u5217\uff1a</p> <pre><code>pip install django-debug-toolbar\n</code></pre>"},{"location":"zh/resources/troubleshooting/#_28","title":"\u7372\u53d6\u5e6b\u52a9","text":"<ol> <li>\u6aa2\u67e5\u65e5\u8a8c\uff1a\u6aa2\u8996\u65e5\u8a8c\u6a94\u6848\u4ee5\u5c0b\u627e\u932f\u8aa4\u8a0a\u606f</li> <li>API \u72c0\u614b\uff1a\u4f7f\u7528 <code>/api/proxy/state</code> \u6aa2\u67e5\u7ba1\u7406\u54e1\u72c0\u614b</li> <li>\u5065\u5eb7\u6aa2\u67e5\uff1a\u9a57\u8b49\u6240\u6709\u670d\u52d9\u90fd\u5065\u5eb7</li> <li>GitHub \u554f\u984c\uff1a\u5728\u5132\u5b58\u5eab\u4e0a\u641c\u5c0b\u6216\u958b\u555f\u554f\u984c</li> </ol>"},{"location":"zh/resources/troubleshooting/#_29","title":"\u9664\u932f\u7684\u6709\u7528\u547d\u4ee4","text":"<pre><code># \u7cfb\u7d71\u6aa2\u67e5\npython src/manage.py check --deploy\n\n# \u986f\u793a\u76ee\u524d\u8a2d\u5b9a\npython src/manage.py diffsettings\n\n# \u8cc7\u6599\u5eab shell\npython src/manage.py dbshell\n\n# \u5177\u6709 Django \u4e0a\u4e0b\u6587\u7684 Python shell\npython src/manage.py shell\n\n# \u986f\u793a URL \u6a21\u5f0f\npython src/manage.py show_urls  # \u9700\u8981 django-extensions\n\n# \u6e2c\u8a66 Redis \u9023\u7dda\nredis-cli -h localhost ping\n\n# \u6e2c\u8a66 PostgreSQL \u9023\u7dda\npsql -h localhost -U user -d app_db -c 'SELECT 1;'\n</code></pre>"}]}